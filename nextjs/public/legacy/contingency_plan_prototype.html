<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Contingency Plan Guide - Prototype</title>
    <!-- Google Fonts - Inter for modern, readable typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* ============================================
           MODERN DESIGN SYSTEM - BRIGHT & PROFESSIONAL
           ============================================ */

        /* Color Palette - Bright, Futuristic, Professional (No Gradients) */
        :root {
            --primary-color: #5B8DEF;
            --primary-dark: #4A7BC8;
            --primary-light: #7BA3F5;
            --primary-purple: #9333EA;
            --accent-cyan: #00F0FF;
            --accent-purple: #A855F7;
            --accent-blue: #3B82F6;
            --accent-pink: #EC4899;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F8FAFC;
            --bg-tertiary: #F1F5F9;
            --bg-main: #E8F4F8;
            --text-primary: #0F172A;
            --text-secondary: #475569;
            --text-tertiary: #64748B;
            --text-light: #94A3B8;
            --text-white: #FFFFFF;
            --success: #10B981;
            --success-light: #D1FAE5;
            --warning: #F59E0B;
            --warning-light: #FEF3C7;
            --error: #EF4444;
            --error-light: #FEE2E2;
            --info: #3B82F6;
            --info-light: #DBEAFE;
            --natural-hazard: #FCD34D;
            --natural-hazard-dark: #F59E0B;
            --human-caused: #EF4444;
            --human-caused-dark: #DC2626;
            --technological: #EF4444;
            --technological-dark: #DC2626;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-glow: 0 0 20px rgba(147, 51, 234, 0.3);
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-full: 9999px;
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-main);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            line-height: 1.6;
            font-weight: 400;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: transparent;
            border-radius: var(--radius-2xl);
            box-shadow: none;
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            padding-top: 100px;
            border-bottom: 3px solid var(--primary-color);
            position: relative;
            background: var(--primary-color);
            color: var(--text-white);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            box-shadow: var(--shadow-md);
        }

        .nav-buttons {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            z-index: 10;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: var(--text-white);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 18px;
            border-radius: var(--radius-full);
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-family: 'Inter', sans-serif;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        header h1 {
            color: var(--text-white);
            font-size: 2.75em;
            margin-bottom: 12px;
            font-weight: 800;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        header .subtitle {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1.2em;
            font-weight: 400;
        }

        .save-indicator {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: var(--radius-full);
            font-size: 0.85em;
            font-weight: 600;
            opacity: 0;
            transform: translateY(-10px);
            transition: all var(--transition-base);
            z-index: 100;
        }

        .save-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        .control-buttons {
            text-align: center;
            margin: 20px 0;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-control {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all var(--transition-base);
            font-family: 'Inter', sans-serif;
        }

        .btn-control:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Education Section */
        .education-section {
            margin-bottom: 30px;
        }

        .education-box {
            background: var(--bg-secondary);
            border: 2px solid var(--primary-color);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }

        .education-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .education-header h3 {
            color: var(--primary-color);
            font-size: 1.3em;
            font-weight: 700;
        }

        .toggle-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all var(--transition-base);
        }

        .toggle-btn:hover {
            transform: scale(1.1);
        }

        .education-content {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* Collapsible Video Sections */
        .video-link-section.collapsible {
            margin-top: 20px;
            padding: 0;
            border-top: none;
        }

        .video-link-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            cursor: pointer;
            border-top: 2px solid var(--primary-color);
            margin-top: 20px;
        }

        .video-link-header h4 {
            color: var(--primary-color);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1em;
        }

        .video-link-header .video-toggle-btn {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            font-size: 1em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-weight: bold;
            line-height: 1;
        }

        .video-link-header .video-toggle-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .video-link-content {
            padding-top: 15px;
            transition: max-height 0.3s ease, opacity 0.3s ease;
            overflow: hidden;
        }

        .video-link-section.collapsed .video-link-content {
            max-height: 0;
            padding-top: 0;
            opacity: 0;
            overflow: hidden;
        }

        .video-link-btn:hover {
            background: #CC0000 !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 0, 0, 0.4) !important;
        }

        .video-link-btn[style*="background: #6B7280"]:hover {
            background: #4B5563 !important;
            box-shadow: 0 4px 12px rgba(107, 114, 128, 0.4) !important;
        }

        .video-link-btn:active {
            transform: translateY(0);
        }

        .education-content.collapsed {
            display: none;
        }

        .education-content ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .education-content li {
            margin-bottom: 8px;
        }

        /* Main Flowchart View */
        .contingency-flowchart {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: 40px;
            margin: 30px 0;
            position: relative;
            min-height: 400px;
        }

        .flowchart-wrapper {
            position: relative;
            width: 100%;
            padding: 20px 0;
        }

        .flowchart-main {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            position: relative;
        }

        /* Root Node */
        .root-node {
            background: #1E40AF;
            color: white;
            border: 3px solid #1E40AF;
            border-radius: var(--radius-xl);
            padding: 28px 40px;
            font-size: 1.6em;
            font-weight: 800;
            text-align: center;
            box-shadow: var(--shadow-lg);
            min-width: 300px;
            position: relative;
            z-index: 10;
        }

        /* Connection Lines from Root to Categories */
        .root-to-categories-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
            pointer-events: none;
        }

        /* Categories Row - Side by Side */
        .categories-row {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            width: 100%;
            margin-top: 60px;
            position: relative;
        }

        .category-node {
            border-radius: var(--radius-xl);
            padding: 24px 32px;
            font-size: 1.4em;
            font-weight: 700;
            text-align: center;
            box-shadow: var(--shadow-md);
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
            z-index: 9;
            min-width: 280px;
            flex: 1;
            max-width: 350px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .category-node:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--shadow-xl);
        }

        .category-node.active {
            border-width: 4px;
            box-shadow: 0 0 0 4px rgba(15, 76, 117, 0.2);
            transform: translateY(-3px);
        }

        .category-node.natural {
            background: var(--warning-light);
            border: 3px solid var(--warning);
            color: var(--text-primary);
        }

        .category-node.human {
            background: var(--error-light);
            border: 3px solid var(--error);
            color: var(--text-primary);
        }

        .category-node.tech {
            background: var(--error-light);
            border: 3px solid var(--error);
            color: var(--text-primary);
        }

        /* Category Detail Section - Expands Below Categories */
        .category-detail-section {
            width: 100%;
            margin-top: 30px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .category-detail-section.expanded {
            max-height: 2000px;
        }

        /* Subcategory Detail Section - Expands Below Subcategories */
        .subcategory-detail-section {
            width: 100%;
            margin-top: 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .subcategory-detail-section.expanded {
            max-height: 2000px;
        }

        /* Category Flowchart - Horizontal Layout */
        .category-flowchart {
            position: relative;
            width: 100%;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            overflow-x: auto;
            overflow-y: visible;
            max-width: 100%;
        }

        .category-flowchart-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            position: relative;
            width: 100%;
            padding: 20px;
        }

        .subcategory-flowchart-container {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            gap: 60px;
            position: relative;
            width: 100%;
            padding: 20px;
            min-height: 400px;
        }

        /* Events Column - Vertical Stack */
        .events-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
            flex: 1;
            max-width: 300px;
            align-items: stretch;
        }

        /* Event wrapper to ensure consistent height */
        .event-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            min-height: 52px;
            position: relative;
            z-index: 10;
        }

        /* Flowchart Connection Lines - Use SVG for proper layering */
        .flowchart-lines-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        /* Ensure event wrapper and delete button are above lines */
        .events-column > div {
            position: relative;
            z-index: 10;
        }

        .event-node {
            position: relative;
            z-index: 10;
        }

        .btn-delete-event {
            position: relative;
            z-index: 11;
        }

        .flowchart-lines-container svg {
            width: 100%;
            height: 100%;
        }

        .flowchart-line {
            stroke: var(--text-tertiary);
            stroke-width: 2;
            opacity: 0.4;
            fill: none;
        }

        /* Horizontal line from category to subcategories */
        .category-to-subcategory-line {
            position: absolute;
            height: 3px;
            background: var(--text-tertiary);
            opacity: 0.4;
            z-index: 1;
        }

        /* Vertical line from subcategory to events */
        .subcategory-to-events-line {
            position: absolute;
            width: 3px;
            background: var(--text-tertiary);
            opacity: 0.4;
            z-index: 1;
        }

        /* Horizontal line from event to response */
        .event-to-response-line {
            position: absolute;
            height: 2px;
            background: var(--text-tertiary);
            opacity: 0.4;
            z-index: 1;
        }

        /* Responsive adjustments for category flowchart */
        @media (max-width: 1600px) {
            .category-flowchart-container {
                gap: 20px;
                min-width: min(1200px, 100%);
            }
        }

        @media (max-width: 1200px) {
            .category-flowchart-container {
                gap: 15px;
                min-width: min(1000px, 100%);
            }
            
            .category-name-node {
                min-width: 180px;
                padding: 20px 24px;
                font-size: 1.3em;
            }
        }

        /* Category Name Node */
        .category-name-node {
            border-radius: var(--radius-xl);
            padding: 24px 32px;
            font-size: 1.5em;
            font-weight: 700;
            text-align: center;
            box-shadow: var(--shadow-lg);
            min-width: 220px;
            flex-shrink: 0;
        }

        .category-name-node.natural {
            background: var(--warning-light);
            border: 3px solid var(--warning);
            color: var(--text-primary);
        }

        .category-name-node.human {
            background: var(--error-light);
            border: 3px solid var(--error);
            color: var(--text-primary);
        }

        .category-name-node.tech {
            background: var(--error-light);
            border: 3px solid var(--error);
            color: var(--text-primary);
        }

        /* Subcategory Container - Horizontal */
        .subcategory-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            flex: 1;
            flex-wrap: wrap;
        }

        @media (max-width: 1600px) {
            .subcategory-container {
                gap: 20px;
            }
        }

        .subcategory-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
            flex: 1;
        }

        .subcategory-node {
            background: var(--bg-primary);
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius-lg);
            padding: 18px 24px;
            font-size: 1.2em;
            font-weight: 600;
            text-align: center;
            color: var(--text-primary);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
            z-index: 10;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            min-width: 150px;
            max-width: 250px;
        }

        .subcategory-node:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }

        .subcategory-node.active {
            border-color: var(--primary-color);
            border-width: 3px;
            box-shadow: 0 0 0 3px rgba(15, 76, 117, 0.1);
        }

        /* Events Row - Horizontal (for category view) */
        .events-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        /* Events Column - Vertical (for subcategory view) */
        .events-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .event-node {
            background: var(--bg-primary);
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 14px 20px;
            text-align: center;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            color: var(--text-primary);
            position: relative;
            box-shadow: var(--shadow-sm);
            min-width: 180px;
            flex-shrink: 0;
        }

        .event-node:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }

        .event-node.has-response {
            border-color: var(--success);
            border-width: 3px;
            background: var(--success-light);
        }

        .event-node.has-response::after {
            content: '‚úì';
            position: absolute;
            top: 6px;
            right: 8px;
            background: var(--success);
            color: white;
            width: 22px;
            height: 22px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85em;
            font-weight: bold;
        }

        /* Response Column - Vertical on the right */
        .response-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-width: 180px;
            flex-shrink: 0;
            margin-left: 40px;
            align-items: stretch;
        }

        /* Response wrapper to match event wrapper height */
        .response-wrapper {
            min-height: 52px;
            display: flex;
            align-items: center;
        }

        .response-node {
            background: var(--success-light);
            border: 2px solid var(--success);
            border-radius: var(--radius-md);
            padding: 14px 20px;
            font-size: 0.95em;
            font-weight: 600;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-base);
            text-align: center;
            box-shadow: var(--shadow-sm);
            min-height: 48px;
            min-width: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .response-node:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            background: var(--success);
            color: white;
        }

        .response-node.empty {
            background: var(--bg-tertiary);
            border-color: var(--text-light);
            color: var(--text-tertiary);
            font-style: italic;
        }

        /* Event-Response Connection Lines */
        .event-response-connection {
            position: absolute;
            height: 2px;
            background: var(--text-tertiary);
            opacity: 0.3;
            z-index: 1;
        }

        @media (max-width: 1024px) {
            .categories-row {
                flex-direction: column;
                align-items: center;
            }

            .category-node {
                max-width: 100%;
            }

            .category-flowchart-container {
                min-width: 1200px;
            }
        }

        /* Category Selection Modal */
        .category-select-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .category-select-modal.show {
            display: flex;
        }

        .category-select-modal-content {
            background: white;
            border-radius: var(--radius-xl);
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
        }

        .category-select-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        .category-select-item {
            padding: 16px 20px;
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-base);
            background: var(--bg-primary);
        }

        .category-select-item:hover {
            border-color: var(--primary-color);
            background: var(--primary-light);
            transform: translateX(5px);
        }

        .category-select-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--bg-secondary);
        }

        .category-select-item.disabled:hover {
            transform: none;
            border-color: var(--bg-tertiary);
            background: var(--bg-secondary);
        }

        .category-select-item-title {
            font-weight: 700;
            font-size: 1.1em;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .category-select-item-subtitle {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        /* Response Modal */
        .response-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .response-modal.show {
            display: flex;
        }

        .response-modal-content {
            background: white;
            border-radius: var(--radius-xl);
            padding: 30px;
            max-width: 700px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
        }

        .response-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all var(--transition-base);
        }

        .response-modal-close:hover {
            color: var(--error);
            transform: scale(1.2);
        }

        .response-form {
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-size: 1.05em;
        }

        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--bg-tertiary);
            border-radius: var(--radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 1em;
            resize: vertical;
            min-height: 120px;
            transition: all var(--transition-base);
        }

        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(91, 141, 239, 0.1);
        }

        .help-toggle {
            background: var(--primary-color);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: 0.85em;
            margin-left: 8px;
            vertical-align: middle;
            transition: all var(--transition-base);
        }

        .help-toggle:hover {
            transform: scale(1.1);
        }

        .field-help {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-top: 5px;
            font-style: italic;
            line-height: 1.6;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all var(--transition-base);
            margin-top: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Export Dropdown */
        .export-options {
            position: relative;
            display: inline-block;
        }

        .export-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-xl);
            margin-top: 5px;
            min-width: 200px;
            z-index: 1000;
            overflow: hidden;
        }

        .export-dropdown.show {
            display: block;
        }

        .export-option {
            display: block;
            width: 100%;
            padding: 12px 20px;
            border: none;
            background: white;
            text-align: left;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 0.95em;
            transition: all var(--transition-fast);
            border-bottom: 1px solid var(--bg-tertiary);
        }

        .export-option:last-child {
            border-bottom: none;
        }

        .export-option:hover {
            background: var(--bg-secondary);
        }

        /* Learn Menu Modal */
        .learn-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .learn-modal.show {
            display: flex;
        }

        .learn-modal-content {
            background: white;
            border-radius: var(--radius-xl);
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-xl);
        }

        .learn-section {
            margin-bottom: 25px;
        }

        .learn-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .learn-section ul {
            list-style: none;
            padding: 0;
        }

        .learn-section li {
            padding: 10px;
            margin-bottom: 8px;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-base);
        }

        .learn-section li:hover {
            background: var(--bg-tertiary);
            transform: translateX(5px);
        }

        @media (max-width: 768px) {
            .contingency-flowchart {
                padding: 20px;
            }

            .flowchart-container {
                min-width: 1000px;
            }

            header h1 {
                font-size: 2em;
            }

            .nav-buttons {
                position: relative;
                top: auto;
                right: auto;
                justify-content: center;
                margin-bottom: 15px;
            }
        }

        /* =========================================================================
           FINAL MOBILE OVERRIDES (must be last to win CSS cascade)
           Goal: fit to screen, avoid page-level horizontal scrolling, keep desktop unchanged.
           ========================================================================= */
        @media (max-width: 850px) {
            html, body {
                overflow-x: hidden;
                width: 100%;
            }

            body {
                padding-left: calc(12px + env(safe-area-inset-left));
                padding-right: calc(12px + env(safe-area-inset-right));
                padding-top: 12px;
                padding-bottom: 12px;
            }

            .container {
                max-width: 100%;
                padding: 12px;
            }

            header {
                padding-top: 70px; /* smaller than desktop 100px so content fits */
                margin-bottom: 18px;
            }

            header h1 {
                font-size: 2.1em; /* override the 768px rule slightly */
            }

            .nav-btn {
                padding: 8px 14px;
                font-size: 0.88em;
            }

            .control-buttons {
                gap: 8px;
            }

            .btn-control {
                padding: 10px 14px;
                font-size: 0.95em;
            }

            /* Main flowchart container */
            .contingency-flowchart {
                padding: 16px;
                margin: 18px 0;
            }

            .flowchart-wrapper {
                padding: 12px 0;
            }

            /* Root + category cards: remove fixed min-widths so they don't spill */
            .root-node {
                min-width: 0;
                width: 100%;
                max-width: 560px;
                padding: 18px 16px;
                font-size: 1.25em;
            }

            .categories-row {
                gap: 14px;
                margin-top: 28px;
            }

            .category-node {
                min-width: 0;
                width: 100%;
                max-width: 560px;
                padding: 16px 18px;
                font-size: 1.15em;
            }

            /* Category/Subcategory flowcharts: switch to vertical layout on mobile */
            .category-flowchart {
                padding: 12px;
                overflow-x: hidden; /* avoid page-level horizontal scroll */
            }

            /* Neutralize legacy min-width rules that force horizontal scrolling */
            .flowchart-container,
            .category-flowchart-container {
                min-width: 0 !important;
            }

            .category-flowchart-container {
                padding: 12px;
                gap: 14px;
                align-items: stretch;
            }

            .category-name-node {
                min-width: 0;
                width: 100%;
                padding: 16px 18px;
                font-size: 1.2em;
            }

            .subcategory-container {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .subcategory-group {
                gap: 12px;
            }

            .subcategory-node {
                min-width: 0;
                max-width: none;
                width: 100%;
                padding: 14px 16px;
                font-size: 1.05em;
            }

            .subcategory-flowchart-container {
                flex-direction: column;
                align-items: stretch;
                gap: 16px;
                padding: 12px;
                min-height: auto;
            }

            .events-column {
                max-width: none;
                width: 100%;
                gap: 12px;
            }

            .event-wrapper {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
                min-height: auto;
            }

            .event-node,
            .response-node {
                min-width: 0;
                width: 100%;
                padding: 12px 14px;
            }

            .response-column {
                min-width: 0;
                width: 100%;
                margin-left: 0;
                gap: 12px;
            }

            .response-wrapper {
                min-height: auto;
            }

            /* Connection lines don't match after mobile reflow; hide them on small screens */
            .flowchart-lines-container,
            .category-to-subcategory-line,
            .subcategory-to-events-line,
            .event-to-response-line,
            .event-response-connection {
                display: none !important;
            }

            /* Modals: make form grids stack and reduce padding */
            .category-select-modal-content,
            .response-modal-content {
                width: 94%;
                max-width: 94%;
                padding: 16px;
                max-height: 90vh;
            }

            .response-modal-content [style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="save-indicator" id="saveIndicator">Saved</div>
            <div class="nav-buttons">
                <a href="prototypes_home.html" class="nav-btn secondary">üè† Home</a>
                <a href="main_app_prototype.html" class="nav-btn">üìñ Strategic Plan</a>
                <a href="goal_setting_template_prototype.html" class="nav-btn">üéØ Goal Setting</a>
                <a href="porters_five_forces_prototype.html" class="nav-btn">‚öîÔ∏è Five Forces</a>
                <a href="strategic_canvas_prototype.html" class="nav-btn">üé® Strategic Canvas</a>
                <a href="strategic_action_plan_prototype.html" class="nav-btn">üìã Action Plan</a>
                <a href="product_canvas_prototype.html" class="nav-btn">üìä Product Canvas</a>
            </div>
            <h1>Business Contingency Plan</h1>
            <p class="subtitle">Prepare for unexpected events and protect your business</p>
            
            <div class="control-buttons">
                <button class="btn-control" onclick="showLearnMenu()">üìñ Learn</button>
                <button class="btn-control" id="examplesModeBtn" onclick="toggleExamplesMode()">üëÅÔ∏è View Examples</button>
                <button class="btn-control" onclick="triggerImportWordExport()" style="background: #9c27b0;">üì§ Import Plan</button>
                <div id="yourDataButtonContainer" style="display: none;">
                    <button class="btn-control" onclick="restoreUserData()" style="background: var(--success);">Your Data</button>
                </div>
                <div class="export-options">
                    <button class="btn-control btn-export" onclick="showExportOptions()">üì• Export Plan</button>
                    <div class="export-dropdown" id="exportDropdown">
                        <button class="export-option" onclick="exportPlan('txt')">Export as Text (.txt)</button>
                        <button class="export-option" onclick="exportPlan('docx')">Export as Word (.docx)</button>
                        <button class="export-option" onclick="exportPlan('xlsx')">Export as Excel (.xlsx)</button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <!-- Education Section -->
            <div class="education-section">
                <div class="education-box collapsible">
                    <div class="education-header">
                        <h3>Why This Matters</h3>
                        <button class="toggle-btn" onclick="toggleEducation(this)">‚àí</button>
                    </div>
                    <div class="education-content">
                        <p>A Business Contingency Plan is a proactive approach that helps your organization prepare for and respond to unexpected events that could disrupt operations. By spotting potential risks and creating response plans, you can reduce damage, keep your business running, and protect your employees, customers, and assets.</p>
                        <p><strong>Key Benefits:</strong></p>
                        <ul>
                            <li><strong>Reduces Downtime:</strong> Minimizes operational interruptions and financial losses</li>
                            <li><strong>Protects Reputation:</strong> Maintains customer trust and business credibility</li>
                            <li><strong>Ensures Safety:</strong> Protects employee well-being and physical assets</li>
                            <li><strong>Regulatory Compliance:</strong> Meets legal and industry requirements</li>
                            <li><strong>Peace of Mind:</strong> Provides confidence and preparedness</li>
                        </ul>
                        <p><strong>How to Use This Guide:</strong> Click on any event in the flowchart below to add or edit your response plan. Start with the risks most likely to hit your business and work through each category methodically. Each response plan should include immediate actions, communication steps, and recovery procedures.</p>
                        <div class="video-link-section collapsible collapsed">
                            <div class="video-link-header" onclick="toggleVideoSection(this)">
                                <h4>
                                    <span>üìπ</span> Video Tutorials
                                </h4>
                                <button class="video-toggle-btn" aria-label="Toggle video section">+</button>
                            </div>
                            <div class="video-link-content">
                            <div style="margin-bottom: 15px;">
                                <p style="color: var(--text-secondary); margin-bottom: 8px; font-size: 0.95em; font-weight: 600;">üéì Harvard Business Review (Recommended):</p>
                                <p style="color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9em;">Learn the fundamentals of contingency planning and how to create effective business continuity plans.</p>
                                <a href="https://www.youtube.com/watch?v=yDVcw9kDRTs" target="_blank" rel="noopener noreferrer" 
                                   class="video-link-btn" 
                                   style="display: inline-flex; align-items: center; gap: 8px; background: #FF0000; color: white; padding: 12px 20px; border-radius: var(--radius-full); text-decoration: none; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(255, 0, 0, 0.3); margin-bottom: 10px;">
                                    <span>‚ñ∂Ô∏è</span> Watch HBR Video
                                </a>
                                <div style="margin-top: 8px; font-size: 0.8em; color: var(--text-tertiary); font-style: italic;">
                                    <p style="margin: 0;"><strong>Video Credit:</strong> Online PM Courses - Mike Clayton</p>
                                </div>
                            </div>
                            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,0,0,0.1); font-size: 0.75em; color: var(--text-tertiary); font-style: italic;">
                                <p style="margin: 0;">This is an external link to a YouTube video. We do not own this content; it is linked for educational purposes only. Content is subject to YouTube's terms and may change or be removed by the original creator.</p>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="education-box collapsible">
                    <div class="education-header">
                        <h3>Best Practices for Contingency Planning</h3>
                        <button class="toggle-btn" onclick="toggleEducation(this)">‚àí</button>
                    </div>
                    <div class="education-content">
                        <p><strong>1. Assemble a Planning Team:</strong> Form a team with knowledge of critical business functions and technical expertise. This team will be responsible for drafting and implementing the contingency plan.</p>
                        <p><strong>2. Identify and Assess Risks:</strong> Conduct a thorough risk assessment to identify potential threats. Evaluate each risk based on its likelihood and potential impact on your operations.</p>
                        <p><strong>3. Prioritize Critical Functions:</strong> Determine which business processes are essential for survival and prioritize them. Focus resources on maintaining or quickly restoring these functions.</p>
                        <p><strong>4. Develop Detailed Response Strategies:</strong> For each identified risk, create specific response strategies that include:</p>
                        <ul>
                            <li>Immediate actions to take when the event occurs</li>
                            <li>Clear communication protocols and contact information</li>
                            <li>Recovery procedures to restore operations</li>
                            <li>Assigned roles and responsibilities</li>
                            <li>Required resources and equipment</li>
                        </ul>
                        <p><strong>5. Establish Communication Protocols:</strong> Define clear communication channels and protocols. Ensure contact information for key personnel, stakeholders, and external partners is up-to-date.</p>
                        <p><strong>6. Train Personnel and Test the Plan:</strong> Educate employees on their roles within the contingency plan. Conduct regular drills and simulations to test effectiveness and identify areas for improvement.</p>
                        <p><strong>7. Review and Update Regularly:</strong> Periodically review and update the plan to reflect changes in your organization, emerging threats, or lessons learned from past incidents.</p>
                    </div>
                </div>
            </div>

            <!-- Contingency Plan Flowchart -->
            <div class="contingency-flowchart">
                <div class="flowchart-wrapper">
                    <div class="flowchart-main" id="flowchartMain">
                        <!-- Flowchart will be generated dynamically -->
                    </div>
                    <!-- Category Detail Section - Expands Below -->
                    <div class="category-detail-section" id="categoryDetailSection">
                        <div class="category-flowchart" id="categoryFlowchart">
                            <!-- Category flowchart will be generated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Category Selection Modal -->
    <div class="category-select-modal" id="categorySelectModal" onclick="closeCategorySelectModal(event)">
        <div class="category-select-modal-content" onclick="event.stopPropagation()">
            <button class="response-modal-close" onclick="closeCategorySelectModal()">&times;</button>
            <h2 style="color: var(--primary-color); margin-bottom: 10px;">Select a Category to Add</h2>
            <p style="color: var(--text-secondary); margin-bottom: 20px;">Choose from the available categories below. Categories already added are disabled.</p>
            <div class="category-select-list" id="categorySelectList">
                <!-- Categories will be populated here -->
            </div>
        </div>
    </div>

    <!-- Response Modal -->
    <div class="response-modal" id="responseModal" onclick="closeResponseModal(event)">
        <div class="response-modal-content" onclick="event.stopPropagation()" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <button class="response-modal-close" onclick="closeResponseModal()">&times;</button>
            <h2 id="responseModalTitle" style="color: var(--primary-color); margin-bottom: 20px;">Response Plan</h2>
            <div class="response-form">
                <!-- Risk Assessment Section -->
                <div style="background: #f8f9fa; padding: 20px; border-radius: var(--radius-md); margin-bottom: 20px;">
                    <h3 style="color: var(--primary-color); margin-top: 0; margin-bottom: 15px; font-size: 1.1em;">Risk Assessment</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Priority Level</label>
                            <select id="eventPriority" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em;">
                                <option value="">Select Priority</option>
                                <option value="High">High - Critical impact, requires immediate attention</option>
                                <option value="Medium">Medium - Significant impact, plan needed</option>
                                <option value="Low">Low - Minor impact, standard procedures</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Risk Likelihood</label>
                            <select id="eventLikelihood" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em;">
                                <option value="">Select Likelihood</option>
                                <option value="Very High">Very High - Very likely to occur</option>
                                <option value="High">High - Likely to occur</option>
                                <option value="Medium">Medium - Possible to occur</option>
                                <option value="Low">Low - Unlikely to occur</option>
                                <option value="Very Low">Very Low - Rare occurrence</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label>Risk Impact</label>
                        <select id="eventImpact" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em;">
                            <option value="">Select Impact</option>
                            <option value="Critical">Critical - Business operations completely halted</option>
                            <option value="High">High - Major disruption to operations</option>
                            <option value="Medium">Medium - Moderate disruption to operations</option>
                            <option value="Low">Low - Minor disruption to operations</option>
                            <option value="Minimal">Minimal - Negligible impact</option>
                        </select>
                    </div>
                </div>
                
                <!-- Management Section -->
                <div style="background: #f8f9fa; padding: 20px; border-radius: var(--radius-md); margin-bottom: 20px;">
                    <h3 style="color: var(--primary-color); margin-top: 0; margin-bottom: 15px; font-size: 1.1em;">Management & Timeline</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Responsible Party/Department</label>
                            <input type="text" id="eventResponsible" placeholder="e.g., IT Manager, Facilities Team" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em;">
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Estimated Recovery Time</label>
                            <input type="text" id="eventRecoveryTime" placeholder="e.g., 24-48 hours, 1-2 weeks" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em;">
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 0; margin-top: 15px;">
                        <label>Status</label>
                        <select id="eventStatus" style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em;">
                            <option value="Not Started">Not Started</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Complete">Complete</option>
                            <option value="Under Review">Under Review</option>
                        </select>
                    </div>
                </div>
                
                <!-- Response Plan Section - Interactive Mode -->
                <div id="responsePlanInteractive" style="display: none;">
                    <!-- Immediate Actions Section -->
                    <div class="response-section" style="background: var(--bg-secondary); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 20px; border-left: 4px solid var(--error);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                            <h3 style="color: var(--error); margin: 0; font-size: 1.2em; display: flex; align-items: center; gap: 8px;">
                                üö® Immediate Actions
                                <button class="help-toggle" onclick="toggleSectionHelp('immediateActions')" style="background: var(--error-light); color: var(--error); border: 1px solid var(--error); border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center;">?</button>
                            </h3>
                        </div>
                        <div id="immediateActionsHelp" class="section-help" style="display: none; background: white; padding: 15px; border-radius: var(--radius-md); margin-bottom: 15px; border: 1px solid var(--error-light);">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;">
                                <strong>What to include:</strong> List the critical first steps that must be taken immediately when this event occurs. Focus on safety, containment, and preventing further damage. Examples: evacuate personnel, call 911, shut off systems, secure the area. Each action should be specific and actionable. Use bullet points for clarity.
                            </p>
                        </div>
                        <textarea id="immediateActions" placeholder="‚Ä¢ First critical action...&#10;‚Ä¢ Second critical action...&#10;‚Ä¢ Third critical action..." style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                    </div>

                    <!-- Communication Plan Section -->
                    <div class="response-section" style="background: var(--bg-secondary); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 20px; border-left: 4px solid var(--info);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                            <h3 style="color: var(--info); margin: 0; font-size: 1.2em; display: flex; align-items: center; gap: 8px;">
                                üì¢ Communication Plan
                                <button class="help-toggle" onclick="toggleSectionHelp('communicationPlan')" style="background: var(--info-light); color: var(--info); border: 1px solid var(--info); border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center;">?</button>
                            </h3>
                        </div>
                        <div id="communicationPlanHelp" class="section-help" style="display: none; background: white; padding: 15px; border-radius: var(--radius-md); margin-bottom: 15px; border: 1px solid var(--info-light);">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;">
                                <strong>What to include:</strong> Define who needs to be notified, how they'll be contacted, and what information to share. Include: internal notifications (employees, management), external notifications (customers, suppliers, media), emergency services contact, and communication channels (phone, email, alert systems). Be specific about timing and messaging.
                            </p>
                        </div>
                        <textarea id="communicationPlan" placeholder="‚Ä¢ Notify [who] via [method]...&#10;‚Ä¢ Contact [stakeholder] about [what]...&#10;‚Ä¢ Establish [communication channel]..." style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                    </div>

                    <!-- Recovery Procedures Section -->
                    <div class="response-section" style="background: var(--bg-secondary); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 20px; border-left: 4px solid var(--success);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                            <h3 style="color: var(--success); margin: 0; font-size: 1.2em; display: flex; align-items: center; gap: 8px;">
                                üîÑ Recovery Procedures
                                <button class="help-toggle" onclick="toggleSectionHelp('recoveryProcedures')" style="background: var(--success-light); color: var(--success); border: 1px solid var(--success); border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center;">?</button>
                            </h3>
                        </div>
                        <div id="recoveryProceduresHelp" class="section-help" style="display: none; background: white; padding: 15px; border-radius: var(--radius-md); margin-bottom: 15px; border: 1px solid var(--success-light);">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;">
                                <strong>What to include:</strong> Outline the steps to restore normal operations. Include: assessment procedures, cleanup/repair steps, system restoration, timeline estimates, and criteria for resuming operations. Be realistic about recovery times and include dependencies. End with a timeline summary (e.g., "Timeline: 24-48 hours for assessment, 1-2 weeks for full recovery").
                            </p>
                        </div>
                        <textarea id="recoveryProcedures" placeholder="‚Ä¢ Assess [what] and [how]...&#10;‚Ä¢ Coordinate [with whom] for [what]...&#10;‚Ä¢ Restore [systems/operations]...&#10;‚Ä¢ Timeline: [timeframe]" style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                    </div>

                    <!-- Roles & Responsibilities Section -->
                    <div class="response-section" style="background: var(--bg-secondary); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 20px; border-left: 4px solid var(--warning);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                            <h3 style="color: var(--warning); margin: 0; font-size: 1.2em; display: flex; align-items: center; gap: 8px;">
                                üë• Roles & Responsibilities
                                <button class="help-toggle" onclick="toggleSectionHelp('rolesResponsibilities')" style="background: var(--warning-light); color: var(--warning); border: 1px solid var(--warning); border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center;">?</button>
                            </h3>
                        </div>
                        <div id="rolesResponsibilitiesHelp" class="section-help" style="display: none; background: white; padding: 15px; border-radius: var(--radius-md); margin-bottom: 15px; border: 1px solid var(--warning-light);">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;">
                                <strong>What to include:</strong> Assign specific responsibilities to roles or individuals. Format: "Role/Name: Specific responsibility or task." Include key roles like Emergency Coordinator, Safety Officer, IT Manager, Facilities Manager, Communications Lead, etc. Be clear about who is accountable for each aspect of the response.
                            </p>
                        </div>
                        <textarea id="rolesResponsibilities" placeholder="‚Ä¢ [Role/Name]: [Specific responsibility]...&#10;‚Ä¢ [Role/Name]: [Specific responsibility]...&#10;‚Ä¢ [Role/Name]: [Specific responsibility]..." style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                    </div>

                    <!-- Resources Needed Section -->
                    <div class="response-section" style="background: var(--bg-secondary); padding: 20px; border-radius: var(--radius-lg); margin-bottom: 20px; border-left: 4px solid var(--primary-color);">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                            <h3 style="color: var(--primary-color); margin: 0; font-size: 1.2em; display: flex; align-items: center; gap: 8px;">
                                üì¶ Resources Needed
                                <button class="help-toggle" onclick="toggleSectionHelp('resourcesNeeded')" style="background: var(--primary-light); color: var(--primary-color); border: 1px solid var(--primary-color); border-radius: 50%; width: 24px; height: 24px; font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center;">?</button>
                            </h3>
                        </div>
                        <div id="resourcesNeededHelp" class="section-help" style="display: none; background: white; padding: 15px; border-radius: var(--radius-md); margin-bottom: 15px; border: 1px solid var(--primary-light);">
                            <p style="margin: 0; color: var(--text-secondary); font-size: 0.9em; line-height: 1.6;">
                                <strong>What to include:</strong> List all resources required to execute the response plan. Include: equipment, supplies, services, personnel, facilities, technology, external vendors, and any special resources. Be specific about quantities, types, and where to obtain them. Consider backup resources if primary ones are unavailable.
                            </p>
                        </div>
                        <textarea id="resourcesNeeded" placeholder="‚Ä¢ [Resource type] - [specific details]...&#10;‚Ä¢ [Service/Equipment] - [where to obtain]...&#10;‚Ä¢ [Personnel/Vendor] - [contact info if needed]..." style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                    </div>
                </div>

                <!-- Response Plan Section - View Mode -->
                <div id="responsePlanView" class="form-group">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                        <label>Response Plan</label>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn-secondary" id="exampleDataToggleBtnView" onclick="toggleExampleInModal()" style="display: none; background: var(--info); color: white; padding: 8px 16px; border: none; border-radius: var(--radius-md); cursor: pointer; font-size: 0.9em; font-weight: 600;">
                                üìã Example
                            </button>
                            <button class="btn-secondary" onclick="switchToEditMode()" style="background: var(--primary-color); color: white; padding: 8px 16px; border: none; border-radius: var(--radius-md); cursor: pointer; font-size: 0.9em; font-weight: 600;">
                                ‚úèÔ∏è Edit
                            </button>
                        </div>
                    </div>
                    <div id="responseTextView" style="background: var(--bg-secondary); padding: 20px; border-radius: var(--radius-md); border: 2px solid var(--border-color); min-height: 200px; white-space: pre-wrap; font-family: 'Inter', sans-serif; line-height: 1.8; color: var(--text-primary); font-size: 1em; word-wrap: break-word;"></div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                    <button class="btn-primary" id="saveResponseBtn" onclick="saveResponse()" style="display: none;">Save Response</button>
                    <button class="btn-secondary" id="exampleDataToggleBtn" onclick="toggleExampleInModal()" style="display: none; background: var(--info);">
                        üìã Example
                    </button>
                    <button class="btn-secondary" onclick="closeResponseModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Learn Menu Modal -->
    <div class="learn-modal" id="learnModal" onclick="closeLearnMenu(event)">
        <div class="learn-modal-content" onclick="event.stopPropagation()">
            <button class="response-modal-close" onclick="closeLearnMenu()">&times;</button>
            <h2 style="color: var(--primary-color); margin-bottom: 25px;">üìö Learn About Contingency Planning</h2>
            
            <div class="learn-section">
                <h3>Understanding Contingency Planning</h3>
                <ul>
                    <li onclick="showLearnContent('what-is-contingency')">What is a Contingency Plan?</li>
                    <li onclick="showLearnContent('why-important')">Why is Contingency Planning Important?</li>
                    <li onclick="showLearnContent('risk-assessment')">How to Conduct a Risk Assessment</li>
                </ul>
            </div>

            <div class="learn-section">
                <h3>Risk Categories</h3>
                <ul>
                    <li onclick="showLearnContent('natural-hazards')">Natural Hazards</li>
                    <li onclick="showLearnContent('human-caused')">Human-Caused Events</li>
                    <li onclick="showLearnContent('technological')">Technological Issues</li>
                </ul>
            </div>

            <div class="learn-section">
                <h3>Creating Response Plans</h3>
                <ul>
                    <li onclick="showLearnContent('response-structure')">Response Plan Structure</li>
                    <li onclick="showLearnContent('communication')">Communication Protocols</li>
                    <li onclick="showLearnContent('recovery')">Recovery Procedures</li>
                </ul>
            </div>

            <div class="learn-section">
                <h3>Best Practices</h3>
                <ul>
                    <li onclick="showLearnContent('prioritization')">Prioritizing Risks</li>
                    <li onclick="showLearnContent('testing')">Testing Your Plan</li>
                    <li onclick="showLearnContent('updates')">Regular Updates and Reviews</li>
                </ul>
            </div>

            <div id="learnContentDisplay" style="display: none; margin-top: 30px; padding-top: 30px; border-top: 2px solid var(--primary-color);">
                <div id="learnContentText"></div>
                <button onclick="hideLearnContent()" class="btn-primary" style="margin-top: 20px;">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Data structure matching the flowchart
        let contingencyData = {
            naturalHazards: {
                geological: {
                    landslide: '',
                    earthquake: '',
                    volcano: ''
                },
                meteorological: {
                    dustStorm: '',
                    extremeTemperatures: '',
                    snow: '',
                    flood: '',
                    lightning: ''
                }
            },
            humanCaused: {
                accidental: {
                    fire: '',
                    buildingCollapse: '',
                    hazardousMaterialSpill: ''
                },
                intentional: {
                    workplaceViolence: '',
                    protests: ''
                }
            },
            technological: {
                infrastructureFailure: '',
                cyberSecurity: ''
            }
        };
        
        // Metadata for each event (priority, risk assessment, responsible party, etc.)
        let eventMetadata = {};

        let currentEventId = null;
        let examplesMode = false;
        let modalExampleBackup = null; // Backup user's data when showing example in modal
        let userDataBackup = null; // Store user's data when loading examples

        // Example metadata for each event type
        const exampleMetadata = {
            'naturalHazards.geological.landslide': {
                priority: 'High',
                likelihood: 'Low',
                impact: 'High',
                responsible: 'Facilities Manager & Safety Officer',
                recoveryTime: '1-2 weeks',
                status: 'Complete'
            },
            'naturalHazards.geological.earthquake': {
                priority: 'High',
                likelihood: 'Low',
                impact: 'Critical',
                responsible: 'Emergency Coordinator & Facilities Manager',
                recoveryTime: '1-3 days',
                status: 'Complete'
            },
            'naturalHazards.geological.volcano': {
                priority: 'Medium',
                likelihood: 'Very Low',
                impact: 'High',
                responsible: 'Emergency Coordinator & Operations Manager',
                recoveryTime: '1-2 weeks',
                status: 'Complete'
            },
            'naturalHazards.meteorological.dustStorm': {
                priority: 'Low',
                likelihood: 'Medium',
                impact: 'Low',
                responsible: 'Facilities Manager',
                recoveryTime: '4-8 hours',
                status: 'Complete'
            },
            'naturalHazards.meteorological.extremeTemperatures': {
                priority: 'Medium',
                likelihood: 'High',
                impact: 'Medium',
                responsible: 'Facilities Manager & HR Manager',
                recoveryTime: 'Ongoing during event',
                status: 'Complete'
            },
            'naturalHazards.meteorological.snow': {
                priority: 'Medium',
                likelihood: 'High',
                impact: 'Medium',
                responsible: 'Facilities Manager & Operations Manager',
                recoveryTime: '2-6 hours',
                status: 'Complete'
            },
            'naturalHazards.meteorological.flood': {
                priority: 'High',
                likelihood: 'Medium',
                impact: 'High',
                responsible: 'Emergency Coordinator & Facilities Manager',
                recoveryTime: '1-4 weeks',
                status: 'Complete'
            },
            'naturalHazards.meteorological.lightning': {
                priority: 'Low',
                likelihood: 'Medium',
                impact: 'Low',
                responsible: 'Safety Officer & IT Manager',
                recoveryTime: '2-4 hours',
                status: 'Complete'
            },
            'humanCaused.accidental.fire': {
                priority: 'High',
                likelihood: 'Low',
                impact: 'Critical',
                responsible: 'Safety Coordinator & Facilities Manager',
                recoveryTime: '1-4 weeks',
                status: 'Complete'
            },
            'humanCaused.accidental.buildingCollapse': {
                priority: 'High',
                likelihood: 'Very Low',
                impact: 'Critical',
                responsible: 'Emergency Coordinator & Facilities Manager',
                recoveryTime: 'Weeks to months',
                status: 'Complete'
            },
            'humanCaused.accidental.hazardousMaterialSpill': {
                priority: 'High',
                likelihood: 'Low',
                impact: 'High',
                responsible: 'Safety Officer & Environmental Coordinator',
                recoveryTime: '1-2 days',
                status: 'Complete'
            },
            'humanCaused.intentional.workplaceViolence': {
                priority: 'High',
                likelihood: 'Very Low',
                impact: 'Critical',
                responsible: 'Security Coordinator & HR Manager',
                recoveryTime: 'Days to weeks',
                status: 'Complete'
            },
            'humanCaused.intentional.protests': {
                priority: 'Medium',
                likelihood: 'Low',
                impact: 'Medium',
                responsible: 'Security Manager & Operations Manager',
                recoveryTime: 'Hours to days',
                status: 'Complete'
            },
            'technological.infrastructureFailure': {
                priority: 'High',
                likelihood: 'Medium',
                impact: 'High',
                responsible: 'IT Manager & Facilities Manager',
                recoveryTime: '2-24 hours',
                status: 'Complete'
            },
            'technological.cyberSecurity': {
                priority: 'High',
                likelihood: 'Medium',
                impact: 'Critical',
                responsible: 'IT Security Manager & Systems Administrator',
                recoveryTime: 'Hours to days for containment, weeks for recovery',
                status: 'Complete'
            },
            // New Natural Hazards Metadata
            'naturalHazards.geological.tsunami': { priority: 'High', likelihood: 'Very Low', impact: 'Critical', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: '1-3 weeks', status: 'Complete' },
            'naturalHazards.weather.hurricane': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: '1-4 weeks', status: 'Complete' },
            'naturalHazards.weather.tornado': { priority: 'High', likelihood: 'Low', impact: 'Critical', responsible: 'Safety Coordinator & Facilities Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'naturalHazards.weather.blizzard': { priority: 'Medium', likelihood: 'High', impact: 'Medium', responsible: 'Facilities Manager & Operations Manager', recoveryTime: '1-3 days', status: 'Complete' },
            'naturalHazards.weather.heatWave': { priority: 'Medium', likelihood: 'High', impact: 'Medium', responsible: 'Facilities Manager & HR Manager', recoveryTime: 'Ongoing during event', status: 'Complete' },
            'naturalHazards.hydrological.flood': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: '1-4 weeks', status: 'Complete' },
            'naturalHazards.hydrological.drought': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Facilities Manager & Operations Manager', recoveryTime: 'Weeks to months', status: 'Complete' },
            'naturalHazards.hydrological.stormSurge': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: '1-3 weeks', status: 'Complete' },
            'naturalHazards.wildfire.forestFire': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: '1-2 weeks', status: 'Complete' },
            'naturalHazards.wildfire.brushFire': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: '3-7 days', status: 'Complete' },
            // New Human Caused Events Metadata
            'humanCaused.violence.activeShooter': { priority: 'Critical', likelihood: 'Very Low', impact: 'Critical', responsible: 'Security Coordinator & HR Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'humanCaused.violence.civilUnrest': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Security Manager & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'humanCaused.terrorism.bombThreat': { priority: 'High', likelihood: 'Very Low', impact: 'Critical', responsible: 'Security Coordinator & Emergency Coordinator', recoveryTime: '2-4 hours', status: 'Complete' },
            'humanCaused.terrorism.chemicalAttack': { priority: 'Critical', likelihood: 'Very Low', impact: 'Critical', responsible: 'Safety Officer & Medical Coordinator', recoveryTime: 'Hours to days', status: 'Complete' },
            'humanCaused.terrorism.sabotage': { priority: 'High', likelihood: 'Very Low', impact: 'High', responsible: 'Security Coordinator & IT Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'humanCaused.accidents.industrialAccident': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Safety Officer & Emergency Coordinator', recoveryTime: 'Days to weeks', status: 'Complete' },
            'humanCaused.accidents.transportationCrash': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Safety Officer & Fleet Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'humanCaused.accidents.humanErrorSpill': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'Safety Officer & Environmental Coordinator', recoveryTime: '1-2 days', status: 'Complete' },
            'humanCaused.social.strike': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'HR Manager & Operations Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'humanCaused.social.massGathering': { priority: 'Low', likelihood: 'Medium', impact: 'Low', responsible: 'Security Manager & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            // New Technological Issues Metadata
            'technological.infrastructure.powerOutage': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'Facilities Manager & IT Manager', recoveryTime: '2-24 hours', status: 'Complete' },
            'technological.infrastructure.gridCollapse': { priority: 'High', likelihood: 'Low', impact: 'Critical', responsible: 'Facilities Manager & Emergency Coordinator', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.infrastructure.utilityDisruption': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Facilities Manager & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.hazmat.chemicalSpill': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Safety Officer & Environmental Coordinator', recoveryTime: '1-2 days', status: 'Complete' },
            'technological.hazmat.radiationLeak': { priority: 'Critical', likelihood: 'Very Low', impact: 'Critical', responsible: 'Radiation Safety Officer & Medical Coordinator', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.hazmat.industrialExplosion': { priority: 'Critical', likelihood: 'Very Low', impact: 'Critical', responsible: 'Emergency Coordinator & Facilities Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'technological.equipment.machineryBreakdown': { priority: 'Medium', likelihood: 'Medium', impact: 'Medium', responsible: 'Operations Manager & Maintenance Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.equipment.vehicleFailure': { priority: 'Medium', likelihood: 'Medium', impact: 'Medium', responsible: 'Fleet Manager & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.equipment.buildingFault': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Facilities Manager & Safety Officer', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.transportation.airFailure': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Travel Coordinator & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.transportation.railFailure': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Transportation Coordinator & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'technological.transportation.roadFailure': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Transportation Coordinator & Logistics Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            // Biological or Health-Related Hazards Metadata
            'biological.disease.pandemic': { priority: 'High', likelihood: 'Low', impact: 'Critical', responsible: 'HR Manager & Safety Officer', recoveryTime: 'Weeks to months', status: 'Complete' },
            'biological.disease.epidemic': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'HR Manager & Safety Officer', recoveryTime: 'Weeks to months', status: 'Complete' },
            'biological.disease.viralSpread': { priority: 'Medium', likelihood: 'Medium', impact: 'Medium', responsible: 'HR Manager & Safety Officer', recoveryTime: 'Days to weeks', status: 'Complete' },
            'biological.bioterrorism.pathogenRelease': { priority: 'Critical', likelihood: 'Very Low', impact: 'Critical', responsible: 'Safety Officer & Medical Coordinator', recoveryTime: 'Hours to days', status: 'Complete' },
            'biological.bioterrorism.bioAttack': { priority: 'Critical', likelihood: 'Very Low', impact: 'Critical', responsible: 'Safety Officer & Medical Coordinator', recoveryTime: 'Hours to days', status: 'Complete' },
            'biological.contamination.foodBacterial': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Food Safety Coordinator & Public Health Liaison', recoveryTime: 'Hours to days', status: 'Complete' },
            'biological.contamination.waterToxin': { priority: 'High', likelihood: 'Very Low', impact: 'High', responsible: 'Facilities Manager & Safety Officer', recoveryTime: 'Hours to days', status: 'Complete' },
            'biological.zoonotic.avianFlu': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'HR Manager & Safety Officer', recoveryTime: 'Days to weeks', status: 'Complete' },
            'biological.zoonotic.animalTransmission': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'HR Manager & Safety Officer', recoveryTime: 'Days to weeks', status: 'Complete' },
            // Cyber or Digital Threats Metadata
            'cyber.attack.hacking': { priority: 'High', likelihood: 'Medium', impact: 'Critical', responsible: 'IT Security Manager & Systems Administrator', recoveryTime: 'Hours to days for containment, weeks for recovery', status: 'Complete' },
            'cyber.attack.phishing': { priority: 'High', likelihood: 'High', impact: 'Medium', responsible: 'IT Security Manager & Systems Administrator', recoveryTime: 'Hours to days', status: 'Complete' },
            'cyber.attack.malware': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'IT Security Manager & Systems Administrator', recoveryTime: 'Hours to days', status: 'Complete' },
            'cyber.breach.unauthorizedAccess': { priority: 'High', likelihood: 'Medium', impact: 'Critical', responsible: 'IT Security Manager & Systems Administrator', recoveryTime: 'Hours to days, weeks for recovery', status: 'Complete' },
            'cyber.breach.dataTheft': { priority: 'Critical', likelihood: 'Low', impact: 'Critical', responsible: 'IT Security Manager & Legal/Compliance', recoveryTime: 'Hours for containment, weeks for recovery', status: 'Complete' },
            'cyber.dos.systemOverload': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'IT Security Manager & Network Administrator', recoveryTime: 'Hours for mitigation', status: 'Complete' },
            'cyber.dos.trafficFlood': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'IT Security Manager & Network Administrator', recoveryTime: 'Hours for mitigation', status: 'Complete' },
            'cyber.ransomware.dataEncryption': { priority: 'Critical', likelihood: 'Medium', impact: 'Critical', responsible: 'IT Security Manager & Systems Administrator', recoveryTime: 'Hours for containment, days to weeks for recovery', status: 'Complete' },
            'cyber.ransomware.systemLock': { priority: 'Critical', likelihood: 'Medium', impact: 'Critical', responsible: 'IT Security Manager & Systems Administrator', recoveryTime: 'Hours for containment, days to weeks for recovery', status: 'Complete' },
            // Economic or Financial Crises Metadata
            'economic.market.stockCrash': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'CFO & Financial Advisor', recoveryTime: 'Weeks to months', status: 'Complete' },
            'economic.market.recession': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'CFO & CEO', recoveryTime: 'Months to years', status: 'Complete' },
            'economic.market.inflation': { priority: 'Medium', likelihood: 'High', impact: 'Medium', responsible: 'CFO & Operations Manager', recoveryTime: 'Ongoing', status: 'Complete' },
            'economic.supply.materialSourcing': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'Procurement Manager & Operations Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'economic.supply.inventoryShortage': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'Inventory Manager & Operations Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'economic.funding.grantLoss': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Development Director & CFO', recoveryTime: 'Weeks to months', status: 'Complete' },
            'economic.funding.revenueLoss': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'CFO & Sales Manager', recoveryTime: 'Weeks to months', status: 'Complete' },
            'economic.trade.currencyDevaluation': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'CFO & International Operations Manager', recoveryTime: 'Weeks to months', status: 'Complete' },
            'economic.trade.tariffs': { priority: 'Medium', likelihood: 'Low', impact: 'Medium', responsible: 'Procurement Manager & CFO', recoveryTime: 'Weeks to months', status: 'Complete' },
            'economic.trade.tradeWar': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'International Operations Manager & CFO', recoveryTime: 'Months to years', status: 'Complete' },
            // Operational or Internal Risks Metadata
            'operational.hr.staffShortage': { priority: 'High', likelihood: 'Medium', impact: 'High', responsible: 'HR Manager & Operations Manager', recoveryTime: 'Weeks to months', status: 'Complete' },
            'operational.hr.successionGap': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Board of Directors & HR Manager', recoveryTime: 'Months', status: 'Complete' },
            'operational.hr.keyPersonnelLoss': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'HR Manager & Department Manager', recoveryTime: 'Weeks to months', status: 'Complete' },
            'operational.process.workflowBreakdown': { priority: 'Medium', likelihood: 'Medium', impact: 'Medium', responsible: 'Process Owner & Operations Manager', recoveryTime: 'Hours to days', status: 'Complete' },
            'operational.process.complianceViolation': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Compliance Officer & Legal Counsel', recoveryTime: 'Immediate for corrections, weeks for compliance', status: 'Complete' },
            'operational.vendor.externalPartnerFailure': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Procurement Manager & Operations Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'operational.vendor.contractBreach': { priority: 'High', likelihood: 'Low', impact: 'High', responsible: 'Legal Counsel & Vendor Manager', recoveryTime: 'Days to weeks', status: 'Complete' },
            'operational.project.scopeCreep': { priority: 'Medium', likelihood: 'High', impact: 'Medium', responsible: 'Project Manager & Project Sponsor', recoveryTime: 'Days to weeks', status: 'Complete' },
            'operational.project.delay': { priority: 'Medium', likelihood: 'Medium', impact: 'Medium', responsible: 'Project Manager & Project Sponsor', recoveryTime: 'Days to weeks', status: 'Complete' }
        };

        // Example response plans for each event type
        const exampleResponses = {
            'naturalHazards.geological.landslide': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate all personnel from affected and at-risk areas immediately
‚Ä¢ Secure the perimeter to prevent access to dangerous zones
‚Ä¢ Contact emergency services (911) and local authorities
‚Ä¢ Assess the extent of the landslide and potential for further movement

COMMUNICATION PLAN:
‚Ä¢ Notify all employees via emergency alert system
‚Ä¢ Contact building management and property owner
‚Ä¢ Inform customers and stakeholders about potential service disruptions
‚Ä¢ Designate a spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for geological assessment before re-entering the area
‚Ä¢ Coordinate with structural engineers to evaluate building safety
‚Ä¢ Arrange for debris removal and site cleanup
‚Ä¢ Restore operations from alternate location if needed
‚Ä¢ Timeline: 24-48 hours for assessment, 1-2 weeks for full recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate evacuation and safety protocols
‚Ä¢ Facilities Manager: Assess building damage and coordinate repairs
‚Ä¢ Communications Lead: Manage all external communications
‚Ä¢ Operations Manager: Establish alternate operations if needed

RESOURCES NEEDED:
‚Ä¢ Emergency supplies (first aid, flashlights, water)
‚Ä¢ Temporary office space or remote work capabilities
‚Ä¢ Structural engineering assessment
‚Ä¢ Cleanup and restoration services`,

            'naturalHazards.geological.earthquake': `IMMEDIATE ACTIONS:
‚Ä¢ Drop, Cover, and Hold On during shaking
‚Ä¢ After shaking stops, evacuate building following established routes
‚Ä¢ Check for injuries and provide first aid
‚Ä¢ Shut off gas, water, and electrical systems if safe to do so
‚Ä¢ Do not re-enter building until cleared by authorities

COMMUNICATION PLAN:
‚Ä¢ Account for all personnel using emergency contact system
‚Ä¢ Notify emergency services of any injuries or trapped individuals
‚Ä¢ Contact building management for structural assessment
‚Ä¢ Update customers about service status via website and social media
‚Ä¢ Establish communication hub if phone systems are down

RECOVERY PROCEDURES:
‚Ä¢ Conduct building safety inspection before re-entry
‚Ä¢ Assess damage to equipment, inventory, and infrastructure
‚Ä¢ Activate backup systems (generators, alternate internet)
‚Ä¢ Resume critical operations from safe location
‚Ä¢ Timeline: 2-4 hours for initial assessment, 1-3 days for full recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Coordinator: Oversee evacuation and account for all personnel
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Facilities Lead: Coordinate building inspections and repairs
‚Ä¢ Business Continuity Manager: Activate alternate operations plan

RESOURCES NEEDED:
‚Ä¢ Emergency kits (first aid, water, food, flashlights)
‚Ä¢ Backup power generators
‚Ä¢ Structural engineering assessment
‚Ä¢ Data backup and recovery systems
‚Ä¢ Temporary workspace if building is unsafe`,

            'naturalHazards.geological.volcano': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor official volcano alerts and evacuation orders
‚Ä¢ Evacuate immediately if ordered by authorities
‚Ä¢ Close all windows and ventilation systems
‚Ä¢ Cover equipment and sensitive materials to protect from ash
‚Ä¢ Secure facility and activate remote work protocols

COMMUNICATION PLAN:
‚Ä¢ Monitor official emergency broadcasts continuously
‚Ä¢ Notify all employees of evacuation orders and safety protocols
‚Ä¢ Inform customers about service disruptions and expected duration
‚Ä¢ Coordinate with local emergency management office
‚Ä¢ Provide regular updates via website and social media

RECOVERY PROCEDURES:
‚Ä¢ Wait for official clearance before returning to area
‚Ä¢ Assess ash damage to building, equipment, and infrastructure
‚Ä¢ Coordinate professional cleanup of ash (do not use water - creates concrete)
‚Ä¢ Test air quality and HVAC systems before reoccupying
‚Ä¢ Timeline: 1-3 days for ash to settle, 1-2 weeks for cleanup

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor alerts and coordinate response
‚Ä¢ Facilities Manager: Oversee building protection and cleanup
‚Ä¢ Operations Manager: Maintain business continuity remotely
‚Ä¢ Safety Officer: Ensure safe return and air quality testing

RESOURCES NEEDED:
‚Ä¢ N95 masks and protective equipment for cleanup
‚Ä¢ Professional ash removal services
‚Ä¢ Air quality testing equipment
‚Ä¢ Remote work infrastructure
‚Ä¢ Backup data and systems`,

            'naturalHazards.meteorological.dustStorm': `IMMEDIATE ACTIONS:
‚Ä¢ Close all windows, doors, and ventilation systems
‚Ä¢ Move outdoor equipment and materials indoors
‚Ä¢ Advise employees to stay indoors until storm passes
‚Ä¢ Monitor air quality and visibility conditions
‚Ä¢ Secure loose items that could become projectiles

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about storm conditions
‚Ä¢ Advise employees to delay travel if possible
‚Ä¢ Notify customers about potential delivery delays
‚Ä¢ Monitor weather service updates and warnings
‚Ä¢ Provide safety guidance for those who must travel

RECOVERY PROCEDURES:
‚Ä¢ Assess damage to building exterior and equipment
‚Ä¢ Clean dust and debris from building systems
‚Ä¢ Check and clean HVAC filters and systems
‚Ä¢ Inspect outdoor equipment and signage for damage
‚Ä¢ Timeline: 2-4 hours for storm to pass, 4-8 hours for cleanup

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Secure building and assess damage
‚Ä¢ Safety Officer: Monitor conditions and provide safety guidance
‚Ä¢ Operations Manager: Adjust schedules and operations as needed
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Air filters and cleaning supplies
‚Ä¢ Protective masks for cleanup
‚Ä¢ Equipment covers and tarps
‚Ä¢ Backup HVAC filters`,

            'naturalHazards.meteorological.extremeTemperatures': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor temperature conditions and health advisories
‚Ä¢ Ensure HVAC systems are functioning properly
‚Ä¢ Provide water and cooling stations for employees
‚Ä¢ Adjust work schedules to avoid peak heat/cold times
‚Ä¢ Allow flexible work arrangements (remote work if possible)

COMMUNICATION PLAN:
‚Ä¢ Communicate heat/cold safety protocols to all staff
‚Ä¢ Advise employees about appropriate clothing and hydration
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Monitor weather forecasts and adjust plans accordingly
‚Ä¢ Provide regular updates on conditions and safety measures

RECOVERY PROCEDURES:
‚Ä¢ Assess HVAC system performance and make repairs if needed
‚Ä¢ Review and improve building insulation and climate control
‚Ä¢ Update policies for extreme weather conditions
‚Ä¢ Document any heat/cold related incidents
‚Ä¢ Timeline: Ongoing during extreme conditions, 1-2 days for system improvements

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Maintain HVAC systems and building comfort
‚Ä¢ HR Manager: Implement flexible work policies
‚Ä¢ Safety Officer: Monitor employee health and safety
‚Ä¢ Operations Manager: Adjust operations to maintain productivity

RESOURCES NEEDED:
‚Ä¢ Backup HVAC systems or portable units
‚Ä¢ Water and hydration supplies
‚Ä¢ Cooling/heating equipment
‚Ä¢ First aid supplies for heat/cold related issues`,

            'naturalHazards.meteorological.snow': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor weather forecasts and road conditions
‚Ä¢ Activate snow removal plan for parking lots and walkways
‚Ä¢ Ensure building heating systems are operational
‚Ä¢ Stock emergency supplies (salt, shovels, generators)
‚Ä¢ Implement flexible work arrangements (remote work)

COMMUNICATION PLAN:
‚Ä¢ Notify employees about weather conditions and travel safety
‚Ä¢ Communicate office closure or delayed opening if necessary
‚Ä¢ Update customers about service availability
‚Ä¢ Provide road condition updates and safety guidance
‚Ä¢ Establish communication protocol for weather-related decisions

RECOVERY PROCEDURES:
‚Ä¢ Clear parking lots, walkways, and access roads
‚Ä¢ Ensure safe entry and exit from building
‚Ä¢ Check for ice buildup and address safety hazards
‚Ä¢ Restore normal operations once conditions improve
‚Ä¢ Timeline: 2-6 hours for snow removal, immediate for remote work activation

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Coordinate snow removal and building safety
‚Ä¢ Operations Manager: Make closure/delay decisions
‚Ä¢ Safety Officer: Ensure safe conditions for employees
‚Ä¢ Communications Lead: Keep all stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Snow removal equipment and contractors
‚Ä¢ Salt and ice melt supplies
‚Ä¢ Backup generators for power outages
‚Ä¢ Remote work infrastructure`,

            'naturalHazards.meteorological.flood': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor flood warnings and evacuation orders
‚Ä¢ Move equipment and valuable items to higher floors
‚Ä¢ Shut off electrical systems in flood-prone areas
‚Ä¢ Secure important documents and data backups
‚Ä¢ Evacuate if ordered by authorities

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about flood conditions and evacuation orders
‚Ä¢ Notify customers about service disruptions
‚Ä¢ Coordinate with emergency services and local authorities
‚Ä¢ Provide regular updates on conditions and safety
‚Ä¢ Establish emergency contact protocols

RECOVERY PROCEDURES:
‚Ä¢ Wait for floodwaters to recede and area to be declared safe
‚Ä¢ Assess water damage to building, equipment, and inventory
‚Ä¢ Document all damage for insurance claims
‚Ä¢ Coordinate professional water damage restoration
‚Ä¢ Restore systems and operations from backups
‚Ä¢ Timeline: 1-3 days for water to recede, 1-4 weeks for full restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor conditions and coordinate response
‚Ä¢ Facilities Manager: Assess damage and coordinate restoration
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Insurance Coordinator: Document damage and file claims

RESOURCES NEEDED:
‚Ä¢ Water damage restoration services
‚Ä¢ Dehumidifiers and drying equipment
‚Ä¢ Data backup and recovery systems
‚Ä¢ Temporary workspace if building is unusable
‚Ä¢ Insurance documentation`,

            'naturalHazards.meteorological.lightning': `IMMEDIATE ACTIONS:
‚Ä¢ Move indoors immediately when lightning is detected
‚Ä¢ Avoid contact with electrical equipment and plumbing
‚Ä¢ Unplug sensitive electronic equipment if possible
‚Ä¢ Stay away from windows and doors
‚Ä¢ Wait 30 minutes after last lightning before resuming outdoor activities

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about lightning warnings
‚Ä¢ Advise employees to stay indoors and avoid travel
‚Ä¢ Notify customers about potential service disruptions
‚Ä¢ Monitor weather radar and lightning detection systems
‚Ä¢ Provide safety guidance for those caught outside

RECOVERY PROCEDURES:
‚Ä¢ Check for power surges and electrical damage
‚Ä¢ Test all electronic equipment and systems
‚Ä¢ Inspect building for fire or structural damage
‚Ä¢ Replace damaged equipment and systems
‚Ä¢ Review and improve lightning protection systems
‚Ä¢ Timeline: 1-2 hours for storm to pass, 2-4 hours for damage assessment

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Monitor conditions and ensure employee safety
‚Ä¢ IT Manager: Check and restore electronic systems
‚Ä¢ Facilities Manager: Assess building damage and repairs
‚Ä¢ Operations Manager: Adjust operations during storm

RESOURCES NEEDED:
‚Ä¢ Surge protectors and lightning protection systems
‚Ä¢ Backup power systems
‚Ä¢ Fire safety equipment
‚Ä¢ Equipment replacement budget`,

            'humanCaused.accidental.fire': `IMMEDIATE ACTIONS:
‚Ä¢ Activate fire alarm and evacuate building immediately
‚Ä¢ Call 911 and report fire location and details
‚Ä¢ Use fire extinguishers only if safe and trained
‚Ä¢ Close doors behind you to contain fire
‚Ä¢ Account for all personnel at designated assembly point

COMMUNICATION PLAN:
‚Ä¢ Notify emergency services immediately (911)
‚Ä¢ Alert all employees via alarm system and announcements
‚Ä¢ Contact building management and property owner
‚Ä¢ Inform customers about service disruption
‚Ä¢ Designate spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for fire department clearance before re-entering
‚Ä¢ Assess fire, smoke, and water damage
‚Ä¢ Coordinate with insurance adjuster and restoration company
‚Ä¢ Restore critical operations from alternate location
‚Ä¢ Replace damaged equipment and inventory
‚Ä¢ Timeline: 2-4 hours for fire department, 1-4 weeks for restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Coordinator: Oversee evacuation and account for personnel
‚Ä¢ Facilities Manager: Coordinate damage assessment and restoration
‚Ä¢ Insurance Coordinator: Document damage and file claims
‚Ä¢ Operations Manager: Establish alternate operations

RESOURCES NEEDED:
‚Ä¢ Fire restoration services
‚Ä¢ Temporary workspace
‚Ä¢ Equipment replacement
‚Ä¢ Data backup and recovery
‚Ä¢ Insurance documentation`,

            'humanCaused.accidental.buildingCollapse': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate building immediately if collapse is imminent
‚Ä¢ Call 911 and report structural emergency
‚Ä¢ Do not re-enter building under any circumstances
‚Ä¢ Account for all personnel at safe assembly point
‚Ä¢ Secure perimeter to prevent access to dangerous area

COMMUNICATION PLAN:
‚Ä¢ Notify emergency services immediately (911)
‚Ä¢ Alert all employees to evacuate immediately
‚Ä¢ Contact building owner and structural engineers
‚Ä¢ Inform customers about service disruption
‚Ä¢ Coordinate with emergency responders on site

RECOVERY PROCEDURES:
‚Ä¢ Wait for structural engineering assessment
‚Ä¢ Determine if building can be repaired or must be demolished
‚Ä¢ Establish operations from alternate location
‚Ä¢ Coordinate with insurance for coverage
‚Ä¢ Plan for long-term relocation if needed
‚Ä¢ Timeline: 1-2 days for assessment, weeks to months for resolution

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Oversee evacuation and safety
‚Ä¢ Facilities Manager: Coordinate with engineers and contractors
‚Ä¢ Operations Manager: Establish alternate operations immediately
‚Ä¢ Insurance Coordinator: Document situation and file claims

RESOURCES NEEDED:
‚Ä¢ Structural engineering assessment
‚Ä¢ Temporary or permanent alternate location
‚Ä¢ Equipment relocation
‚Ä¢ Data backup and recovery
‚Ä¢ Insurance and legal support`,

            'humanCaused.accidental.hazardousMaterialSpill': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate affected area immediately
‚Ä¢ Call 911 and report type of hazardous material
‚Ä¢ Isolate the area and prevent access
‚Ä¢ Follow Material Safety Data Sheet (MSDS) protocols
‚Ä¢ Notify hazardous materials response team

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about spill and evacuation
‚Ä¢ Contact emergency services and hazmat team
‚Ä¢ Notify local environmental and health authorities
‚Ä¢ Inform nearby businesses and residents if needed
‚Ä¢ Provide updates on containment and cleanup progress

RECOVERY PROCEDURES:
‚Ä¢ Wait for hazmat team clearance before re-entering
‚Ä¢ Coordinate professional cleanup and decontamination
‚Ä¢ Assess environmental impact and compliance requirements
‚Ä¢ Test air quality and surfaces before resuming operations
‚Ä¢ Document incident for regulatory reporting
‚Ä¢ Timeline: 4-8 hours for cleanup, 1-2 days for clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate evacuation and hazmat response
‚Ä¢ Environmental Coordinator: Ensure compliance and reporting
‚Ä¢ Facilities Manager: Coordinate cleanup and restoration
‚Ä¢ Operations Manager: Adjust operations during cleanup

RESOURCES NEEDED:
‚Ä¢ Professional hazmat cleanup services
‚Ä¢ Air quality testing equipment
‚Ä¢ Personal protective equipment
‚Ä¢ Environmental compliance documentation
‚Ä¢ Emergency response contacts`,

            'humanCaused.intentional.workplaceViolence': `IMMEDIATE ACTIONS:
‚Ä¢ Call 911 immediately and report the incident
‚Ä¢ Evacuate or secure-in-place as directed by authorities
‚Ä¢ Lock doors and barricade if necessary
‚Ä¢ Account for all personnel and report missing persons
‚Ä¢ Provide first aid to injured individuals if safe

COMMUNICATION PLAN:
‚Ä¢ Notify law enforcement immediately (911)
‚Ä¢ Alert all employees via emergency notification system
‚Ä¢ Contact security and building management
‚Ä¢ Inform families of affected employees (with sensitivity)
‚Ä¢ Designate official spokesperson for media

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with law enforcement investigation
‚Ä¢ Provide counseling and support services for employees
‚Ä¢ Review and enhance security measures
‚Ä¢ Conduct threat assessment and update security protocols
‚Ä¢ Resume operations when safe and appropriate
‚Ä¢ Timeline: Immediate for safety, days to weeks for full recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Coordinator: Work with law enforcement
‚Ä¢ HR Manager: Provide employee support and counseling
‚Ä¢ Safety Officer: Review and improve security measures
‚Ä¢ Communications Lead: Manage sensitive communications

RESOURCES NEEDED:
‚Ä¢ Security system enhancements
‚Ä¢ Employee assistance program (EAP) services
‚Ä¢ Counseling and trauma support
‚Ä¢ Law enforcement coordination
‚Ä¢ Legal and crisis management support`,

            'humanCaused.intentional.protests': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor protest activity and potential for escalation
‚Ä¢ Secure building entrances and restrict access if needed
‚Ä¢ Ensure employee safety and provide alternate entry/exit
‚Ä¢ Contact local law enforcement for support
‚Ä¢ Activate security protocols and monitoring

COMMUNICATION PLAN:
‚Ä¢ Alert employees about protest activity and safety measures
‚Ä¢ Provide guidance on safe entry/exit procedures
‚Ä¢ Notify customers about potential service disruptions
‚Ä¢ Coordinate with law enforcement on security measures
‚Ä¢ Monitor social media and news for updates

RECOVERY PROCEDURES:
‚Ä¢ Assess any damage to property or equipment
‚Ä¢ Review security footage and document incidents
‚Ä¢ Enhance security measures if needed
‚Ä¢ Resume normal operations when safe
‚Ä¢ Update security protocols based on experience
‚Ä¢ Timeline: Hours to days depending on protest duration

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Manager: Monitor situation and coordinate response
‚Ä¢ Facilities Manager: Secure building and assess damage
‚Ä¢ Operations Manager: Adjust operations to maintain safety
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Enhanced security personnel
‚Ä¢ Security camera monitoring
‚Ä¢ Alternate access routes
‚Ä¢ Law enforcement coordination
‚Ä¢ Property damage assessment`,

            'technological.infrastructureFailure': `IMMEDIATE ACTIONS:
‚Ä¢ Assess scope of infrastructure failure (power, water, internet, etc.)
‚Ä¢ Activate backup systems (generators, backup internet)
‚Ä¢ Notify utility providers about outages
‚Ä¢ Implement manual processes if systems are down
‚Ä¢ Document all failures and impacts

COMMUNICATION PLAN:
‚Ä¢ Notify all employees about infrastructure issues
‚Ä¢ Inform customers about service disruptions and expected duration
‚Ä¢ Coordinate with utility providers on restoration timeline
‚Ä¢ Provide regular updates on progress
‚Ä¢ Establish alternative communication methods if needed

RECOVERY PROCEDURES:
‚Ä¢ Work with utility providers to restore services
‚Ä¢ Test all systems once services are restored
‚Ä¢ Restore data and systems from backups
‚Ä¢ Review and improve backup systems
‚Ä¢ Document lessons learned and update procedures
‚Ä¢ Timeline: 2-24 hours depending on failure type

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Facilities Manager: Coordinate with utility providers
‚Ä¢ Operations Manager: Maintain operations with manual processes
‚Ä¢ Systems Administrator: Test and verify system restoration

RESOURCES NEEDED:
‚Ä¢ Backup power generators
‚Ä¢ Backup internet connections
‚Ä¢ Data backup and recovery systems
‚Ä¢ Manual process documentation
‚Ä¢ Utility provider contacts`,

            'technological.cyberSecurity': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate affected systems from network immediately
‚Ä¢ Preserve evidence (don't delete anything)
‚Ä¢ Notify IT security team and management
‚Ä¢ Change all passwords and access credentials
‚Ä¢ Assess scope of breach and data exposure

COMMUNICATION PLAN:
‚Ä¢ Notify IT security team and management immediately
‚Ä¢ Contact cybersecurity incident response professionals
‚Ä¢ Notify affected customers if personal data was compromised (per regulations)
‚Ä¢ Coordinate with law enforcement if criminal activity suspected
‚Ä¢ Provide updates on containment and resolution

RECOVERY PROCEDURES:
‚Ä¢ Conduct forensic analysis of breach
‚Ä¢ Remove malware and close security vulnerabilities
‚Ä¢ Restore clean systems from backups
‚Ä¢ Enhance security measures and monitoring
‚Ä¢ Review and update security policies
‚Ä¢ Timeline: Hours to days for containment, weeks for full recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead incident response
‚Ä¢ Systems Administrator: Isolate and restore systems
‚Ä¢ Legal/Compliance: Ensure regulatory notifications
‚Ä¢ Communications Lead: Manage customer notifications

RESOURCES NEEDED:
‚Ä¢ Cybersecurity incident response team
‚Ä¢ Forensic analysis tools
‚Ä¢ Clean system backups
‚Ä¢ Enhanced security software
‚Ä¢ Legal and compliance support`,

            // New Natural Hazards Events
            'naturalHazards.geological.tsunami': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate immediately to higher ground if tsunami warning is issued
‚Ä¢ Move to designated evacuation zones or at least 100 feet above sea level
‚Ä¢ Do not wait for official confirmation if you feel strong earthquake near coast
‚Ä¢ Secure facility and activate remote work protocols
‚Ä¢ Account for all personnel and ensure safe evacuation

COMMUNICATION PLAN:
‚Ä¢ Monitor official tsunami warnings and evacuation orders
‚Ä¢ Alert all employees immediately via emergency notification system
‚Ä¢ Notify customers about service disruptions and expected duration
‚Ä¢ Coordinate with local emergency management and authorities
‚Ä¢ Provide regular updates via website, social media, and phone

RECOVERY PROCEDURES:
‚Ä¢ Wait for official clearance before returning to coastal areas
‚Ä¢ Assess damage to building, equipment, and infrastructure
‚Ä¢ Coordinate with insurance adjusters and restoration companies
‚Ä¢ Test building systems (electrical, plumbing, HVAC) before reoccupying
‚Ä¢ Timeline: 2-4 hours for wave arrival, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor alerts and coordinate evacuation
‚Ä¢ Facilities Manager: Assess and coordinate building repairs
‚Ä¢ Safety Officer: Ensure safe return and building inspection
‚Ä¢ Operations Manager: Maintain business continuity remotely

RESOURCES NEEDED:
‚Ä¢ Emergency evacuation supplies and kits
‚Ä¢ Temporary workspace away from coast
‚Ä¢ Building inspection and restoration services
‚Ä¢ Data backup and recovery systems
‚Ä¢ Insurance documentation`,

            'naturalHazards.weather.hurricane': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor hurricane track and intensity forecasts continuously
‚Ä¢ Secure all outdoor equipment, furniture, and signage
‚Ä¢ Board up windows or install hurricane shutters
‚Ä¢ Move critical equipment and documents to secure, elevated locations
‚Ä¢ Evacuate if ordered by authorities or if in mandatory evacuation zone

COMMUNICATION PLAN:
‚Ä¢ Notify all employees about hurricane status and evacuation orders
‚Ä¢ Provide regular updates on office closure and reopening plans
‚Ä¢ Inform customers about service disruptions and expected duration
‚Ä¢ Establish emergency communication chain for status updates
‚Ä¢ Designate spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for official clearance before returning to area
‚Ä¢ Assess damage to building, equipment, and infrastructure
‚Ä¢ Document all damage for insurance claims with photos
‚Ä¢ Coordinate with restoration companies for cleanup and repairs
‚Ä¢ Restore critical systems and operations from backups
‚Ä¢ Timeline: 1-3 days for storm to pass, 1-4 weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor storm and coordinate response
‚Ä¢ Facilities Manager: Secure building and coordinate repairs
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Insurance Coordinator: Document damage and file claims

RESOURCES NEEDED:
‚Ä¢ Hurricane shutters or plywood for windows
‚Ä¢ Emergency supplies (water, food, batteries, generators)
‚Ä¢ Water damage restoration services
‚Ä¢ Data backup and recovery systems
‚Ä¢ Temporary workspace if building is damaged`,

            'naturalHazards.weather.tornado': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor tornado watches and warnings from National Weather Service
‚Ä¢ Move to designated tornado shelter (interior room, lowest floor, no windows)
‚Ä¢ If no shelter available, go to lowest interior room away from windows
‚Ä¢ Cover head and neck with arms and furniture for protection
‚Ä¢ Stay away from windows, doors, and exterior walls

COMMUNICATION PLAN:
‚Ä¢ Alert all employees immediately when tornado warning is issued
‚Ä¢ Notify employees to take shelter immediately
‚Ä¢ Inform customers about potential service disruptions
‚Ä¢ Provide updates after storm passes and assess damage
‚Ä¢ Coordinate with emergency services if injuries or damage occur

RECOVERY PROCEDURES:
‚Ä¢ Assess building damage and structural integrity before re-entry
‚Ä¢ Check for gas leaks, electrical hazards, and structural damage
‚Ä¢ Document all damage for insurance claims
‚Ä¢ Coordinate with restoration companies for repairs
‚Ä¢ Restore operations from alternate location if needed
‚Ä¢ Timeline: 15-30 minutes for storm, hours to days for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Coordinator: Oversee shelter procedures and safety
‚Ä¢ Facilities Manager: Assess damage and coordinate repairs
‚Ä¢ Emergency Coordinator: Coordinate with emergency services
‚Ä¢ Operations Manager: Establish alternate operations if needed

RESOURCES NEEDED:
‚Ä¢ Tornado shelter or safe room
‚Ä¢ Emergency supplies (first aid, flashlights, water)
‚Ä¢ Structural engineering assessment
‚Ä¢ Restoration and repair services
‚Ä¢ Temporary workspace if building is unsafe`,

            'naturalHazards.weather.blizzard': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor blizzard warnings and road conditions
‚Ä¢ Activate snow removal plan for parking lots and walkways
‚Ä¢ Ensure building heating systems are operational
‚Ä¢ Stock emergency supplies (food, water, generators, fuel)
‚Ä¢ Implement remote work arrangements for all non-essential staff

COMMUNICATION PLAN:
‚Ä¢ Notify employees about blizzard conditions and office closure
‚Ä¢ Advise employees to stay home and avoid travel
‚Ä¢ Update customers about service availability and delays
‚Ä¢ Provide regular updates on conditions and reopening plans
‚Ä¢ Establish emergency communication protocol

RECOVERY PROCEDURES:
‚Ä¢ Clear parking lots, walkways, and access roads
‚Ä¢ Ensure safe entry and exit from building
‚Ä¢ Check for ice buildup and address safety hazards
‚Ä¢ Restore normal operations once conditions improve
‚Ä¢ Timeline: 1-3 days for blizzard, 4-8 hours for snow removal

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Coordinate snow removal and building safety
‚Ä¢ Operations Manager: Make closure decisions and manage remote work
‚Ä¢ Safety Officer: Ensure safe conditions for employees
‚Ä¢ Communications Lead: Keep all stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Snow removal equipment and contractors
‚Ä¢ Salt and ice melt supplies
‚Ä¢ Backup generators and fuel
‚Ä¢ Emergency food and water supplies
‚Ä¢ Remote work infrastructure`,

            'naturalHazards.weather.heatWave': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor temperature conditions and heat advisories
‚Ä¢ Ensure HVAC systems are functioning at maximum capacity
‚Ä¢ Provide water, cooling stations, and shaded rest areas
‚Ä¢ Adjust work schedules to avoid peak heat times (early morning/late evening)
‚Ä¢ Allow flexible work arrangements and frequent breaks

COMMUNICATION PLAN:
‚Ä¢ Communicate heat safety protocols to all staff
‚Ä¢ Advise employees about hydration, appropriate clothing, and rest breaks
‚Ä¢ Notify customers about potential service adjustments during peak heat
‚Ä¢ Monitor weather forecasts and adjust plans accordingly
‚Ä¢ Provide regular updates on conditions and safety measures

RECOVERY PROCEDURES:
‚Ä¢ Assess HVAC system performance and make immediate repairs if needed
‚Ä¢ Review and improve building insulation and climate control
‚Ä¢ Update policies for extreme heat conditions
‚Ä¢ Document any heat-related incidents or illnesses
‚Ä¢ Timeline: Ongoing during heat wave, 1-2 days for system improvements

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Maintain HVAC systems and building comfort
‚Ä¢ HR Manager: Implement flexible work policies and heat safety protocols
‚Ä¢ Safety Officer: Monitor employee health and prevent heat illness
‚Ä¢ Operations Manager: Adjust operations to maintain productivity safely

RESOURCES NEEDED:
‚Ä¢ Backup HVAC systems or portable cooling units
‚Ä¢ Water and hydration supplies
‚Ä¢ Cooling equipment and fans
‚Ä¢ First aid supplies for heat-related issues
‚Ä¢ Shaded rest areas`,

            'naturalHazards.hydrological.flood': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor flood warnings and evacuation orders from authorities
‚Ä¢ Move equipment and valuable items to higher floors or elevated areas
‚Ä¢ Shut off electrical systems in flood-prone areas
‚Ä¢ Secure important documents and data backups
‚Ä¢ Evacuate if ordered by authorities or if flooding is imminent

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about flood conditions and evacuation orders
‚Ä¢ Notify customers about service disruptions and expected duration
‚Ä¢ Coordinate with emergency services and local authorities
‚Ä¢ Provide regular updates on conditions and safety
‚Ä¢ Establish emergency contact protocols

RECOVERY PROCEDURES:
‚Ä¢ Wait for floodwaters to recede and area to be declared safe
‚Ä¢ Assess water damage to building, equipment, and inventory
‚Ä¢ Document all damage for insurance claims
‚Ä¢ Coordinate professional water damage restoration
‚Ä¢ Restore systems and operations from backups
‚Ä¢ Timeline: 1-3 days for water to recede, 1-4 weeks for full restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor conditions and coordinate response
‚Ä¢ Facilities Manager: Assess damage and coordinate restoration
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Insurance Coordinator: Document damage and file claims

RESOURCES NEEDED:
‚Ä¢ Water damage restoration services
‚Ä¢ Dehumidifiers and drying equipment
‚Ä¢ Data backup and recovery systems
‚Ä¢ Temporary workspace if building is unusable
‚Ä¢ Insurance documentation`,

            'naturalHazards.hydrological.drought': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor drought conditions and water restrictions
‚Ä¢ Implement water conservation measures immediately
‚Ä¢ Reduce non-essential water usage (landscaping, cleaning)
‚Ä¢ Check for water leaks and repair immediately
‚Ä¢ Consider alternative water sources if available

COMMUNICATION PLAN:
‚Ä¢ Communicate water conservation requirements to all staff
‚Ä¢ Educate employees about drought conditions and restrictions
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with local water authorities on restrictions
‚Ä¢ Provide updates on drought conditions and conservation efforts

RECOVERY PROCEDURES:
‚Ä¢ Continue water conservation practices
‚Ä¢ Assess water usage patterns and identify further savings
‚Ä¢ Update building systems for water efficiency
‚Ä¢ Consider long-term water sustainability measures
‚Ä¢ Timeline: Ongoing during drought, weeks to months for full recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Implement water conservation and efficiency measures
‚Ä¢ Operations Manager: Adjust operations to minimize water usage
‚Ä¢ Environmental Coordinator: Monitor compliance with restrictions
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Water-efficient fixtures and equipment
‚Ä¢ Water monitoring and leak detection systems
‚Ä¢ Alternative water sources if available
‚Ä¢ Water conservation education materials
‚Ä¢ Drought-resistant landscaping`,

            'naturalHazards.hydrological.stormSurge': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor storm surge warnings and evacuation orders
‚Ä¢ Move equipment and valuable items to higher floors or elevated areas
‚Ä¢ Secure facility and activate remote work protocols
‚Ä¢ Evacuate if ordered by authorities or if surge is imminent
‚Ä¢ Account for all personnel and ensure safe evacuation

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about storm surge warnings and evacuation orders
‚Ä¢ Notify customers about service disruptions and expected duration
‚Ä¢ Coordinate with emergency services and local authorities
‚Ä¢ Provide regular updates on conditions and safety
‚Ä¢ Establish emergency contact protocols

RECOVERY PROCEDURES:
‚Ä¢ Wait for official clearance before returning to area
‚Ä¢ Assess damage to building, equipment, and infrastructure
‚Ä¢ Document all damage for insurance claims
‚Ä¢ Coordinate professional restoration services
‚Ä¢ Restore systems and operations from backups
‚Ä¢ Timeline: 2-6 hours for surge, 1-3 weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor alerts and coordinate evacuation
‚Ä¢ Facilities Manager: Assess damage and coordinate restoration
‚Ä¢ Safety Officer: Ensure safe return and building inspection
‚Ä¢ Operations Manager: Maintain business continuity remotely

RESOURCES NEEDED:
‚Ä¢ Emergency evacuation supplies
‚Ä¢ Water damage restoration services
‚Ä¢ Temporary workspace away from coast
‚Ä¢ Data backup and recovery systems
‚Ä¢ Insurance documentation`,

            'naturalHazards.wildfire.forestFire': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor wildfire alerts and evacuation orders
‚Ä¢ Close all windows, doors, and ventilation systems
‚Ä¢ Remove combustible materials from around building
‚Ä¢ Evacuate immediately if ordered by authorities
‚Ä¢ Activate remote work protocols for all staff

COMMUNICATION PLAN:
‚Ä¢ Alert all employees about wildfire conditions and evacuation orders
‚Ä¢ Notify customers about service disruptions and expected duration
‚Ä¢ Coordinate with local fire department and emergency management
‚Ä¢ Provide regular updates on fire status and safety
‚Ä¢ Establish emergency communication chain

RECOVERY PROCEDURES:
‚Ä¢ Wait for official clearance before returning to area
‚Ä¢ Assess smoke and fire damage to building and equipment
‚Ä¢ Test air quality before reoccupying building
‚Ä¢ Clean HVAC systems and replace filters
‚Ä¢ Coordinate professional restoration if needed
‚Ä¢ Timeline: Days to weeks for fire containment, 1-2 weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor fire status and coordinate response
‚Ä¢ Facilities Manager: Secure building and coordinate restoration
‚Ä¢ Safety Officer: Ensure safe return and air quality testing
‚Ä¢ Operations Manager: Maintain business continuity remotely

RESOURCES NEEDED:
‚Ä¢ N95 masks and protective equipment
‚Ä¢ Air quality testing equipment
‚Ä¢ Professional cleaning and restoration services
‚Ä¢ Remote work infrastructure
‚Ä¢ Data backup and recovery systems`,

            'naturalHazards.wildfire.brushFire': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor brush fire alerts and evacuation orders
‚Ä¢ Close all windows, doors, and ventilation systems
‚Ä¢ Remove combustible materials from around building perimeter
‚Ä¢ Evacuate immediately if ordered by authorities
‚Ä¢ Activate remote work protocols for all staff

COMMUNICATION PLAN:
‚Ä¢ Alert all employees about brush fire conditions and evacuation orders
‚Ä¢ Notify customers about service disruptions and expected duration
‚Ä¢ Coordinate with local fire department and emergency management
‚Ä¢ Provide regular updates on fire status and safety
‚Ä¢ Establish emergency communication chain

RECOVERY PROCEDURES:
‚Ä¢ Wait for official clearance before returning to area
‚Ä¢ Assess smoke and fire damage to building and equipment
‚Ä¢ Test air quality before reoccupying building
‚Ä¢ Clean HVAC systems and replace filters
‚Ä¢ Coordinate professional restoration if needed
‚Ä¢ Timeline: Hours to days for fire containment, 3-7 days for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Monitor fire status and coordinate response
‚Ä¢ Facilities Manager: Secure building and coordinate restoration
‚Ä¢ Safety Officer: Ensure safe return and air quality testing
‚Ä¢ Operations Manager: Maintain business continuity remotely

RESOURCES NEEDED:
‚Ä¢ N95 masks and protective equipment
‚Ä¢ Air quality testing equipment
‚Ä¢ Professional cleaning and restoration services
‚Ä¢ Remote work infrastructure
‚Ä¢ Data backup and recovery systems`,

            // New Human Caused Events
            'humanCaused.violence.activeShooter': `IMMEDIATE ACTIONS:
‚Ä¢ Run: Evacuate immediately if safe to do so, leave belongings behind
‚Ä¢ Hide: If evacuation not possible, hide in locked room, silence phones, barricade doors
‚Ä¢ Fight: As last resort, act aggressively to incapacitate shooter
‚Ä¢ Call 911 when safe to do so
‚Ä¢ Do not pull fire alarm (may bring people into danger)

COMMUNICATION PLAN:
‚Ä¢ Notify law enforcement immediately (911)
‚Ä¢ Alert all employees via emergency notification system
‚Ä¢ Follow law enforcement instructions precisely
‚Ä¢ Designate official spokesperson for media inquiries
‚Ä¢ Contact families of affected employees (with sensitivity)

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with law enforcement investigation
‚Ä¢ Provide counseling and support services for all employees
‚Ä¢ Conduct security assessment and enhance measures
‚Ä¢ Review and update active shooter response protocols
‚Ä¢ Timeline: Hours for incident, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Coordinator: Coordinate with law enforcement
‚Ä¢ HR Manager: Provide employee support and counseling
‚Ä¢ Emergency Coordinator: Manage response and recovery
‚Ä¢ Communications Lead: Manage all external communications

RESOURCES NEEDED:
‚Ä¢ Employee assistance program (EAP) services
‚Ä¢ Trauma counseling and support services
‚Ä¢ Security system enhancements
‚Ä¢ Law enforcement coordination
‚Ä¢ Legal and crisis management support`,

            'humanCaused.violence.civilUnrest': `IMMEDIATE ACTIONS:
‚Ä¢ Monitor situation and potential for escalation
‚Ä¢ Secure building entrances and restrict access if needed
‚Ä¢ Ensure employee safety and provide alternate entry/exit routes
‚Ä¢ Contact local law enforcement for support
‚Ä¢ Activate security protocols and monitoring

COMMUNICATION PLAN:
‚Ä¢ Alert employees about civil unrest and safety measures
‚Ä¢ Provide guidance on safe entry/exit procedures
‚Ä¢ Notify customers about potential service disruptions
‚Ä¢ Coordinate with law enforcement on security measures
‚Ä¢ Monitor social media and news for updates

RECOVERY PROCEDURES:
‚Ä¢ Assess any damage to property or equipment
‚Ä¢ Review security footage and document incidents
‚Ä¢ Enhance security measures if needed
‚Ä¢ Resume normal operations when safe
‚Ä¢ Update security protocols based on experience
‚Ä¢ Timeline: Hours to days depending on unrest duration

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Manager: Monitor situation and coordinate response
‚Ä¢ Facilities Manager: Secure building and assess damage
‚Ä¢ Operations Manager: Adjust operations to maintain safety
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Enhanced security systems
‚Ä¢ Law enforcement coordination
‚Ä¢ Temporary access controls
‚Ä¢ Employee safety protocols
‚Ä¢ Crisis management support`,

            'humanCaused.terrorism.bombThreat': `IMMEDIATE ACTIONS:
‚Ä¢ If threat received by phone, keep caller on line and gather information
‚Ä¢ Evacuate building immediately following established routes
‚Ä¢ Do not use elevators or cell phones near building
‚Ä¢ Contact law enforcement immediately (911)
‚Ä¢ Account for all personnel at designated assembly point

COMMUNICATION PLAN:
‚Ä¢ Notify law enforcement immediately (911)
‚Ä¢ Alert all employees to evacuate via emergency system
‚Ä¢ Do not discuss threat details publicly
‚Ä¢ Follow law enforcement instructions precisely
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for law enforcement clearance before re-entering
‚Ä¢ Coordinate with bomb squad and security experts
‚Ä¢ Conduct security assessment and enhance measures
‚Ä¢ Review and update bomb threat response protocols
‚Ä¢ Timeline: 2-4 hours for threat assessment, immediate for evacuation

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Coordinator: Coordinate with law enforcement
‚Ä¢ Emergency Coordinator: Oversee evacuation and safety
‚Ä¢ Facilities Manager: Secure building and coordinate assessment
‚Ä¢ Communications Lead: Manage all external communications

RESOURCES NEEDED:
‚Ä¢ Law enforcement coordination
‚Ä¢ Bomb threat assessment protocols
‚Ä¢ Enhanced security systems
‚Ä¢ Employee safety training
‚Ä¢ Crisis management support`,

            'humanCaused.terrorism.chemicalAttack': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate immediately if chemical release detected
‚Ä¢ Move upwind and away from source
‚Ä¢ Cover mouth and nose with cloth if possible
‚Ä¢ Remove contaminated clothing and wash exposed skin
‚Ä¢ Seek medical attention immediately

COMMUNICATION PLAN:
‚Ä¢ Notify emergency services immediately (911)
‚Ä¢ Alert all employees to evacuate via emergency system
‚Ä¢ Follow instructions from hazmat and emergency responders
‚Ä¢ Coordinate with public health authorities
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for hazmat team clearance before re-entering
‚Ä¢ Coordinate professional decontamination if needed
‚Ä¢ Test air quality and surfaces before resuming operations
‚Ä¢ Provide medical monitoring for exposed employees
‚Ä¢ Timeline: Hours for decontamination, days for clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate evacuation and hazmat response
‚Ä¢ Emergency Coordinator: Oversee response and recovery
‚Ä¢ Medical Coordinator: Ensure employee health monitoring
‚Ä¢ Communications Lead: Manage all external communications

RESOURCES NEEDED:
‚Ä¢ Hazmat response coordination
‚Ä¢ Decontamination services
‚Ä¢ Air quality testing equipment
‚Ä¢ Medical monitoring and support
‚Ä¢ Employee assistance services`,

            'humanCaused.terrorism.sabotage': `IMMEDIATE ACTIONS:
‚Ä¢ Secure affected area and prevent further access
‚Ä¢ Document all evidence without disturbing scene
‚Ä¢ Contact law enforcement immediately (911)
‚Ä¢ Assess extent of sabotage and potential ongoing threat
‚Ä¢ Activate security protocols and monitoring

COMMUNICATION PLAN:
‚Ä¢ Notify law enforcement immediately (911)
‚Ä¢ Alert security team and management
‚Ä¢ Do not discuss sabotage details publicly
‚Ä¢ Follow law enforcement instructions precisely
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with law enforcement investigation
‚Ä¢ Assess damage and restore affected systems
‚Ä¢ Enhance security measures and access controls
‚Ä¢ Review and update security protocols
‚Ä¢ Timeline: Hours for assessment, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Coordinator: Coordinate with law enforcement
‚Ä¢ IT Manager: Assess and restore affected systems
‚Ä¢ Facilities Manager: Secure building and assess damage
‚Ä¢ Emergency Coordinator: Oversee response and recovery

RESOURCES NEEDED:
‚Ä¢ Law enforcement coordination
‚Ä¢ Forensic investigation support
‚Ä¢ Enhanced security systems
‚Ä¢ System restoration capabilities
‚Ä¢ Crisis management support`,

            'humanCaused.accidents.industrialAccident': `IMMEDIATE ACTIONS:
‚Ä¢ Ensure employee safety and evacuate affected area
‚Ä¢ Call 911 and report type of accident and injuries
‚Ä¢ Provide first aid to injured individuals if safe
‚Ä¢ Secure area to prevent further accidents
‚Ä¢ Account for all personnel

COMMUNICATION PLAN:
‚Ä¢ Notify emergency services immediately (911)
‚Ä¢ Alert all employees about accident and safety measures
‚Ä¢ Contact families of injured employees
‚Ä¢ Notify regulatory authorities as required
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with emergency responders and investigators
‚Ä¢ Assess cause of accident and implement corrective measures
‚Ä¢ Review and update safety protocols
‚Ä¢ Provide support to affected employees
‚Ä¢ Timeline: Hours for response, days to weeks for investigation

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate response and investigation
‚Ä¢ Emergency Coordinator: Oversee response and recovery
‚Ä¢ HR Manager: Provide employee support
‚Ä¢ Operations Manager: Adjust operations and implement safety measures

RESOURCES NEEDED:
‚Ä¢ Emergency response coordination
‚Ä¢ Safety investigation support
‚Ä¢ Employee assistance services
‚Ä¢ Regulatory compliance support
‚Ä¢ Safety training and equipment`,

            'humanCaused.accidents.transportationCrash': `IMMEDIATE ACTIONS:
‚Ä¢ Ensure employee safety and provide first aid
‚Ä¢ Call 911 and report crash location and injuries
‚Ä¢ Secure area to prevent further accidents
‚Ä¢ Document scene for insurance and investigation
‚Ä¢ Account for all personnel

COMMUNICATION PLAN:
‚Ä¢ Notify emergency services immediately (911)
‚Ä¢ Alert all employees about crash and safety measures
‚Ä¢ Contact families of affected employees
‚Ä¢ Notify insurance company
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with emergency responders and investigators
‚Ä¢ Assess damage and arrange for vehicle/equipment replacement
‚Ä¢ Review transportation safety protocols
‚Ä¢ Provide support to affected employees
‚Ä¢ Timeline: Hours for response, days for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate response and investigation
‚Ä¢ Fleet Manager: Assess damage and arrange replacement
‚Ä¢ HR Manager: Provide employee support
‚Ä¢ Insurance Coordinator: Document damage and file claims

RESOURCES NEEDED:
‚Ä¢ Emergency response coordination
‚Ä¢ Vehicle/equipment replacement
‚Ä¢ Employee assistance services
‚Ä¢ Insurance documentation
‚Ä¢ Transportation safety protocols`,

            'humanCaused.accidents.humanErrorSpill': `IMMEDIATE ACTIONS:
‚Ä¢ Contain spill immediately to prevent spread
‚Ä¢ Evacuate affected area if hazardous
‚Ä¢ Call 911 and report type of material spilled
‚Ä¢ Follow Material Safety Data Sheet (MSDS) protocols
‚Ä¢ Notify hazardous materials response team if needed

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about spill and safety measures
‚Ä¢ Contact emergency services and hazmat team if needed
‚Ä¢ Notify regulatory authorities as required
‚Ä¢ Inform nearby businesses if spill affects them
‚Ä¢ Provide updates on containment and cleanup progress

RECOVERY PROCEDURES:
‚Ä¢ Coordinate professional cleanup and decontamination
‚Ä¢ Assess environmental impact and compliance requirements
‚Ä¢ Review and update spill response protocols
‚Ä¢ Provide additional training to prevent future incidents
‚Ä¢ Timeline: 2-8 hours for cleanup, 1-2 days for clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate spill response and cleanup
‚Ä¢ Environmental Coordinator: Ensure compliance and reporting
‚Ä¢ Facilities Manager: Coordinate cleanup and restoration
‚Ä¢ Training Coordinator: Update protocols and training

RESOURCES NEEDED:
‚Ä¢ Spill containment equipment
‚Ä¢ Professional cleanup services
‚Ä¢ Environmental compliance support
‚Ä¢ Safety training materials
‚Ä¢ Emergency response contacts`,

            'humanCaused.social.strike': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and staffing
‚Ä¢ Implement contingency staffing plans
‚Ä¢ Maintain open communication with union/employee representatives
‚Ä¢ Ensure safety and security of facilities
‚Ä¢ Document all incidents and communications

COMMUNICATION PLAN:
‚Ä¢ Communicate with union/employee representatives
‚Ä¢ Notify customers about potential service disruptions
‚Ä¢ Keep all stakeholders informed of situation
‚Ä¢ Maintain respectful and professional communication
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Negotiate resolution with union/employee representatives
‚Ä¢ Restore normal operations when strike ends
‚Ä¢ Address underlying issues that led to strike
‚Ä¢ Rebuild relationships and trust with employees
‚Ä¢ Timeline: Days to weeks depending on negotiations

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Lead negotiations and communication
‚Ä¢ Operations Manager: Maintain operations during strike
‚Ä¢ Legal Counsel: Provide guidance on labor law
‚Ä¢ Communications Lead: Manage all external communications

RESOURCES NEEDED:
‚Ä¢ Labor relations support
‚Ä¢ Legal counsel
‚Ä¢ Contingency staffing
‚Ä¢ Security services if needed
‚Ä¢ Mediation services`,

            'humanCaused.social.massGathering': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and access
‚Ä¢ Implement crowd control measures if needed
‚Ä¢ Ensure employee safety and alternate access routes
‚Ä¢ Coordinate with local authorities and event organizers
‚Ä¢ Adjust operations to accommodate gathering

COMMUNICATION PLAN:
‚Ä¢ Alert employees about gathering and access changes
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with local authorities and event organizers
‚Ä¢ Provide updates on situation and access
‚Ä¢ Monitor social media and news for updates

RECOVERY PROCEDURES:
‚Ä¢ Assess any impact on operations
‚Ä¢ Resume normal operations when gathering ends
‚Ä¢ Review and update crowd management protocols
‚Ä¢ Document lessons learned
‚Ä¢ Timeline: Hours to days depending on gathering duration

ROLES & RESPONSIBILITIES:
‚Ä¢ Security Manager: Coordinate crowd control and safety
‚Ä¢ Operations Manager: Adjust operations as needed
‚Ä¢ Facilities Manager: Manage access and facilities
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Crowd control measures
‚Ä¢ Security services if needed
‚Ä¢ Alternate access routes
‚Ä¢ Communication systems
‚Ä¢ Coordination with authorities`,

            // New Technological Issues
            'technological.infrastructure.powerOutage': `IMMEDIATE ACTIONS:
‚Ä¢ Assess scope of power outage (building only or area-wide)
‚Ä¢ Activate backup generators if available
‚Ä¢ Preserve battery power on critical devices
‚Ä¢ Secure facility and account for all personnel
‚Ä¢ Contact utility company to report outage

COMMUNICATION PLAN:
‚Ä¢ Alert all employees about power outage and safety measures
‚Ä¢ Notify customers about service disruptions
‚Ä¢ Coordinate with utility company on restoration timeline
‚Ä¢ Provide updates on power restoration status
‚Ä¢ Establish alternative communication methods if phones down

RECOVERY PROCEDURES:
‚Ä¢ Wait for power restoration and verify stability
‚Ä¢ Check all systems and equipment for damage
‚Ä¢ Restore data and systems from backups if needed
‚Ä¢ Test all critical systems before resuming operations
‚Ä¢ Timeline: 2-24 hours depending on outage cause and scope

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Coordinate with utility and manage generators
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Operations Manager: Adjust operations during outage
‚Ä¢ Safety Officer: Ensure employee safety

RESOURCES NEEDED:
‚Ä¢ Backup generators and fuel
‚Ä¢ Battery-powered lighting and equipment
‚Ä¢ Data backup and recovery systems
‚Ä¢ Alternative communication methods
‚Ä¢ Utility company contacts`,

            'technological.infrastructure.gridCollapse': `IMMEDIATE ACTIONS:
‚Ä¢ Activate all backup power systems immediately
‚Ä¢ Preserve battery power on critical devices
‚Ä¢ Secure facility and account for all personnel
‚Ä¢ Contact utility company and emergency services
‚Ä¢ Implement emergency power conservation measures

COMMUNICATION PLAN:
‚Ä¢ Alert all employees about grid collapse and extended outage
‚Ä¢ Notify customers about major service disruptions
‚Ä¢ Coordinate with utility company and emergency services
‚Ä¢ Provide regular updates on situation and restoration timeline
‚Ä¢ Establish alternative communication methods

RECOVERY PROCEDURES:
‚Ä¢ Wait for grid restoration and verify stability
‚Ä¢ Gradually restore systems and operations
‚Ä¢ Check all systems and equipment for damage
‚Ä¢ Restore data and systems from backups
‚Ä¢ Timeline: Hours to days depending on grid restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Manage backup power and coordinate with utility
‚Ä¢ IT Manager: Restore systems and data from backups
‚Ä¢ Emergency Coordinator: Oversee response and recovery
‚Ä¢ Operations Manager: Maintain critical operations

RESOURCES NEEDED:
‚Ä¢ Extended backup power systems and fuel
‚Ä¢ Battery-powered equipment and lighting
‚Ä¢ Data backup and recovery systems
‚Ä¢ Alternative communication methods
‚Ä¢ Emergency supplies`,

            'technological.infrastructure.utilityDisruption': `IMMEDIATE ACTIONS:
‚Ä¢ Assess which utilities are affected (water, gas, sewer, internet)
‚Ä¢ Implement conservation measures for available utilities
‚Ä¢ Activate backup systems where available
‚Ä¢ Contact utility companies to report disruptions
‚Ä¢ Secure facility and account for all personnel

COMMUNICATION PLAN:
‚Ä¢ Alert all employees about utility disruptions
‚Ä¢ Notify customers about service impacts
‚Ä¢ Coordinate with utility companies on restoration timeline
‚Ä¢ Provide updates on restoration status
‚Ä¢ Establish alternative communication methods if needed

RECOVERY PROCEDURES:
‚Ä¢ Wait for utility restoration and verify stability
‚Ä¢ Test all systems before resuming operations
‚Ä¢ Check for damage to building systems
‚Ä¢ Restore normal operations gradually
‚Ä¢ Timeline: Hours to days depending on disruption type

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Coordinate with utilities and manage systems
‚Ä¢ Operations Manager: Adjust operations during disruption
‚Ä¢ IT Manager: Restore systems if internet affected
‚Ä¢ Safety Officer: Ensure employee safety and comfort

RESOURCES NEEDED:
‚Ä¢ Backup systems for critical utilities
‚Ä¢ Alternative water and sanitation if needed
‚Ä¢ Data backup and recovery systems
‚Ä¢ Utility company contacts
‚Ä¢ Emergency supplies`,

            'technological.hazmat.chemicalSpill': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate affected area immediately
‚Ä¢ Call 911 and report type of chemical
‚Ä¢ Isolate area and prevent access
‚Ä¢ Follow Material Safety Data Sheet (MSDS) protocols
‚Ä¢ Notify hazardous materials response team

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about chemical spill and evacuation
‚Ä¢ Contact emergency services and hazmat team
‚Ä¢ Notify local environmental and health authorities
‚Ä¢ Inform nearby businesses if spill affects them
‚Ä¢ Provide updates on containment and cleanup progress

RECOVERY PROCEDURES:
‚Ä¢ Wait for hazmat team clearance before re-entering
‚Ä¢ Coordinate professional cleanup and decontamination
‚Ä¢ Assess environmental impact and compliance requirements
‚Ä¢ Test air quality and surfaces before resuming operations
‚Ä¢ Timeline: 4-8 hours for cleanup, 1-2 days for clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate evacuation and hazmat response
‚Ä¢ Environmental Coordinator: Ensure compliance and reporting
‚Ä¢ Facilities Manager: Coordinate cleanup and restoration
‚Ä¢ Operations Manager: Adjust operations during cleanup

RESOURCES NEEDED:
‚Ä¢ Professional hazmat cleanup services
‚Ä¢ Air quality testing equipment
‚Ä¢ Personal protective equipment
‚Ä¢ Environmental compliance documentation
‚Ä¢ Emergency response contacts`,

            'technological.hazmat.radiationLeak': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate affected area immediately
‚Ä¢ Call 911 and report radiation leak
‚Ä¢ Isolate area and prevent access
‚Ä¢ Follow radiation safety protocols
‚Ä¢ Notify radiation safety officer and emergency services

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about radiation leak and evacuation
‚Ä¢ Contact emergency services and radiation safety authorities
‚Ä¢ Notify regulatory authorities (NRC, state agencies)
‚Ä¢ Inform nearby businesses and residents if needed
‚Ä¢ Provide updates on containment and safety

RECOVERY PROCEDURES:
‚Ä¢ Wait for radiation safety clearance before re-entering
‚Ä¢ Coordinate professional decontamination and assessment
‚Ä¢ Monitor radiation levels continuously
‚Ä¢ Provide medical monitoring for exposed employees
‚Ä¢ Timeline: Hours to days for assessment and clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Radiation Safety Officer: Coordinate response and assessment
‚Ä¢ Safety Officer: Ensure employee safety and evacuation
‚Ä¢ Medical Coordinator: Provide health monitoring
‚Ä¢ Environmental Coordinator: Ensure compliance and reporting

RESOURCES NEEDED:
‚Ä¢ Radiation detection and monitoring equipment
‚Ä¢ Professional radiation cleanup services
‚Ä¢ Medical monitoring and support
‚Ä¢ Regulatory compliance support
‚Ä¢ Emergency response contacts`,

            'technological.hazmat.industrialExplosion': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate building immediately
‚Ä¢ Call 911 and report explosion location and details
‚Ä¢ Account for all personnel at designated assembly point
‚Ä¢ Do not re-enter building until cleared by authorities
‚Ä¢ Provide first aid to injured individuals if safe

COMMUNICATION PLAN:
‚Ä¢ Notify emergency services immediately (911)
‚Ä¢ Alert all employees to evacuate via emergency system
‚Ä¢ Contact families of affected employees
‚Ä¢ Notify regulatory authorities as required
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for emergency services clearance before re-entering
‚Ä¢ Assess structural damage and building safety
‚Ä¢ Coordinate with investigators and insurance
‚Ä¢ Restore operations from alternate location if needed
‚Ä¢ Timeline: Hours for response, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Emergency Coordinator: Oversee evacuation and response
‚Ä¢ Facilities Manager: Assess damage and coordinate repairs
‚Ä¢ Safety Officer: Coordinate with emergency services
‚Ä¢ Insurance Coordinator: Document damage and file claims

RESOURCES NEEDED:
‚Ä¢ Emergency response coordination
‚Ä¢ Structural engineering assessment
‚Ä¢ Temporary workspace if needed
‚Ä¢ Insurance documentation
‚Ä¢ Investigation support`,

            'technological.equipment.machineryBreakdown': `IMMEDIATE ACTIONS:
‚Ä¢ Shut down affected machinery immediately
‚Ä¢ Secure area to prevent accidents
‚Ä¢ Assess impact on operations
‚Ä¢ Contact maintenance team or service provider
‚Ä¢ Implement workarounds if possible

COMMUNICATION PLAN:
‚Ä¢ Alert relevant personnel about machinery breakdown
‚Ä¢ Notify customers about potential delays
‚Ä¢ Coordinate with maintenance and service providers
‚Ä¢ Provide updates on repair timeline
‚Ä¢ Communicate workarounds and alternative processes

RECOVERY PROCEDURES:
‚Ä¢ Coordinate repair or replacement of machinery
‚Ä¢ Test machinery thoroughly before resuming operations
‚Ä¢ Review maintenance schedules and improve protocols
‚Ä¢ Document breakdown cause and preventive measures
‚Ä¢ Timeline: Hours to days depending on repair complexity

ROLES & RESPONSIBILITIES:
‚Ä¢ Operations Manager: Adjust operations and coordinate workarounds
‚Ä¢ Maintenance Manager: Coordinate repairs and service
‚Ä¢ Facilities Manager: Assess impact and support repairs
‚Ä¢ Safety Officer: Ensure safe shutdown and repair

RESOURCES NEEDED:
‚Ä¢ Maintenance and repair services
‚Ä¢ Backup equipment if available
‚Ä¢ Service provider contacts
‚Ä¢ Maintenance documentation
‚Ä¢ Safety equipment`,

            'technological.equipment.vehicleFailure': `IMMEDIATE ACTIONS:
‚Ä¢ Ensure driver and passenger safety
‚Ä¢ Move vehicle to safe location if possible
‚Ä¢ Contact roadside assistance or towing service
‚Ä¢ Assess impact on operations and deliveries
‚Ä¢ Implement alternative transportation if needed

COMMUNICATION PLAN:
‚Ä¢ Alert relevant personnel about vehicle failure
‚Ä¢ Notify customers about potential delivery delays
‚Ä¢ Coordinate with service providers and insurance
‚Ä¢ Provide updates on repair timeline
‚Ä¢ Communicate alternative arrangements

RECOVERY PROCEDURES:
‚Ä¢ Coordinate repair or replacement of vehicle
‚Ä¢ Review vehicle maintenance schedules
‚Ä¢ Assess need for backup vehicles
‚Ä¢ Document failure cause and preventive measures
‚Ä¢ Timeline: Hours to days depending on repair needs

ROLES & RESPONSIBILITIES:
‚Ä¢ Fleet Manager: Coordinate repairs and replacements
‚Ä¢ Operations Manager: Adjust operations and deliveries
‚Ä¢ Safety Officer: Ensure driver safety
‚Ä¢ Insurance Coordinator: Document and file claims

RESOURCES NEEDED:
‚Ä¢ Roadside assistance and towing services
‚Ä¢ Vehicle repair services
‚Ä¢ Backup vehicles if available
‚Ä¢ Insurance documentation
‚Ä¢ Alternative transportation`,

            'technological.equipment.buildingFault': `IMMEDIATE ACTIONS:
‚Ä¢ Assess nature and severity of building fault
‚Ä¢ Secure affected area to prevent accidents
‚Ä¢ Contact building management and contractors
‚Ä¢ Evacuate area if structural safety compromised
‚Ä¢ Implement workarounds if possible

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about building fault and safety measures
‚Ä¢ Notify building management and property owner
‚Ä¢ Inform customers about potential service impacts
‚Ä¢ Coordinate with contractors and inspectors
‚Ä¢ Provide updates on repair timeline

RECOVERY PROCEDURES:
‚Ä¢ Coordinate repairs with contractors and inspectors
‚Ä¢ Test building systems before resuming operations
‚Ä¢ Review building maintenance schedules
‚Ä¢ Document fault cause and preventive measures
‚Ä¢ Timeline: Hours to days depending on fault severity

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Coordinate repairs and inspections
‚Ä¢ Safety Officer: Ensure building safety
‚Ä¢ Operations Manager: Adjust operations during repairs
‚Ä¢ Building Manager: Coordinate with property owner

RESOURCES NEEDED:
‚Ä¢ Building contractors and inspectors
‚Ä¢ Temporary workspace if needed
‚Ä¢ Building maintenance documentation
‚Ä¢ Safety equipment
‚Ä¢ Inspection services`,

            'technological.transportation.airFailure': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and personnel travel
‚Ä¢ Implement alternative transportation arrangements
‚Ä¢ Contact airlines and travel agencies for rebooking
‚Ä¢ Communicate delays to affected personnel
‚Ä¢ Adjust operations to accommodate delays

COMMUNICATION PLAN:
‚Ä¢ Alert affected personnel about air travel disruptions
‚Ä¢ Notify customers about potential service impacts
‚Ä¢ Coordinate with airlines and travel providers
‚Ä¢ Provide updates on alternative arrangements
‚Ä¢ Communicate adjusted schedules

RECOVERY PROCEDURES:
‚Ä¢ Rebook affected travel arrangements
‚Ä¢ Review and update travel contingency plans
‚Ä¢ Assess need for alternative transportation methods
‚Ä¢ Document lessons learned
‚Ä¢ Timeline: Hours to days depending on disruption duration

ROLES & RESPONSIBILITIES:
‚Ä¢ Travel Coordinator: Rebook and arrange alternatives
‚Ä¢ Operations Manager: Adjust operations and schedules
‚Ä¢ HR Manager: Support affected employees
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Alternative transportation arrangements
‚Ä¢ Travel agency contacts
‚Ä¢ Backup travel plans
‚Ä¢ Communication systems
‚Ä¢ Flexible scheduling`,

            'technological.transportation.railFailure': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and personnel travel
‚Ä¢ Implement alternative transportation arrangements
‚Ä¢ Contact rail service for updates and alternatives
‚Ä¢ Communicate delays to affected personnel
‚Ä¢ Adjust operations to accommodate delays

COMMUNICATION PLAN:
‚Ä¢ Alert affected personnel about rail disruptions
‚Ä¢ Notify customers about potential service impacts
‚Ä¢ Coordinate with rail service providers
‚Ä¢ Provide updates on alternative arrangements
‚Ä¢ Communicate adjusted schedules

RECOVERY PROCEDURES:
‚Ä¢ Arrange alternative transportation for affected personnel
‚Ä¢ Review and update transportation contingency plans
‚Ä¢ Assess need for alternative transportation methods
‚Ä¢ Document lessons learned
‚Ä¢ Timeline: Hours to days depending on disruption duration

ROLES & RESPONSIBILITIES:
‚Ä¢ Transportation Coordinator: Arrange alternatives
‚Ä¢ Operations Manager: Adjust operations and schedules
‚Ä¢ HR Manager: Support affected employees
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Alternative transportation arrangements
‚Ä¢ Rail service contacts
‚Ä¢ Backup transportation plans
‚Ä¢ Communication systems
‚Ä¢ Flexible scheduling`,

            'technological.transportation.roadFailure': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and deliveries
‚Ä¢ Implement alternative routing and transportation
‚Ä¢ Contact transportation providers for alternatives
‚Ä¢ Communicate delays to affected personnel and customers
‚Ä¢ Adjust operations to accommodate delays

COMMUNICATION PLAN:
‚Ä¢ Alert affected personnel about road disruptions
‚Ä¢ Notify customers about potential delivery delays
‚Ä¢ Coordinate with transportation providers
‚Ä¢ Provide updates on alternative arrangements
‚Ä¢ Communicate adjusted schedules

RECOVERY PROCEDURES:
‚Ä¢ Arrange alternative routing and transportation
‚Ä¢ Review and update transportation contingency plans
‚Ä¢ Assess need for alternative transportation methods
‚Ä¢ Document lessons learned
‚Ä¢ Timeline: Hours to days depending on disruption duration

ROLES & RESPONSIBILITIES:
‚Ä¢ Transportation Coordinator: Arrange alternatives
‚Ä¢ Operations Manager: Adjust operations and deliveries
‚Ä¢ Logistics Manager: Coordinate alternative routing
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Alternative transportation and routing
‚Ä¢ Transportation provider contacts
‚Ä¢ Backup logistics plans
‚Ä¢ Communication systems
‚Ä¢ Flexible scheduling`,

            // Biological or Health-Related Hazards
            'biological.disease.pandemic': `IMMEDIATE ACTIONS:
‚Ä¢ Implement remote work protocols for all non-essential staff
‚Ä¢ Enforce social distancing and hygiene protocols in workplace
‚Ä¢ Provide personal protective equipment (PPE) for essential workers
‚Ä¢ Screen employees for symptoms before entry
‚Ä¢ Follow guidance from public health authorities

COMMUNICATION PLAN:
‚Ä¢ Communicate pandemic protocols to all employees
‚Ä¢ Provide regular updates from public health authorities
‚Ä¢ Notify customers about service adjustments
‚Ä¢ Coordinate with public health officials
‚Ä¢ Establish clear communication channels for updates

RECOVERY PROCEDURES:
‚Ä¢ Gradually return to normal operations per public health guidance
‚Ä¢ Maintain enhanced hygiene and safety protocols
‚Ä¢ Continue monitoring for symptoms and cases
‚Ä¢ Review and update pandemic response plans
‚Ä¢ Timeline: Weeks to months depending on pandemic duration

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Implement remote work and safety protocols
‚Ä¢ Safety Officer: Ensure compliance with health guidelines
‚Ä¢ Operations Manager: Maintain operations during pandemic
‚Ä¢ Communications Lead: Keep stakeholders informed

RESOURCES NEEDED:
‚Ä¢ Personal protective equipment (PPE)
‚Ä¢ Remote work infrastructure
‚Ä¢ Health screening equipment
‚Ä¢ Cleaning and sanitization supplies
‚Ä¢ Public health guidance and resources`,

            'biological.disease.epidemic': `IMMEDIATE ACTIONS:
‚Ä¢ Implement enhanced hygiene and safety protocols
‚Ä¢ Screen employees for symptoms before entry
‚Ä¢ Provide personal protective equipment (PPE) as needed
‚Ä¢ Follow guidance from public health authorities
‚Ä¢ Isolate symptomatic employees immediately

COMMUNICATION PLAN:
‚Ä¢ Communicate epidemic protocols to all employees
‚Ä¢ Provide regular updates from public health authorities
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with public health officials
‚Ä¢ Establish clear communication channels

RECOVERY PROCEDURES:
‚Ä¢ Continue enhanced hygiene and safety protocols
‚Ä¢ Monitor for new cases and symptoms
‚Ä¢ Review and update epidemic response plans
‚Ä¢ Gradually return to normal operations per guidance
‚Ä¢ Timeline: Weeks to months depending on epidemic duration

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Implement safety protocols
‚Ä¢ Safety Officer: Ensure compliance with health guidelines
‚Ä¢ Operations Manager: Maintain operations during epidemic
‚Ä¢ Medical Coordinator: Monitor employee health

RESOURCES NEEDED:
‚Ä¢ Personal protective equipment (PPE)
‚Ä¢ Health screening equipment
‚Ä¢ Cleaning and sanitization supplies
‚Ä¢ Public health guidance
‚Ä¢ Medical support services`,

            'biological.disease.viralSpread': `IMMEDIATE ACTIONS:
‚Ä¢ Implement enhanced hygiene and safety protocols
‚Ä¢ Screen employees for symptoms before entry
‚Ä¢ Provide personal protective equipment (PPE) as needed
‚Ä¢ Follow guidance from public health authorities
‚Ä¢ Isolate symptomatic employees immediately

COMMUNICATION PLAN:
‚Ä¢ Communicate viral spread protocols to all employees
‚Ä¢ Provide regular updates from public health authorities
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with public health officials
‚Ä¢ Establish clear communication channels

RECOVERY PROCEDURES:
‚Ä¢ Continue enhanced hygiene and safety protocols
‚Ä¢ Monitor for new cases and symptoms
‚Ä¢ Review and update response plans
‚Ä¢ Gradually return to normal operations per guidance
‚Ä¢ Timeline: Days to weeks depending on spread control

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Implement safety protocols
‚Ä¢ Safety Officer: Ensure compliance with health guidelines
‚Ä¢ Operations Manager: Maintain operations
‚Ä¢ Medical Coordinator: Monitor employee health

RESOURCES NEEDED:
‚Ä¢ Personal protective equipment (PPE)
‚Ä¢ Health screening equipment
‚Ä¢ Cleaning and sanitization supplies
‚Ä¢ Public health guidance
‚Ä¢ Medical support services`,

            'biological.bioterrorism.pathogenRelease': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate affected area immediately
‚Ä¢ Call 911 and report suspected pathogen release
‚Ä¢ Isolate area and prevent access
‚Ä¢ Follow bioterrorism response protocols
‚Ä¢ Notify public health and law enforcement authorities

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about suspected pathogen release
‚Ä¢ Contact emergency services and public health authorities
‚Ä¢ Notify regulatory authorities (CDC, FBI, local health)
‚Ä¢ Follow instructions from public health officials
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for public health clearance before re-entering
‚Ä¢ Coordinate professional decontamination
‚Ä¢ Provide medical monitoring for exposed employees
‚Ä¢ Test air quality and surfaces before resuming operations
‚Ä¢ Timeline: Hours to days for assessment and clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate response and evacuation
‚Ä¢ Medical Coordinator: Provide health monitoring
‚Ä¢ Emergency Coordinator: Oversee response and recovery
‚Ä¢ Public Health Liaison: Coordinate with authorities

RESOURCES NEEDED:
‚Ä¢ Bioterrorism response coordination
‚Ä¢ Professional decontamination services
‚Ä¢ Medical monitoring and support
‚Ä¢ Public health authority contacts
‚Ä¢ Emergency response protocols`,

            'biological.bioterrorism.bioAttack': `IMMEDIATE ACTIONS:
‚Ä¢ Evacuate affected area immediately
‚Ä¢ Call 911 and report suspected biological attack
‚Ä¢ Isolate area and prevent access
‚Ä¢ Follow bioterrorism response protocols
‚Ä¢ Notify public health and law enforcement authorities

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about suspected biological attack
‚Ä¢ Contact emergency services and public health authorities
‚Ä¢ Notify regulatory authorities (CDC, FBI, local health)
‚Ä¢ Follow instructions from public health officials
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Wait for public health clearance before re-entering
‚Ä¢ Coordinate professional decontamination
‚Ä¢ Provide medical monitoring for exposed employees
‚Ä¢ Test air quality and surfaces before resuming operations
‚Ä¢ Timeline: Hours to days for assessment and clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Safety Officer: Coordinate response and evacuation
‚Ä¢ Medical Coordinator: Provide health monitoring
‚Ä¢ Emergency Coordinator: Oversee response and recovery
‚Ä¢ Public Health Liaison: Coordinate with authorities

RESOURCES NEEDED:
‚Ä¢ Bioterrorism response coordination
‚Ä¢ Professional decontamination services
‚Ä¢ Medical monitoring and support
‚Ä¢ Public health authority contacts
‚Ä¢ Emergency response protocols`,

            'biological.contamination.foodBacterial': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate contaminated food immediately
‚Ä¢ Stop serving or distributing affected food
‚Ä¢ Contact public health authorities
‚Ä¢ Document all affected food items and sources
‚Ä¢ Notify anyone who may have consumed contaminated food

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about food contamination
‚Ä¢ Contact public health authorities immediately
‚Ä¢ Notify customers who may have been affected
‚Ä¢ Follow public health guidance on notifications
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with public health investigation
‚Ä¢ Dispose of contaminated food safely
‚Ä¢ Deep clean food preparation areas
‚Ä¢ Review and update food safety protocols
‚Ä¢ Timeline: Hours for containment, days for investigation

ROLES & RESPONSIBILITIES:
‚Ä¢ Food Safety Coordinator: Coordinate response and investigation
‚Ä¢ Operations Manager: Stop affected operations
‚Ä¢ Public Health Liaison: Coordinate with authorities
‚Ä¢ Communications Lead: Manage notifications

RESOURCES NEEDED:
‚Ä¢ Public health coordination
‚Ä¢ Food safety investigation support
‚Ä¢ Professional cleaning services
‚Ä¢ Food safety training
‚Ä¢ Communication systems`,

            'biological.contamination.waterToxin': `IMMEDIATE ACTIONS:
‚Ä¢ Stop using contaminated water source immediately
‚Ä¢ Provide alternative water source for employees
‚Ä¢ Contact public health and water authorities
‚Ä¢ Document contamination and affected systems
‚Ä¢ Notify anyone who may have consumed contaminated water

COMMUNICATION PLAN:
‚Ä¢ Alert all personnel about water contamination
‚Ä¢ Contact public health and water authorities immediately
‚Ä¢ Notify employees and customers about alternative water
‚Ä¢ Follow public health guidance on notifications
‚Ä¢ Provide regular updates on water restoration

RECOVERY PROCEDURES:
‚Ä¢ Coordinate with public health and water authorities
‚Ä¢ Flush and test water systems before resuming use
‚Ä¢ Review and update water safety protocols
‚Ä¢ Provide medical monitoring if needed
‚Ä¢ Timeline: Hours to days for testing and clearance

ROLES & RESPONSIBILITIES:
‚Ä¢ Facilities Manager: Coordinate water system response
‚Ä¢ Safety Officer: Ensure alternative water availability
‚Ä¢ Public Health Liaison: Coordinate with authorities
‚Ä¢ Medical Coordinator: Provide health monitoring if needed

RESOURCES NEEDED:
‚Ä¢ Alternative water sources
‚Ä¢ Water testing services
‚Ä¢ Public health coordination
‚Ä¢ Water safety protocols
‚Ä¢ Medical support if needed`,

            'biological.zoonotic.avianFlu': `IMMEDIATE ACTIONS:
‚Ä¢ Implement enhanced hygiene and safety protocols
‚Ä¢ Screen employees for symptoms
‚Ä¢ Provide personal protective equipment (PPE) as needed
‚Ä¢ Follow guidance from public health authorities
‚Ä¢ Isolate symptomatic employees immediately

COMMUNICATION PLAN:
‚Ä¢ Communicate zoonotic disease protocols to all employees
‚Ä¢ Provide regular updates from public health authorities
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with public health officials
‚Ä¢ Establish clear communication channels

RECOVERY PROCEDURES:
‚Ä¢ Continue enhanced hygiene and safety protocols
‚Ä¢ Monitor for new cases and symptoms
‚Ä¢ Review and update response plans
‚Ä¢ Gradually return to normal operations per guidance
‚Ä¢ Timeline: Days to weeks depending on control measures

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Implement safety protocols
‚Ä¢ Safety Officer: Ensure compliance with health guidelines
‚Ä¢ Operations Manager: Maintain operations
‚Ä¢ Medical Coordinator: Monitor employee health

RESOURCES NEEDED:
‚Ä¢ Personal protective equipment (PPE)
‚Ä¢ Health screening equipment
‚Ä¢ Cleaning and sanitization supplies
‚Ä¢ Public health guidance
‚Ä¢ Medical support services`,

            'biological.zoonotic.animalTransmission': `IMMEDIATE ACTIONS:
‚Ä¢ Implement enhanced hygiene and safety protocols
‚Ä¢ Screen employees for symptoms
‚Ä¢ Provide personal protective equipment (PPE) as needed
‚Ä¢ Follow guidance from public health authorities
‚Ä¢ Isolate symptomatic employees immediately

COMMUNICATION PLAN:
‚Ä¢ Communicate zoonotic disease protocols to all employees
‚Ä¢ Provide regular updates from public health authorities
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with public health officials
‚Ä¢ Establish clear communication channels

RECOVERY PROCEDURES:
‚Ä¢ Continue enhanced hygiene and safety protocols
‚Ä¢ Monitor for new cases and symptoms
‚Ä¢ Review and update response plans
‚Ä¢ Gradually return to normal operations per guidance
‚Ä¢ Timeline: Days to weeks depending on control measures

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Implement safety protocols
‚Ä¢ Safety Officer: Ensure compliance with health guidelines
‚Ä¢ Operations Manager: Maintain operations
‚Ä¢ Medical Coordinator: Monitor employee health

RESOURCES NEEDED:
‚Ä¢ Personal protective equipment (PPE)
‚Ä¢ Health screening equipment
‚Ä¢ Cleaning and sanitization supplies
‚Ä¢ Public health guidance
‚Ä¢ Medical support services`,

            // Cyber or Digital Threats
            'cyber.attack.hacking': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate affected systems from network immediately
‚Ä¢ Preserve logs and evidence for forensic analysis
‚Ä¢ Change all passwords and access credentials
‚Ä¢ Notify IT security team and management
‚Ä¢ Assess scope of breach and compromised data

COMMUNICATION PLAN:
‚Ä¢ Notify IT security team immediately
‚Ä¢ Alert management and legal counsel
‚Ä¢ Coordinate with law enforcement if needed
‚Ä¢ Notify affected parties per regulatory requirements
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Conduct forensic analysis to determine breach scope
‚Ä¢ Restore systems from clean backups
‚Ä¢ Implement enhanced security measures
‚Ä¢ Review and update security protocols
‚Ä¢ Timeline: Hours to days for containment, weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and forensic analysis
‚Ä¢ Systems Administrator: Isolate and restore systems
‚Ä¢ Legal/Compliance: Ensure regulatory notifications
‚Ä¢ Communications Lead: Manage customer notifications

RESOURCES NEEDED:
‚Ä¢ Cybersecurity incident response team
‚Ä¢ Forensic analysis tools
‚Ä¢ Clean system backups
‚Ä¢ Enhanced security software
‚Ä¢ Legal and compliance support`,

            'cyber.attack.phishing': `IMMEDIATE ACTIONS:
‚Ä¢ Identify and isolate affected systems
‚Ä¢ Change all passwords and access credentials
‚Ä¢ Notify IT security team immediately
‚Ä¢ Assess scope of phishing attack and compromised accounts
‚Ä¢ Preserve evidence for analysis

COMMUNICATION PLAN:
‚Ä¢ Alert all employees about phishing attack
‚Ä¢ Provide guidance on identifying phishing attempts
‚Ä¢ Notify affected customers if data compromised
‚Ä¢ Coordinate with IT security and legal
‚Ä¢ Update security awareness training

RECOVERY PROCEDURES:
‚Ä¢ Conduct analysis to determine attack scope
‚Ä¢ Restore affected accounts and systems
‚Ä¢ Implement enhanced email security measures
‚Ä¢ Provide additional security training
‚Ä¢ Timeline: Hours for containment, days for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and analysis
‚Ä¢ Systems Administrator: Restore affected accounts
‚Ä¢ HR Manager: Coordinate security training
‚Ä¢ Communications Lead: Manage notifications

RESOURCES NEEDED:
‚Ä¢ Cybersecurity incident response
‚Ä¢ Email security enhancements
‚Ä¢ Security training materials
‚Ä¢ Account restoration capabilities
‚Ä¢ Legal support if needed`,

            'cyber.attack.malware': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate infected systems from network immediately
‚Ä¢ Preserve logs and evidence for analysis
‚Ä¢ Notify IT security team immediately
‚Ä¢ Assess scope of malware infection
‚Ä¢ Change all passwords and access credentials

COMMUNICATION PLAN:
‚Ä¢ Alert IT security team and management
‚Ä¢ Notify affected personnel about system issues
‚Ä¢ Coordinate with security vendors if needed
‚Ä¢ Provide updates on system restoration
‚Ä¢ Designate spokesperson for media if needed

RECOVERY PROCEDURES:
‚Ä¢ Conduct malware analysis to determine type and scope
‚Ä¢ Remove malware from infected systems
‚Ä¢ Restore systems from clean backups
‚Ä¢ Implement enhanced security measures
‚Ä¢ Timeline: Hours to days for removal, days for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and analysis
‚Ä¢ Systems Administrator: Remove malware and restore systems
‚Ä¢ Network Administrator: Isolate and secure network
‚Ä¢ Operations Manager: Adjust operations during recovery

RESOURCES NEEDED:
‚Ä¢ Malware removal tools
‚Ä¢ Clean system backups
‚Ä¢ Enhanced security software
‚Ä¢ Forensic analysis capabilities
‚Ä¢ System restoration tools`,

            'cyber.breach.unauthorizedAccess': `IMMEDIATE ACTIONS:
‚Ä¢ Revoke unauthorized access immediately
‚Ä¢ Change all passwords and access credentials
‚Ä¢ Preserve logs and evidence for forensic analysis
‚Ä¢ Assess scope of unauthorized access and data exposure
‚Ä¢ Notify IT security team and management

COMMUNICATION PLAN:
‚Ä¢ Notify IT security team immediately
‚Ä¢ Alert management and legal counsel
‚Ä¢ Coordinate with law enforcement if needed
‚Ä¢ Notify affected parties per regulatory requirements
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Conduct forensic analysis to determine access scope
‚Ä¢ Secure all systems and implement enhanced access controls
‚Ä¢ Review and update access control policies
‚Ä¢ Provide additional security training
‚Ä¢ Timeline: Hours for containment, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and analysis
‚Ä¢ Systems Administrator: Revoke access and secure systems
‚Ä¢ Legal/Compliance: Ensure regulatory notifications
‚Ä¢ HR Manager: Coordinate security training

RESOURCES NEEDED:
‚Ä¢ Cybersecurity incident response team
‚Ä¢ Forensic analysis tools
‚Ä¢ Enhanced access control systems
‚Ä¢ Security training materials
‚Ä¢ Legal and compliance support`,

            'cyber.breach.dataTheft': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate affected systems immediately
‚Ä¢ Preserve logs and evidence for forensic analysis
‚Ä¢ Assess scope of data theft and compromised information
‚Ä¢ Notify IT security team and management
‚Ä¢ Contact law enforcement if criminal activity suspected

COMMUNICATION PLAN:
‚Ä¢ Notify IT security team and management immediately
‚Ä¢ Alert legal counsel and compliance team
‚Ä¢ Notify affected parties per regulatory requirements
‚Ä¢ Coordinate with law enforcement if needed
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Conduct forensic analysis to determine theft scope
‚Ä¢ Secure all systems and implement enhanced security
‚Ä¢ Review and update data protection policies
‚Ä¢ Provide credit monitoring for affected individuals if needed
‚Ä¢ Timeline: Hours for containment, weeks for full recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and forensic analysis
‚Ä¢ Legal/Compliance: Ensure regulatory notifications
‚Ä¢ Data Protection Officer: Coordinate data breach response
‚Ä¢ Communications Lead: Manage customer notifications

RESOURCES NEEDED:
‚Ä¢ Cybersecurity incident response team
‚Ä¢ Forensic analysis tools
‚Ä¢ Enhanced security systems
‚Ä¢ Credit monitoring services if needed
‚Ä¢ Legal and compliance support`,

            'cyber.dos.systemOverload': `IMMEDIATE ACTIONS:
‚Ä¢ Identify source of system overload
‚Ä¢ Block malicious traffic at firewall
‚Ä¢ Scale up system resources if possible
‚Ä¢ Notify IT security team immediately
‚Ä¢ Preserve logs for analysis

COMMUNICATION PLAN:
‚Ä¢ Alert IT security team and management
‚Ä¢ Notify customers about service disruptions
‚Ä¢ Provide updates on system restoration
‚Ä¢ Coordinate with hosting/cloud providers if needed
‚Ä¢ Communicate expected restoration timeline

RECOVERY PROCEDURES:
‚Ä¢ Analyze attack patterns and sources
‚Ä¢ Implement DDoS protection measures
‚Ä¢ Restore normal system operations
‚Ä¢ Review and update DDoS response protocols
‚Ä¢ Timeline: Hours for mitigation, immediate for service restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and mitigation
‚Ä¢ Network Administrator: Block malicious traffic
‚Ä¢ Systems Administrator: Scale resources and restore service
‚Ä¢ Operations Manager: Adjust operations during attack

RESOURCES NEEDED:
‚Ä¢ DDoS protection services
‚Ä¢ Scalable infrastructure
‚Ä¢ Network monitoring tools
‚Ä¢ Traffic analysis capabilities
‚Ä¢ Cloud/hosting provider support`,

            'cyber.dos.trafficFlood': `IMMEDIATE ACTIONS:
‚Ä¢ Identify source of traffic flood
‚Ä¢ Block malicious traffic at firewall
‚Ä¢ Scale up system resources if possible
‚Ä¢ Notify IT security team immediately
‚Ä¢ Preserve logs for analysis

COMMUNICATION PLAN:
‚Ä¢ Alert IT security team and management
‚Ä¢ Notify customers about service disruptions
‚Ä¢ Provide updates on system restoration
‚Ä¢ Coordinate with hosting/cloud providers if needed
‚Ä¢ Communicate expected restoration timeline

RECOVERY PROCEDURES:
‚Ä¢ Analyze attack patterns and sources
‚Ä¢ Implement DDoS protection measures
‚Ä¢ Restore normal system operations
‚Ä¢ Review and update DDoS response protocols
‚Ä¢ Timeline: Hours for mitigation, immediate for service restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and mitigation
‚Ä¢ Network Administrator: Block malicious traffic
‚Ä¢ Systems Administrator: Scale resources and restore service
‚Ä¢ Operations Manager: Adjust operations during attack

RESOURCES NEEDED:
‚Ä¢ DDoS protection services
‚Ä¢ Scalable infrastructure
‚Ä¢ Network monitoring tools
‚Ä¢ Traffic analysis capabilities
‚Ä¢ Cloud/hosting provider support`,

            'cyber.ransomware.dataEncryption': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate infected systems from network immediately
‚Ä¢ Do not pay ransom without consulting law enforcement
‚Ä¢ Preserve logs and evidence for forensic analysis
‚Ä¢ Notify IT security team and management
‚Ä¢ Assess scope of encryption and affected systems

COMMUNICATION PLAN:
‚Ä¢ Notify IT security team and management immediately
‚Ä¢ Alert legal counsel and law enforcement
‚Ä¢ Notify affected personnel about system issues
‚Ä¢ Coordinate with cybersecurity experts
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Attempt to restore from clean backups
‚Ä¢ Conduct forensic analysis to determine attack vector
‚Ä¢ Implement enhanced security measures
‚Ä¢ Review and update backup and security protocols
‚Ä¢ Timeline: Hours for containment, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and recovery
‚Ä¢ Systems Administrator: Restore from backups
‚Ä¢ Legal Counsel: Coordinate with law enforcement
‚Ä¢ Operations Manager: Maintain operations during recovery

RESOURCES NEEDED:
‚Ä¢ Clean system backups
‚Ä¢ Ransomware removal tools
‚Ä¢ Forensic analysis capabilities
‚Ä¢ Enhanced security software
‚Ä¢ Legal and law enforcement coordination`,

            'cyber.ransomware.systemLock': `IMMEDIATE ACTIONS:
‚Ä¢ Isolate infected systems from network immediately
‚Ä¢ Do not pay ransom without consulting law enforcement
‚Ä¢ Preserve logs and evidence for forensic analysis
‚Ä¢ Notify IT security team and management
‚Ä¢ Assess scope of system lock and affected operations

COMMUNICATION PLAN:
‚Ä¢ Notify IT security team and management immediately
‚Ä¢ Alert legal counsel and law enforcement
‚Ä¢ Notify affected personnel about system issues
‚Ä¢ Coordinate with cybersecurity experts
‚Ä¢ Designate official spokesperson for media inquiries

RECOVERY PROCEDURES:
‚Ä¢ Attempt to restore from clean backups
‚Ä¢ Conduct forensic analysis to determine attack vector
‚Ä¢ Implement enhanced security measures
‚Ä¢ Review and update backup and security protocols
‚Ä¢ Timeline: Hours for containment, days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ IT Security Manager: Lead response and recovery
‚Ä¢ Systems Administrator: Restore from backups
‚Ä¢ Legal Counsel: Coordinate with law enforcement
‚Ä¢ Operations Manager: Maintain operations during recovery

RESOURCES NEEDED:
‚Ä¢ Clean system backups
‚Ä¢ Ransomware removal tools
‚Ä¢ Forensic analysis capabilities
‚Ä¢ Enhanced security software
‚Ä¢ Legal and law enforcement coordination`,

            // Economic or Financial Crises
            'economic.market.stockCrash': `IMMEDIATE ACTIONS:
‚Ä¢ Assess financial impact on organization
‚Ä¢ Review investment portfolio and cash reserves
‚Ä¢ Implement cost reduction measures if needed
‚Ä¢ Communicate with financial advisors and board
‚Ä¢ Maintain focus on core business operations

COMMUNICATION PLAN:
‚Ä¢ Communicate financial situation to board and key stakeholders
‚Ä¢ Provide regular updates on market conditions and impact
‚Ä¢ Notify employees about any necessary adjustments
‚Ä¢ Coordinate with financial advisors and accountants
‚Ä¢ Maintain transparency while protecting sensitive information

RECOVERY PROCEDURES:
‚Ä¢ Review and adjust financial strategies
‚Ä¢ Diversify investments and reduce risk exposure
‚Ä¢ Implement cost management measures
‚Ä¢ Strengthen cash reserves and liquidity
‚Ä¢ Timeline: Weeks to months for market recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ CFO: Lead financial assessment and response
‚Ä¢ Financial Advisor: Provide market analysis and guidance
‚Ä¢ Board of Directors: Review and approve financial strategies
‚Ä¢ Operations Manager: Adjust operations to maintain stability

RESOURCES NEEDED:
‚Ä¢ Financial advisory services
‚Ä¢ Market analysis and reporting
‚Ä¢ Cash reserve management
‚Ä¢ Cost reduction strategies
‚Ä¢ Financial planning support`,

            'economic.market.recession': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on revenue and operations
‚Ä¢ Review and adjust budgets and forecasts
‚Ä¢ Implement cost reduction measures
‚Ä¢ Strengthen cash reserves and liquidity
‚Ä¢ Maintain focus on core business operations

COMMUNICATION PLAN:
‚Ä¢ Communicate economic situation to board and key stakeholders
‚Ä¢ Provide regular updates on market conditions and impact
‚Ä¢ Notify employees about necessary adjustments
‚Ä¢ Coordinate with financial advisors
‚Ä¢ Maintain transparency while protecting sensitive information

RECOVERY PROCEDURES:
‚Ä¢ Review and adjust business strategies
‚Ä¢ Implement cost management and efficiency measures
‚Ä¢ Strengthen customer relationships and retention
‚Ä¢ Diversify revenue streams if possible
‚Ä¢ Timeline: Months to years for economic recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ CFO: Lead financial assessment and response
‚Ä¢ CEO: Guide strategic direction during recession
‚Ä¢ Operations Manager: Adjust operations to maintain efficiency
‚Ä¢ Sales Manager: Strengthen customer relationships

RESOURCES NEEDED:
‚Ä¢ Financial advisory services
‚Ä¢ Cost reduction strategies
‚Ä¢ Cash reserve management
‚Ä¢ Business strategy consulting
‚Ä¢ Market analysis and reporting`,

            'economic.market.inflation': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact of inflation on costs and pricing
‚Ä¢ Review and adjust pricing strategies
‚Ä¢ Implement cost management measures
‚Ä¢ Review supplier contracts and negotiate if needed
‚Ä¢ Adjust budgets and forecasts for inflation

COMMUNICATION PLAN:
‚Ä¢ Communicate inflation impact to board and key stakeholders
‚Ä¢ Provide regular updates on cost adjustments
‚Ä¢ Notify customers about necessary price adjustments
‚Ä¢ Coordinate with suppliers on cost management
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Review and adjust pricing strategies
‚Ä¢ Implement cost efficiency measures
‚Ä¢ Renegotiate supplier contracts
‚Ä¢ Strengthen cash flow management
‚Ä¢ Timeline: Ongoing during inflation period

ROLES & RESPONSIBILITIES:
‚Ä¢ CFO: Lead financial assessment and pricing strategies
‚Ä¢ Operations Manager: Implement cost efficiency measures
‚Ä¢ Procurement Manager: Renegotiate supplier contracts
‚Ä¢ Sales Manager: Communicate price adjustments to customers

RESOURCES NEEDED:
‚Ä¢ Financial analysis and reporting
‚Ä¢ Cost management strategies
‚Ä¢ Supplier negotiation support
‚Ä¢ Pricing strategy consulting
‚Ä¢ Cash flow management`,

            'economic.supply.materialSourcing': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and production
‚Ä¢ Identify alternative suppliers immediately
‚Ä¢ Communicate with current suppliers about disruptions
‚Ä¢ Implement inventory management strategies
‚Ä¢ Adjust production schedules if needed

COMMUNICATION PLAN:
‚Ä¢ Alert operations team about sourcing disruptions
‚Ä¢ Notify customers about potential delays
‚Ä¢ Coordinate with suppliers on alternative arrangements
‚Ä¢ Provide updates on sourcing resolution
‚Ä¢ Communicate adjusted timelines

RECOVERY PROCEDURES:
‚Ä¢ Establish relationships with alternative suppliers
‚Ä¢ Diversify supplier base to reduce risk
‚Ä¢ Review and update supplier contracts
‚Ä¢ Implement inventory buffer strategies
‚Ä¢ Timeline: Days to weeks for alternative sourcing

ROLES & RESPONSIBILITIES:
‚Ä¢ Procurement Manager: Identify and establish alternative suppliers
‚Ä¢ Operations Manager: Adjust operations during disruption
‚Ä¢ Supply Chain Manager: Coordinate sourcing alternatives
‚Ä¢ Quality Manager: Ensure alternative suppliers meet standards

RESOURCES NEEDED:
‚Ä¢ Alternative supplier contacts
‚Ä¢ Supplier evaluation capabilities
‚Ä¢ Inventory management systems
‚Ä¢ Supply chain consulting
‚Ä¢ Quality assurance resources`,

            'economic.supply.inventoryShortage': `IMMEDIATE ACTIONS:
‚Ä¢ Assess current inventory levels and critical needs
‚Ä¢ Prioritize inventory allocation to critical operations
‚Ä¢ Identify alternative sources for critical materials
‚Ä¢ Communicate with suppliers about availability
‚Ä¢ Adjust operations to work with available inventory

COMMUNICATION PLAN:
‚Ä¢ Alert operations team about inventory shortages
‚Ä¢ Notify customers about potential delays or limitations
‚Ä¢ Coordinate with suppliers on availability and delivery
‚Ä¢ Provide updates on inventory restoration
‚Ä¢ Communicate adjusted service levels

RECOVERY PROCEDURES:
‚Ä¢ Restore inventory levels from alternative sources
‚Ä¢ Review and update inventory management strategies
‚Ä¢ Establish inventory buffer for critical materials
‚Ä¢ Diversify supplier base to reduce risk
‚Ä¢ Timeline: Days to weeks for inventory restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ Inventory Manager: Manage inventory levels and allocation
‚Ä¢ Procurement Manager: Source alternative suppliers
‚Ä¢ Operations Manager: Adjust operations during shortage
‚Ä¢ Supply Chain Manager: Coordinate inventory restoration

RESOURCES NEEDED:
‚Ä¢ Alternative supplier contacts
‚Ä¢ Inventory management systems
‚Ä¢ Supply chain coordination
‚Ä¢ Inventory buffer strategies
‚Ä¢ Supplier evaluation capabilities`,

            'economic.funding.grantLoss': `IMMEDIATE ACTIONS:
‚Ä¢ Assess financial impact of grant loss
‚Ä¢ Review and adjust budgets immediately
‚Ä¢ Identify alternative funding sources
‚Ä¢ Communicate with board and key stakeholders
‚Ä¢ Implement cost reduction measures if needed

COMMUNICATION PLAN:
‚Ä¢ Communicate grant loss to board and key stakeholders
‚Ä¢ Provide regular updates on financial situation
‚Ä¢ Notify employees about necessary adjustments
‚Ä¢ Coordinate with funders and donors
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Apply for alternative grants and funding
‚Ä¢ Strengthen fundraising and donor relationships
‚Ä¢ Implement cost reduction and efficiency measures
‚Ä¢ Diversify funding sources
‚Ä¢ Timeline: Weeks to months for funding restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ Development Director: Lead fundraising and grant applications
‚Ä¢ CFO: Manage financial adjustments and budgets
‚Ä¢ Executive Director: Guide strategic direction
‚Ä¢ Board of Directors: Support fundraising efforts

RESOURCES NEEDED:
‚Ä¢ Grant writing support
‚Ä¢ Fundraising resources
‚Ä¢ Financial planning support
‚Ä¢ Donor relationship management
‚Ä¢ Alternative funding sources`,

            'economic.funding.revenueLoss': `IMMEDIATE ACTIONS:
‚Ä¢ Assess financial impact of revenue loss
‚Ä¢ Review and adjust budgets immediately
‚Ä¢ Identify alternative revenue sources
‚Ä¢ Implement cost reduction measures
‚Ä¢ Communicate with board and key stakeholders

COMMUNICATION PLAN:
‚Ä¢ Communicate revenue loss to board and key stakeholders
‚Ä¢ Provide regular updates on financial situation
‚Ä¢ Notify employees about necessary adjustments
‚Ä¢ Coordinate with financial advisors
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Strengthen sales and marketing efforts
‚Ä¢ Identify and develop alternative revenue streams
‚Ä¢ Implement cost reduction and efficiency measures
‚Ä¢ Review and adjust business strategies
‚Ä¢ Timeline: Weeks to months for revenue restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ CFO: Lead financial assessment and adjustments
‚Ä¢ Sales Manager: Strengthen revenue generation
‚Ä¢ Operations Manager: Implement cost reduction measures
‚Ä¢ Executive Director: Guide strategic direction

RESOURCES NEEDED:
‚Ä¢ Financial planning support
‚Ä¢ Sales and marketing resources
‚Ä¢ Cost reduction strategies
‚Ä¢ Business strategy consulting
‚Ä¢ Alternative revenue development`,

            'economic.trade.currencyDevaluation': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on international operations and costs
‚Ä¢ Review currency exposure and hedging strategies
‚Ä¢ Adjust pricing for international markets if needed
‚Ä¢ Communicate with international partners
‚Ä¢ Implement cost management measures

COMMUNICATION PLAN:
‚Ä¢ Communicate currency impact to board and key stakeholders
‚Ä¢ Provide regular updates on currency conditions
‚Ä¢ Notify international partners about adjustments
‚Ä¢ Coordinate with financial advisors
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Review and adjust currency hedging strategies
‚Ä¢ Adjust pricing for international markets
‚Ä¢ Strengthen relationships with international partners
‚Ä¢ Diversify currency exposure if possible
‚Ä¢ Timeline: Weeks to months for currency stabilization

ROLES & RESPONSIBILITIES:
‚Ä¢ CFO: Lead financial assessment and hedging strategies
‚Ä¢ International Operations Manager: Adjust international operations
‚Ä¢ Financial Advisor: Provide currency analysis and guidance
‚Ä¢ Sales Manager: Adjust international pricing

RESOURCES NEEDED:
‚Ä¢ Currency hedging services
‚Ä¢ International financial analysis
‚Ä¢ Currency risk management
‚Ä¢ International partner coordination
‚Ä¢ Financial advisory services`,

            'economic.trade.tariffs': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact of tariffs on costs and operations
‚Ä¢ Review supply chain and sourcing strategies
‚Ä¢ Adjust pricing strategies if needed
‚Ä¢ Communicate with suppliers and customers
‚Ä¢ Implement cost management measures

COMMUNICATION PLAN:
‚Ä¢ Communicate tariff impact to board and key stakeholders
‚Ä¢ Provide regular updates on trade conditions
‚Ä¢ Notify customers about necessary price adjustments
‚Ä¢ Coordinate with suppliers on cost management
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Review and adjust supply chain strategies
‚Ä¢ Identify alternative suppliers if needed
‚Ä¢ Adjust pricing strategies
‚Ä¢ Strengthen relationships with suppliers
‚Ä¢ Timeline: Weeks to months for trade adjustment

ROLES & RESPONSIBILITIES:
‚Ä¢ Procurement Manager: Adjust sourcing strategies
‚Ä¢ CFO: Lead financial assessment and pricing
‚Ä¢ Operations Manager: Adjust operations during trade changes
‚Ä¢ Supply Chain Manager: Coordinate supply chain adjustments

RESOURCES NEEDED:
‚Ä¢ Trade analysis and reporting
‚Ä¢ Alternative supplier evaluation
‚Ä¢ Supply chain consulting
‚Ä¢ Cost management strategies
‚Ä¢ Trade compliance support`,

            'economic.trade.tradeWar': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on international operations and supply chain
‚Ä¢ Review and adjust international strategies
‚Ä¢ Identify alternative markets and suppliers
‚Ä¢ Communicate with international partners
‚Ä¢ Implement contingency plans for trade disruptions

COMMUNICATION PLAN:
‚Ä¢ Communicate trade war impact to board and key stakeholders
‚Ä¢ Provide regular updates on trade conditions
‚Ä¢ Notify international partners about adjustments
‚Ä¢ Coordinate with trade advisors
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Diversify international markets and suppliers
‚Ä¢ Adjust international strategies and operations
‚Ä¢ Strengthen relationships with key international partners
‚Ä¢ Review and update trade compliance procedures
‚Ä¢ Timeline: Months to years for trade resolution

ROLES & RESPONSIBILITIES:
‚Ä¢ International Operations Manager: Adjust international strategies
‚Ä¢ CFO: Lead financial assessment and planning
‚Ä¢ Trade Compliance Manager: Ensure compliance with trade regulations
‚Ä¢ Executive Director: Guide strategic direction

RESOURCES NEEDED:
‚Ä¢ Trade analysis and consulting
‚Ä¢ International market research
‚Ä¢ Alternative supplier evaluation
‚Ä¢ Trade compliance support
‚Ä¢ International partner coordination`,

            // Operational or Internal Risks
            'operational.hr.staffShortage': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and critical functions
‚Ä¢ Implement cross-training and job sharing
‚Ä¢ Activate temporary staffing or contractors
‚Ä¢ Prioritize critical operations and functions
‚Ä¢ Communicate with remaining staff about adjustments

COMMUNICATION PLAN:
‚Ä¢ Communicate staffing situation to all employees
‚Ä¢ Provide regular updates on staffing efforts
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with HR and recruitment
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Accelerate recruitment and hiring efforts
‚Ä¢ Implement retention strategies for existing staff
‚Ä¢ Review and improve compensation and benefits
‚Ä¢ Strengthen employee engagement and morale
‚Ä¢ Timeline: Weeks to months for staffing restoration

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Lead recruitment and retention efforts
‚Ä¢ Operations Manager: Adjust operations during shortage
‚Ä¢ Department Managers: Cross-train and support staff
‚Ä¢ Executive Director: Support recruitment and retention

RESOURCES NEEDED:
‚Ä¢ Recruitment services
‚Ä¢ Temporary staffing agencies
‚Ä¢ Employee retention strategies
‚Ä¢ Training and development resources
‚Ä¢ Compensation and benefits review`,

            'operational.hr.successionGap': `IMMEDIATE ACTIONS:
‚Ä¢ Assess critical positions and succession needs
‚Ä¢ Identify interim leadership solutions
‚Ä¢ Implement knowledge transfer and documentation
‚Ä¢ Develop temporary leadership structures
‚Ä¢ Communicate with board and key stakeholders

COMMUNICATION PLAN:
‚Ä¢ Communicate succession situation to board and key stakeholders
‚Ä¢ Provide regular updates on succession planning
‚Ä¢ Notify employees about leadership changes
‚Ä¢ Coordinate with HR and executive search
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Accelerate executive search and recruitment
‚Ä¢ Implement leadership development programs
‚Ä¢ Strengthen knowledge transfer and documentation
‚Ä¢ Review and update succession planning processes
‚Ä¢ Timeline: Months for executive search and transition

ROLES & RESPONSIBILITIES:
‚Ä¢ Board of Directors: Oversee executive search
‚Ä¢ HR Manager: Coordinate recruitment and transition
‚Ä¢ Interim Leadership: Maintain operations during transition
‚Ä¢ Executive Search Firm: Conduct search and recruitment

RESOURCES NEEDED:
‚Ä¢ Executive search services
‚Ä¢ Leadership development programs
‚Ä¢ Knowledge transfer support
‚Ä¢ Interim leadership solutions
‚Ä¢ Succession planning consulting`,

            'operational.hr.keyPersonnelLoss': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact of key personnel loss on operations
‚Ä¢ Implement knowledge transfer and documentation
‚Ä¢ Identify interim replacements or coverage
‚Ä¢ Communicate with team and stakeholders
‚Ä¢ Prioritize critical functions and operations

COMMUNICATION PLAN:
‚Ä¢ Communicate key personnel loss to team and stakeholders
‚Ä¢ Provide regular updates on coverage and replacement
‚Ä¢ Notify customers about potential service adjustments
‚Ä¢ Coordinate with HR and recruitment
‚Ä¢ Maintain transparency in communications

RECOVERY PROCEDURES:
‚Ä¢ Accelerate recruitment for key position
‚Ä¢ Implement knowledge transfer and documentation
‚Ä¢ Strengthen team capabilities and cross-training
‚Ä¢ Review and update key personnel identification
‚Ä¢ Timeline: Weeks to months for replacement

ROLES & RESPONSIBILITIES:
‚Ä¢ HR Manager: Lead recruitment and transition
‚Ä¢ Department Manager: Coordinate coverage and knowledge transfer
‚Ä¢ Operations Manager: Adjust operations during transition
‚Ä¢ Executive Director: Support recruitment and transition

RESOURCES NEEDED:
‚Ä¢ Recruitment services
‚Ä¢ Knowledge transfer support
‚Ä¢ Interim coverage solutions
‚Ä¢ Team development resources
‚Ä¢ Key personnel identification processes`,

            'operational.process.workflowBreakdown': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and service delivery
‚Ä¢ Implement temporary workarounds
‚Ä¢ Identify root cause of workflow breakdown
‚Ä¢ Communicate with affected teams and customers
‚Ä¢ Prioritize critical processes and functions

COMMUNICATION PLAN:
‚Ä¢ Alert affected teams about workflow breakdown
‚Ä¢ Notify customers about potential service impacts
‚Ä¢ Provide updates on resolution efforts
‚Ä¢ Coordinate with process owners and teams
‚Ä¢ Communicate expected resolution timeline

RECOVERY PROCEDURES:
‚Ä¢ Fix root cause of workflow breakdown
‚Ä¢ Restore normal workflow processes
‚Ä¢ Review and improve workflow processes
‚Ä¢ Implement monitoring and prevention measures
‚Ä¢ Timeline: Hours to days for resolution

ROLES & RESPONSIBILITIES:
‚Ä¢ Process Owner: Lead resolution and improvement
‚Ä¢ Operations Manager: Coordinate workarounds and recovery
‚Ä¢ Quality Manager: Ensure process quality
‚Ä¢ IT Manager: Support process systems if needed

RESOURCES NEEDED:
‚Ä¢ Process analysis and improvement
‚Ä¢ Temporary workaround solutions
‚Ä¢ Process monitoring tools
‚Ä¢ Quality assurance resources
‚Ä¢ System support if needed`,

            'operational.process.complianceViolation': `IMMEDIATE ACTIONS:
‚Ä¢ Assess scope and severity of compliance violation
‚Ä¢ Stop non-compliant activities immediately
‚Ä¢ Notify legal counsel and compliance officer
‚Ä¢ Document violation and corrective actions
‚Ä¢ Communicate with regulatory authorities if required

COMMUNICATION PLAN:
‚Ä¢ Notify legal counsel and compliance officer immediately
‚Ä¢ Alert management and board about violation
‚Ä¢ Coordinate with regulatory authorities if required
‚Ä¢ Provide updates on corrective actions
‚Ä¢ Maintain confidentiality as appropriate

RECOVERY PROCEDURES:
‚Ä¢ Implement corrective actions immediately
‚Ä¢ Review and update compliance procedures
‚Ä¢ Provide additional compliance training
‚Ä¢ Strengthen compliance monitoring and controls
‚Ä¢ Timeline: Immediate for corrective actions, weeks for full compliance

ROLES & RESPONSIBILITIES:
‚Ä¢ Compliance Officer: Lead compliance response
‚Ä¢ Legal Counsel: Provide legal guidance
‚Ä¢ Operations Manager: Implement corrective actions
‚Ä¢ Training Manager: Provide compliance training

RESOURCES NEEDED:
‚Ä¢ Legal counsel
‚Ä¢ Compliance consulting
‚Ä¢ Compliance training resources
‚Ä¢ Compliance monitoring tools
‚Ä¢ Regulatory coordination`,

            'operational.vendor.externalPartnerFailure': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact on operations and service delivery
‚Ä¢ Identify alternative vendors or solutions
‚Ä¢ Communicate with affected customers
‚Ä¢ Implement workarounds if possible
‚Ä¢ Review vendor contracts and obligations

COMMUNICATION PLAN:
‚Ä¢ Alert operations team about vendor failure
‚Ä¢ Notify customers about potential service impacts
‚Ä¢ Coordinate with alternative vendors
‚Ä¢ Provide updates on resolution efforts
‚Ä¢ Communicate expected resolution timeline

RECOVERY PROCEDURES:
‚Ä¢ Establish relationships with alternative vendors
‚Ä¢ Transition services to alternative vendors
‚Ä¢ Review and update vendor management processes
‚Ä¢ Strengthen vendor relationships and contracts
‚Ä¢ Timeline: Days to weeks for vendor transition

ROLES & RESPONSIBILITIES:
‚Ä¢ Procurement Manager: Identify and establish alternative vendors
‚Ä¢ Operations Manager: Coordinate transition and workarounds
‚Ä¢ Vendor Manager: Manage vendor relationships
‚Ä¢ Quality Manager: Ensure alternative vendors meet standards

RESOURCES NEEDED:
‚Ä¢ Alternative vendor contacts
‚Ä¢ Vendor evaluation capabilities
‚Ä¢ Contract management support
‚Ä¢ Transition planning resources
‚Ä¢ Quality assurance resources`,

            'operational.vendor.contractBreach': `IMMEDIATE ACTIONS:
‚Ä¢ Assess scope and impact of contract breach
‚Ä¢ Review contract terms and obligations
‚Ä¢ Notify legal counsel immediately
‚Ä¢ Document breach and impact
‚Ä¢ Identify alternative solutions if needed

COMMUNICATION PLAN:
‚Ä¢ Notify legal counsel immediately
‚Ä¢ Alert management about contract breach
‚Ä¢ Coordinate with vendor on resolution
‚Ä¢ Provide updates on resolution efforts
‚Ä¢ Maintain confidentiality as appropriate

RECOVERY PROCEDURES:
‚Ä¢ Negotiate resolution with vendor
‚Ä¢ Review and update vendor contracts
‚Ä¢ Strengthen contract management processes
‚Ä¢ Identify alternative vendors if needed
‚Ä¢ Timeline: Days to weeks for resolution

ROLES & RESPONSIBILITIES:
‚Ä¢ Legal Counsel: Lead contract resolution
‚Ä¢ Vendor Manager: Coordinate with vendor
‚Ä¢ Procurement Manager: Identify alternatives if needed
‚Ä¢ Operations Manager: Adjust operations during resolution

RESOURCES NEEDED:
‚Ä¢ Legal counsel
‚Ä¢ Contract management support
‚Ä¢ Vendor negotiation support
‚Ä¢ Alternative vendor evaluation
‚Ä¢ Contract review resources`,

            'operational.project.scopeCreep': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact of scope creep on project timeline and budget
‚Ä¢ Review project scope and requirements
‚Ä¢ Communicate with project stakeholders
‚Ä¢ Implement scope control measures
‚Ä¢ Adjust project plan and resources if needed

COMMUNICATION PLAN:
‚Ä¢ Alert project team about scope creep
‚Ä¢ Notify project stakeholders about impacts
‚Ä¢ Coordinate with project sponsor on scope decisions
‚Ä¢ Provide updates on scope management
‚Ä¢ Communicate adjusted project timeline and budget

RECOVERY PROCEDURES:
‚Ä¢ Implement scope control and change management
‚Ä¢ Adjust project plan and resources
‚Ä¢ Review and update project management processes
‚Ä¢ Strengthen stakeholder communication
‚Ä¢ Timeline: Days to weeks for scope stabilization

ROLES & RESPONSIBILITIES:
‚Ä¢ Project Manager: Lead scope management and control
‚Ä¢ Project Sponsor: Make scope decisions
‚Ä¢ Team Leads: Adjust team work and resources
‚Ä¢ Stakeholders: Provide input on scope decisions

RESOURCES NEEDED:
‚Ä¢ Project management tools
‚Ä¢ Scope control processes
‚Ä¢ Change management support
‚Ä¢ Resource adjustment capabilities
‚Ä¢ Stakeholder communication tools`,

            'operational.project.delay': `IMMEDIATE ACTIONS:
‚Ä¢ Assess impact of project delay on timeline and deliverables
‚Ä¢ Identify root cause of delay
‚Ä¢ Review project plan and resources
‚Ä¢ Communicate with project stakeholders
‚Ä¢ Implement recovery measures

COMMUNICATION PLAN:
‚Ä¢ Alert project team about delay
‚Ä¢ Notify project stakeholders about impacts
‚Ä¢ Coordinate with project sponsor on recovery plan
‚Ä¢ Provide updates on recovery efforts
‚Ä¢ Communicate adjusted project timeline

RECOVERY PROCEDURES:
‚Ä¢ Implement recovery plan and measures
‚Ä¢ Adjust project resources and timeline
‚Ä¢ Review and improve project management processes
‚Ä¢ Strengthen project monitoring and control
‚Ä¢ Timeline: Days to weeks for recovery

ROLES & RESPONSIBILITIES:
‚Ä¢ Project Manager: Lead recovery and project management
‚Ä¢ Project Sponsor: Support recovery efforts
‚Ä¢ Team Leads: Adjust team work and resources
‚Ä¢ Stakeholders: Provide input on recovery plan

RESOURCES NEEDED:
‚Ä¢ Project management tools
‚Ä¢ Recovery planning support
‚Ä¢ Resource adjustment capabilities
‚Ä¢ Project monitoring tools
‚Ä¢ Stakeholder communication tools`
        };

        // Predefined category library - all available categories with full structure
        const categoryLibrary = {
            natural: {
                title: 'Natural Hazards',
                subcategories: [
                    {
                        subcategory: 'Geological',
                        events: [
                            { id: 'naturalHazards.geological.landslide', name: 'Landslide' },
                            { id: 'naturalHazards.geological.earthquake', name: 'Earthquake' },
                            { id: 'naturalHazards.geological.volcano', name: 'Volcano' },
                            { id: 'naturalHazards.geological.tsunami', name: 'Tsunami' }
                        ]
                    },
                    {
                        subcategory: 'Meteorological',
                        events: [
                            { id: 'naturalHazards.meteorological.dustStorm', name: 'Dust storm' },
                            { id: 'naturalHazards.meteorological.extremeTemperatures', name: 'Extreme Temperatures' },
                            { id: 'naturalHazards.meteorological.snow', name: 'Snow' },
                            { id: 'naturalHazards.meteorological.flood', name: 'Flood' },
                            { id: 'naturalHazards.meteorological.lightning', name: 'Lightning' }
                        ]
                    },
                    {
                        subcategory: 'Weather-Related Events',
                        events: [
                            { id: 'naturalHazards.weather.hurricane', name: 'Hurricane' },
                            { id: 'naturalHazards.weather.tornado', name: 'Tornado' },
                            { id: 'naturalHazards.weather.blizzard', name: 'Blizzard' },
                            { id: 'naturalHazards.weather.heatWave', name: 'Extreme Heat Wave' }
                        ]
                    },
                    {
                        subcategory: 'Hydrological Events',
                        events: [
                            { id: 'naturalHazards.hydrological.flood', name: 'Flood' },
                            { id: 'naturalHazards.hydrological.drought', name: 'Drought' },
                            { id: 'naturalHazards.hydrological.stormSurge', name: 'Storm Surge' }
                        ]
                    },
                    {
                        subcategory: 'Wildfires',
                        events: [
                            { id: 'naturalHazards.wildfire.forestFire', name: 'Forest Fire' },
                            { id: 'naturalHazards.wildfire.brushFire', name: 'Brush Fire' }
                        ]
                    }
                ]
            },
            human: {
                title: 'Human Caused Events',
                subcategories: [
                    {
                        subcategory: 'Accidental',
                        events: [
                            { id: 'humanCaused.accidental.fire', name: 'Fire' },
                            { id: 'humanCaused.accidental.buildingCollapse', name: 'Building Collapse' },
                            { id: 'humanCaused.accidental.hazardousMaterialSpill', name: 'Hazardous Material Spill' }
                        ]
                    },
                    {
                        subcategory: 'Intentional',
                        events: [
                            { id: 'humanCaused.intentional.workplaceViolence', name: 'Workplace Violence' },
                            { id: 'humanCaused.intentional.protests', name: 'Protests' }
                        ]
                    },
                    {
                        subcategory: 'Violence and Conflict',
                        events: [
                            { id: 'humanCaused.violence.activeShooter', name: 'Active Shooter' },
                            { id: 'humanCaused.violence.workplaceViolence', name: 'Workplace Violence' },
                            { id: 'humanCaused.violence.civilUnrest', name: 'Civil Unrest' }
                        ]
                    },
                    {
                        subcategory: 'Terrorism',
                        events: [
                            { id: 'humanCaused.terrorism.bombThreat', name: 'Bomb Threat' },
                            { id: 'humanCaused.terrorism.chemicalAttack', name: 'Chemical Attack' },
                            { id: 'humanCaused.terrorism.sabotage', name: 'Sabotage' }
                        ]
                    },
                    {
                        subcategory: 'Accidents and Negligence',
                        events: [
                            { id: 'humanCaused.accidents.industrialAccident', name: 'Industrial Accident' },
                            { id: 'humanCaused.accidents.transportationCrash', name: 'Transportation Crash' },
                            { id: 'humanCaused.accidents.humanErrorSpill', name: 'Human Error Spill' }
                        ]
                    },
                    {
                        subcategory: 'Social Disruptions',
                        events: [
                            { id: 'humanCaused.social.strike', name: 'Strike' },
                            { id: 'humanCaused.social.protest', name: 'Protest' },
                            { id: 'humanCaused.social.massGathering', name: 'Mass Gathering' }
                        ]
                    }
                ]
            },
            tech: {
                title: 'Technological Issue',
                subcategories: [
                    {
                        subcategory: '',
                        events: [
                            { id: 'technological.infrastructureFailure', name: 'Infrastructure Failure' },
                            { id: 'technological.cyberSecurity', name: 'Cyber Security' }
                        ]
                    },
                    {
                        subcategory: 'Infrastructure Failures',
                        events: [
                            { id: 'technological.infrastructure.powerOutage', name: 'Power Outage' },
                            { id: 'technological.infrastructure.gridCollapse', name: 'Grid Collapse' },
                            { id: 'technological.infrastructure.utilityDisruption', name: 'Utility Disruption' }
                        ]
                    },
                    {
                        subcategory: 'Hazardous Material Incidents',
                        events: [
                            { id: 'technological.hazmat.chemicalSpill', name: 'Chemical Spill' },
                            { id: 'technological.hazmat.radiationLeak', name: 'Radiation Leak' },
                            { id: 'technological.hazmat.industrialExplosion', name: 'Industrial Explosion' }
                        ]
                    },
                    {
                        subcategory: 'Equipment Malfunctions',
                        events: [
                            { id: 'technological.equipment.machineryBreakdown', name: 'Machinery Breakdown' },
                            { id: 'technological.equipment.vehicleFailure', name: 'Vehicle Failure' },
                            { id: 'technological.equipment.buildingFault', name: 'Building Fault' }
                        ]
                    },
                    {
                        subcategory: 'Transportation Disruptions',
                        events: [
                            { id: 'technological.transportation.airFailure', name: 'Air Failure' },
                            { id: 'technological.transportation.railFailure', name: 'Rail Failure' },
                            { id: 'technological.transportation.roadFailure', name: 'Road Failure' }
                        ]
                    }
                ]
            },
            biological: {
                title: 'Biological or Health-Related Hazards',
                subcategories: [
                    {
                        subcategory: 'Infectious Disease Outbreaks',
                        events: [
                            { id: 'biological.disease.pandemic', name: 'Pandemic' },
                            { id: 'biological.disease.epidemic', name: 'Epidemic' },
                            { id: 'biological.disease.viralSpread', name: 'Viral Spread' }
                        ]
                    },
                    {
                        subcategory: 'Bioterrorism',
                        events: [
                            { id: 'biological.bioterrorism.pathogenRelease', name: 'Intentional Pathogen Release' },
                            { id: 'biological.bioterrorism.bioAttack', name: 'Biological Attack' }
                        ]
                    },
                    {
                        subcategory: 'Food or Water Contamination',
                        events: [
                            { id: 'biological.contamination.foodBacterial', name: 'Food Bacterial Contamination' },
                            { id: 'biological.contamination.waterToxin', name: 'Water Toxin Contamination' }
                        ]
                    },
                    {
                        subcategory: 'Zoonotic Diseases',
                        events: [
                            { id: 'biological.zoonotic.avianFlu', name: 'Avian Flu' },
                            { id: 'biological.zoonotic.animalTransmission', name: 'Animal-to-Human Transmission' }
                        ]
                    }
                ]
            },
            cyber: {
                title: 'Cyber or Digital Threats',
                subcategories: [
                    {
                        subcategory: 'Cyberattacks',
                        events: [
                            { id: 'cyber.attack.hacking', name: 'Hacking' },
                            { id: 'cyber.attack.phishing', name: 'Phishing' },
                            { id: 'cyber.attack.malware', name: 'Malware' }
                        ]
                    },
                    {
                        subcategory: 'Data Breaches',
                        events: [
                            { id: 'cyber.breach.unauthorizedAccess', name: 'Unauthorized Access' },
                            { id: 'cyber.breach.dataTheft', name: 'Data Theft' }
                        ]
                    },
                    {
                        subcategory: 'Denial-of-Service Attacks',
                        events: [
                            { id: 'cyber.dos.systemOverload', name: 'System Overload' },
                            { id: 'cyber.dos.trafficFlood', name: 'Traffic Flood' }
                        ]
                    },
                    {
                        subcategory: 'Ransomware',
                        events: [
                            { id: 'cyber.ransomware.dataEncryption', name: 'Data Encryption for Ransom' },
                            { id: 'cyber.ransomware.systemLock', name: 'System Lock' }
                        ]
                    }
                ]
            },
            economic: {
                title: 'Economic or Financial Crises',
                subcategories: [
                    {
                        subcategory: 'Market Fluctuations',
                        events: [
                            { id: 'economic.market.stockCrash', name: 'Stock Crash' },
                            { id: 'economic.market.recession', name: 'Recession' },
                            { id: 'economic.market.inflation', name: 'Inflation' }
                        ]
                    },
                    {
                        subcategory: 'Supply Chain Failures',
                        events: [
                            { id: 'economic.supply.materialSourcing', name: 'Material Sourcing Disruption' },
                            { id: 'economic.supply.inventoryShortage', name: 'Inventory Shortage' }
                        ]
                    },
                    {
                        subcategory: 'Funding Shortfalls',
                        events: [
                            { id: 'economic.funding.grantLoss', name: 'Loss of Grants' },
                            { id: 'economic.funding.revenueLoss', name: 'Revenue Loss' }
                        ]
                    },
                    {
                        subcategory: 'Currency or Trade Issues',
                        events: [
                            { id: 'economic.trade.currencyDevaluation', name: 'Currency Devaluation' },
                            { id: 'economic.trade.tariffs', name: 'Tariffs' },
                            { id: 'economic.trade.tradeWar', name: 'Trade War' }
                        ]
                    }
                ]
            },
            operational: {
                title: 'Operational or Internal Risks',
                subcategories: [
                    {
                        subcategory: 'Human Resource Issues',
                        events: [
                            { id: 'operational.hr.staffShortage', name: 'Staff Shortage' },
                            { id: 'operational.hr.successionGap', name: 'Succession Gap' },
                            { id: 'operational.hr.keyPersonnelLoss', name: 'Key Personnel Loss' }
                        ]
                    },
                    {
                        subcategory: 'Process Failures',
                        events: [
                            { id: 'operational.process.workflowBreakdown', name: 'Workflow Breakdown' },
                            { id: 'operational.process.complianceViolation', name: 'Compliance Violation' }
                        ]
                    },
                    {
                        subcategory: 'Supplier or Vendor Dependencies',
                        events: [
                            { id: 'operational.vendor.externalPartnerFailure', name: 'External Partner Failure' },
                            { id: 'operational.vendor.contractBreach', name: 'Contract Breach' }
                        ]
                    },
                    {
                        subcategory: 'Project Management Risks',
                        events: [
                            { id: 'operational.project.scopeCreep', name: 'Scope Creep' },
                            { id: 'operational.project.delay', name: 'Project Delay' }
                        ]
                    }
                ]
            }
        };

        // Category data structure (current user's categories - starts with defaults)
        const categoryData = {
            natural: {
                title: 'Natural Hazards',
                subcategories: [
                    {
                        subcategory: 'Geological',
                        events: [
                            { id: 'naturalHazards.geological.landslide', name: 'Landslide' },
                            { id: 'naturalHazards.geological.earthquake', name: 'Earthquake' },
                            { id: 'naturalHazards.geological.volcano', name: 'Volcano' }
                        ]
                    },
                    {
                        subcategory: 'Meteorological',
                        events: [
                            { id: 'naturalHazards.meteorological.dustStorm', name: 'Dust storm' },
                            { id: 'naturalHazards.meteorological.extremeTemperatures', name: 'Extreme Temperatures' },
                            { id: 'naturalHazards.meteorological.snow', name: 'Snow' },
                            { id: 'naturalHazards.meteorological.flood', name: 'Flood' },
                            { id: 'naturalHazards.meteorological.lightning', name: 'Lightning' }
                        ]
                    }
                ]
            },
            human: {
                title: 'Human Caused Events',
                subcategories: [
                    {
                        subcategory: 'Accidental',
                        events: [
                            { id: 'humanCaused.accidental.fire', name: 'Fire' },
                            { id: 'humanCaused.accidental.buildingCollapse', name: 'Building Collapse' },
                            { id: 'humanCaused.accidental.hazardousMaterialSpill', name: 'Hazardous Material Spill' }
                        ]
                    },
                    {
                        subcategory: 'Intentional',
                        events: [
                            { id: 'humanCaused.intentional.workplaceViolence', name: 'Workplace Violence' },
                            { id: 'humanCaused.intentional.protests', name: 'Protests' }
                        ]
                    }
                ]
            },
            tech: {
                title: 'Technological Issue',
                subcategories: [
                    {
                        subcategory: '',
                        events: [
                            { id: 'technological.infrastructureFailure', name: 'Infrastructure Failure' },
                            { id: 'technological.cyberSecurity', name: 'Cyber Security' }
                        ]
                    }
                ]
            }
        };

        // Initialize main flowchart
        function initCategories() {
            const container = document.getElementById('flowchartMain');
            container.innerHTML = generateMainFlowchartHTML();
        }

        function generateMainFlowchartHTML() {
            let html = '';
            
            // Root Node with Add Category button inside
            html += '<div class="root-node" id="rootNode" style="position: relative; display: flex; align-items: center; justify-content: center; gap: 10px;">';
            html += '<span>Business Contingency Plan</span>';
            html += '<button onclick="addCategory()" style="background: rgba(255, 255, 255, 0.2); color: white; border: 2px solid white; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; padding: 0; transition: all 0.2s; font-weight: bold;" onmouseover="this.style.background=\'rgba(255, 255, 255, 0.3)\'" onmouseout="this.style.background=\'rgba(255, 255, 255, 0.2)\'" title="Add Category">+</button>';
            html += '</div>';
            
            // Connection lines container
            html += '<div class="root-to-categories-lines" id="rootLines"></div>';
            
            // Categories Row - Side by Side (dynamically generated)
            html += '<div class="categories-row" id="categoriesRow">';
            Object.keys(categoryData).forEach((categoryType, index) => {
                const category = categoryData[categoryType];
                const emoji = getCategoryEmoji(categoryType);
                const style = getCategoryStyle(categoryType, index);
                html += `<div class="category-wrapper" style="position: relative; display: flex; flex-direction: column; align-items: center; gap: 10px;">`;
                html += `<div class="category-node ${categoryType}" id="category${categoryType}" onclick="openCategoryModal('${categoryType}')" style="background: ${style.background}; border: ${style.border}; color: ${style.color}; word-wrap: break-word; overflow-wrap: break-word;">${emoji} ${escapeHtml(category.title)}</div>`;
                html += `<button class="btn-delete-event" onclick="deleteCategory('${categoryType}')" title="Delete this category" style="background: var(--error); color: white; border: none; border-radius: var(--radius-md); padding: 6px 10px; cursor: pointer; font-size: 0.8em; font-weight: 600;">üóëÔ∏è</button>`;
                html += `</div>`;
            });
            html += '</div>';
            
            // Draw connection lines after HTML is inserted
            setTimeout(() => {
                drawRootToCategoryLines();
            }, 100);
            
            return html;
        }
        
        function getCategoryEmoji(categoryType) {
            const emojiMap = {
                'natural': 'üå™Ô∏è',
                'human': 'üö®',
                'tech': 'üíª',
                'biological': 'ü¶†',
                'cyber': 'üîí',
                'economic': 'üí∞',
                'operational': '‚öôÔ∏è'
            };
            return emojiMap[categoryType] || 'üìã';
        }
        
        function getCategoryStyle(categoryType, index) {
            // Existing categories have predefined styles
            const styleMap = {
                'natural': {
                    background: 'var(--warning-light)',
                    border: '3px solid var(--warning)',
                    color: 'var(--text-primary)'
                },
                'human': {
                    background: 'var(--error-light)',
                    border: '3px solid var(--error)',
                    color: 'var(--text-primary)'
                },
                'tech': {
                    background: 'var(--error-light)',
                    border: '3px solid var(--error)',
                    color: 'var(--text-primary)'
                },
                'biological': {
                    background: 'var(--success-light)',
                    border: '3px solid var(--success)',
                    color: 'var(--text-primary)'
                },
                'cyber': {
                    background: 'var(--info-light)',
                    border: '3px solid var(--info)',
                    color: 'var(--text-primary)'
                },
                'economic': {
                    background: 'var(--warning-light)',
                    border: '3px solid var(--warning)',
                    color: 'var(--text-primary)'
                },
                'operational': {
                    background: 'var(--bg-tertiary)',
                    border: '3px solid var(--text-secondary)',
                    color: 'var(--text-primary)'
                }
            };
            
            // If category has predefined style, return it
            if (styleMap[categoryType]) {
                return styleMap[categoryType];
            }
            
            // For custom categories not in library, cycle through available color schemes
            const colorSchemes = [
                { background: 'var(--warning-light)', border: '3px solid var(--warning)', color: 'var(--text-primary)' }, // Yellow/Amber
                { background: 'var(--error-light)', border: '3px solid var(--error)', color: 'var(--text-primary)' }, // Red/Pink
                { background: 'var(--info-light)', border: '3px solid var(--info)', color: 'var(--text-primary)' }, // Blue
                { background: 'var(--success-light)', border: '3px solid var(--success)', color: 'var(--text-primary)' } // Green
            ];
            
            // Use index to cycle through colors
            // Count how many predefined categories come before this one
            const predefined = ['natural', 'human', 'tech', 'biological', 'cyber', 'economic', 'operational'];
            const categoryKeys = Object.keys(categoryData);
            const categoryIndex = categoryKeys.indexOf(categoryType);
            const predefinedBefore = categoryKeys.slice(0, categoryIndex).filter(k => predefined.includes(k)).length;
            const newCategoryIndex = categoryIndex - predefinedBefore;
            const colorIndex = newCategoryIndex % colorSchemes.length;
            return colorSchemes[colorIndex];
        }

        let currentOpenCategory = null;

        // Open category detail section below categories
        function openCategoryModal(categoryType) {
            const category = categoryData[categoryType];
            if (!category) return;
            
            const detailSection = document.getElementById('categoryDetailSection');
            const flowchartContainer = document.getElementById('categoryFlowchart');
            
            // Remove active class from all category nodes
            document.querySelectorAll('.category-node').forEach(node => {
                node.classList.remove('active');
            });
            
            // If clicking the same category, close it
            if (currentOpenCategory === categoryType) {
                detailSection.classList.remove('expanded');
                currentOpenCategory = null;
                currentOpenSubcategory = null; // Also close any open subcategory
                return;
            }
            
            // Close any other open category and open the selected one
            currentOpenCategory = categoryType;
            currentOpenSubcategory = null; // Close any previously open subcategory
            flowchartContainer.innerHTML = generateCategoryFlowchartHTML(categoryType, category);
            detailSection.classList.add('expanded');
            
            // Add active class to clicked category
            const clickedNode = document.querySelector(`.category-node.${categoryType}`);
            if (clickedNode) {
                clickedNode.classList.add('active');
            }
            
            // Scroll to the expanded section smoothly
            setTimeout(() => {
                detailSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 300);
        }

        function generateCategoryFlowchartHTML(type, category) {
            let html = '<div class="category-flowchart-container" id="categoryFlowchartContainer">';
            
            // Category Name Node with Add Subcategory button inside
            const categoryStyle = getCategoryStyle(type, Object.keys(categoryData).indexOf(type));
            html += `<div class="category-name-node ${type}" id="categoryNameNode" style="position: relative; display: flex; align-items: center; justify-content: center; gap: 10px; background: ${categoryStyle.background}; border: ${categoryStyle.border}; color: ${categoryStyle.color}; word-wrap: break-word; overflow-wrap: break-word;">`;
            html += `<span>${escapeHtml(category.title)}</span>`;
            html += `<button onclick="addSubcategory('${type}')" style="background: rgba(0, 0, 0, 0.1); color: currentColor; border: 2px solid currentColor; border-radius: 50%; width: 28px; height: 28px; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center; padding: 0; transition: all 0.2s; font-weight: bold;" onmouseover="this.style.background='rgba(0, 0, 0, 0.2)'" onmouseout="this.style.background='rgba(0, 0, 0, 0.1)'" title="Add Subcategory">+</button>`;
            html += '</div>';
            
            // Subcategories Container - Only show subcategories, not events yet
            html += '<div class="subcategory-container" id="subcategoryContainer">';
            
            category.subcategories.forEach((sub, subIndex) => {
                html += `<div class="subcategory-group" data-subcategory-index="${subIndex}" style="position: relative; display: flex; flex-direction: column; align-items: center; gap: 10px;">`;
                if (sub.subcategory) {
                    html += `<div class="subcategory-node" 
                                 data-subcategory-index="${subIndex}"
                                 data-category-type="${type}"
                                 onclick="openSubcategoryModal('${type}', ${subIndex})">${sub.subcategory}</div>`;
                } else {
                    // For categories without subcategory names (like Technological), show events directly
                    html += `<div class="subcategory-node" 
                                 data-subcategory-index="${subIndex}"
                                 data-category-type="${type}"
                                 onclick="openSubcategoryModal('${type}', ${subIndex})">${category.title} Events</div>`;
                }
                html += `<button class="btn-delete-event" onclick="deleteSubcategory('${type}', ${subIndex})" title="Delete this subcategory" style="background: var(--error); color: white; border: none; border-radius: var(--radius-md); padding: 6px 10px; cursor: pointer; font-size: 0.8em; font-weight: 600;">üóëÔ∏è</button>`;
                html += '</div>';
            });
            
            html += '</div>'; // Close subcategory-container
            
            // Subcategory Detail Section (for events/responses)
            html += '<div class="subcategory-detail-section" id="subcategoryDetailSection"></div>';
            
            html += '</div>'; // Close category-flowchart-container
            
            // Draw connection lines after HTML is inserted
            setTimeout(() => {
                drawCategoryToSubcategoryLines();
            }, 50);
            
            return html;
        }

        let currentOpenSubcategory = null;

        function openSubcategoryModal(categoryType, subcategoryIndex) {
            const category = categoryData[categoryType];
            if (!category || !category.subcategories[subcategoryIndex]) return;
            
            const subcategory = category.subcategories[subcategoryIndex];
            const detailSection = document.getElementById('subcategoryDetailSection');
            
            // Remove active class from all subcategory nodes
            document.querySelectorAll('.subcategory-node').forEach(node => {
                node.classList.remove('active');
            });
            
            // If clicking the same subcategory, close it
            const subcategoryKey = `${categoryType}-${subcategoryIndex}`;
            if (currentOpenSubcategory === subcategoryKey) {
                detailSection.classList.remove('expanded');
                currentOpenSubcategory = null;
                return;
            }
            
            // Close any other open subcategory and open the selected one
            currentOpenSubcategory = subcategoryKey;
            detailSection.innerHTML = generateSubcategoryFlowchartHTML(categoryType, subcategory, subcategoryIndex);
            detailSection.classList.add('expanded');
            
            // Add active class to clicked subcategory
            const clickedNode = document.querySelector(`.subcategory-node[data-subcategory-index="${subcategoryIndex}"][data-category-type="${categoryType}"]`);
            if (clickedNode) {
                clickedNode.classList.add('active');
            }
            
            // Scroll to the expanded section smoothly
            setTimeout(() => {
                detailSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 300);
        }

        function generateSubcategoryFlowchartHTML(categoryType, subcategory, subcategoryIndex) {
            let html = '<div class="subcategory-flowchart-container" id="subcategoryFlowchartContainer">';
            
            // Left side: Subcategory name (if it exists) with Add Event button
            const subcategoryName = subcategory.subcategory || categoryData[categoryType].title + ' Events';
            html += `<div style="min-width: 200px; padding: 20px; display: flex; flex-direction: column; gap: 15px; align-items: flex-start;">
                        <div style="font-size: 1.3em; font-weight: 700; color: var(--text-primary);">${subcategoryName}</div>
                        <button class="btn-primary" onclick="addEventToSubcategory('${categoryType}', ${subcategoryIndex})" style="font-size: 0.9em; padding: 8px 16px;">
                            ‚ûï Add Event
                        </button>
                     </div>`;
            
            // Middle: Events Column (vertical stack)
            html += '<div class="events-column" id="eventsColumn">';
            subcategory.events.forEach((event, eventIndex) => {
                const hasResponse = getResponse(event.id) !== '';
                const eventClass = hasResponse ? 'has-response' : '';
                html += `
                    <div class="event-wrapper" data-event-index="${eventIndex}">
                        <div class="event-node ${eventClass}" 
                             data-event-index="${eventIndex}" 
                             data-subcategory-index="${subcategoryIndex}"
                             onclick="openResponseModal('${event.id}', '${event.name}')"
                             style="flex: 1;">
                            ${event.name}
                        </div>
                        <button class="btn-delete-event" 
                                onclick="deleteEventFromSubcategory('${categoryType}', ${subcategoryIndex}, ${eventIndex})"
                                title="Delete this event"
                                style="background: var(--error); color: white; border: none; border-radius: var(--radius-md); padding: 8px 12px; cursor: pointer; font-size: 0.9em; font-weight: 600; transition: all var(--transition-base); flex-shrink: 0;">
                            üóëÔ∏è
                        </button>
                    </div>
                `;
            });
            html += '</div>'; // Close events-column
            
            // Right side: Response Column (vertical, aligned with events)
            html += '<div class="response-column" id="responseColumn">';
            subcategory.events.forEach((event, eventIndex) => {
                const hasResponse = getResponse(event.id) !== '';
                const responseClass = hasResponse ? '' : 'empty';
                html += `
                    <div class="response-wrapper" data-response-index="${eventIndex}" style="display: flex; align-items: center; gap: 10px;">
                        <div class="response-node ${responseClass}" 
                             data-response-index="${eventIndex}"
                             onclick="openResponseModal('${event.id}', '${event.name}')"
                             style="flex: 1;">
                            Response
                        </div>
                        ${hasResponse ? `
                        <button class="btn-delete-response" 
                                onclick="deleteResponse('${event.id}', '${event.name}')"
                                title="Clear response content"
                                style="background: var(--error); color: white; border: none; border-radius: var(--radius-md); padding: 8px 12px; cursor: pointer; font-size: 0.9em; font-weight: 600; transition: all var(--transition-base); flex-shrink: 0;">
                            üóëÔ∏è
                        </button>
                        ` : ''}
                    </div>
                `;
            });
            html += '</div>'; // Close response-column
            
            html += '</div>'; // Close subcategory-flowchart-container
            
            // Draw connection lines after HTML is inserted
            setTimeout(() => {
                drawSubcategoryFlowchartLines(subcategoryIndex);
            }, 50);
            
            return html;
        }

        function drawRootToCategoryLines() {
            const rootNode = document.getElementById('rootNode');
            const categoriesRow = document.getElementById('categoriesRow');
            const rootLines = document.getElementById('rootLines');
            
            if (!rootNode || !categoriesRow || !rootLines) return;
            
            const container = rootNode.parentElement;
            const containerRect = container.getBoundingClientRect();
            const rootRect = rootNode.getBoundingClientRect();
            const rowRect = categoriesRow.getBoundingClientRect();
            
            // Calculate positions relative to container
            const rootBottom = rootRect.bottom - containerRect.top;
            const rootCenterX = rootRect.left + rootRect.width / 2 - containerRect.left;
            const rowTop = rowRect.top - containerRect.top;
            
            // Clear existing lines
            rootLines.innerHTML = '';
            
            // Main vertical line from root
            const verticalLine = document.createElement('div');
            verticalLine.style.cssText = `
                position: absolute;
                left: ${rootCenterX}px;
                top: ${rootBottom}px;
                width: 3px;
                height: ${rowTop - rootBottom}px;
                background: var(--text-tertiary);
                opacity: 0.5;
            `;
            rootLines.appendChild(verticalLine);
            
            // Horizontal line across categories
            const categories = categoriesRow.querySelectorAll('.category-node');
            if (categories.length > 0) {
                const firstCat = categories[0].getBoundingClientRect();
                const lastCat = categories[categories.length - 1].getBoundingClientRect();
                const lineStartX = firstCat.left + firstCat.width / 2 - containerRect.left;
                const lineEndX = lastCat.left + lastCat.width / 2 - containerRect.left;
                const lineY = rowTop;
                
                const horizontalLine = document.createElement('div');
                horizontalLine.style.cssText = `
                    position: absolute;
                    left: ${lineStartX}px;
                    top: ${lineY}px;
                    width: ${lineEndX - lineStartX}px;
                    height: 3px;
                    background: var(--text-tertiary);
                    opacity: 0.5;
                `;
                rootLines.appendChild(horizontalLine);
                
                // Vertical lines down to each category
                categories.forEach((cat) => {
                    const catRect = cat.getBoundingClientRect();
                    const catCenterX = catRect.left + catRect.width / 2 - containerRect.left;
                    
                    const verticalToCat = document.createElement('div');
                    verticalToCat.style.cssText = `
                        position: absolute;
                        left: ${catCenterX}px;
                        top: ${lineY}px;
                        width: 3px;
                        height: 20px;
                        background: var(--text-tertiary);
                        opacity: 0.5;
                    `;
                    rootLines.appendChild(verticalToCat);
                });
            }
        }

        function drawCategoryToSubcategoryLines() {
            const container = document.getElementById('categoryFlowchartContainer');
            if (!container) return;
            
            const categoryNode = document.getElementById('categoryNameNode');
            const subcategoryContainer = document.getElementById('subcategoryContainer');
            
            if (!categoryNode || !subcategoryContainer) return;
            
            // Remove any existing line container
            const existingLines = container.querySelector('.flowchart-lines-container');
            if (existingLines) existingLines.remove();
            
            const containerRect = container.getBoundingClientRect();
            const categoryRect = categoryNode.getBoundingClientRect();
            const subcatRect = subcategoryContainer.getBoundingClientRect();
            
            // Create SVG container for lines (behind content)
            const linesContainer = document.createElement('div');
            linesContainer.className = 'flowchart-lines-container';
            container.appendChild(linesContainer);
            
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            linesContainer.appendChild(svg);
            
            // Calculate positions relative to container
            const categoryBottom = categoryRect.bottom - containerRect.top;
            const categoryCenterX = categoryRect.left + categoryRect.width / 2 - containerRect.left;
            const subcatTop = subcatRect.top - containerRect.top;
            
            // Main vertical line from category to subcategories
            const verticalLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            verticalLine.setAttribute('x1', categoryCenterX);
            verticalLine.setAttribute('y1', categoryBottom);
            verticalLine.setAttribute('x2', categoryCenterX);
            verticalLine.setAttribute('y2', subcatTop);
            verticalLine.setAttribute('class', 'flowchart-line');
            svg.appendChild(verticalLine);
            
            // Horizontal line across subcategories
            const subcategoryGroups = subcategoryContainer.querySelectorAll('.subcategory-group');
            if (subcategoryGroups.length > 0) {
                const firstSubcat = subcategoryGroups[0].querySelector('.subcategory-node');
                const lastSubcat = subcategoryGroups[subcategoryGroups.length - 1].querySelector('.subcategory-node');
                
                if (firstSubcat && lastSubcat) {
                    const firstRect = firstSubcat.getBoundingClientRect();
                    const lastRect = lastSubcat.getBoundingClientRect();
                    const lineStartX = firstRect.left + firstRect.width / 2 - containerRect.left;
                    const lineEndX = lastRect.left + lastRect.width / 2 - containerRect.left;
                    const lineY = subcatTop;
                    
                    const horizontalLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    horizontalLine.setAttribute('x1', lineStartX);
                    horizontalLine.setAttribute('y1', lineY);
                    horizontalLine.setAttribute('x2', lineEndX);
                    horizontalLine.setAttribute('y2', lineY);
                    horizontalLine.setAttribute('class', 'flowchart-line');
                    svg.appendChild(horizontalLine);
                    
                    // Vertical lines from horizontal line to each subcategory
                    subcategoryGroups.forEach((subcatGroup) => {
                        const subcatNode = subcatGroup.querySelector('.subcategory-node');
                        if (subcatNode) {
                            const subcatRect = subcatNode.getBoundingClientRect();
                            const subcatCenterX = subcatRect.left + subcatRect.width / 2 - containerRect.left;
                            const subcatNodeTop = subcatRect.top - containerRect.top;
                            
                            const verticalToSubcat = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                            verticalToSubcat.setAttribute('x1', subcatCenterX);
                            verticalToSubcat.setAttribute('y1', lineY);
                            verticalToSubcat.setAttribute('x2', subcatCenterX);
                            verticalToSubcat.setAttribute('y2', subcatNodeTop);
                            verticalToSubcat.setAttribute('class', 'flowchart-line');
                            svg.appendChild(verticalToSubcat);
                        }
                    });
                }
            }
        }

        function drawSubcategoryFlowchartLines(subcategoryIndex) {
            const container = document.getElementById('subcategoryFlowchartContainer');
            if (!container) return;
            
            const eventsColumn = document.getElementById('eventsColumn');
            const responseColumn = document.getElementById('responseColumn');
            
            if (!eventsColumn || !responseColumn) return;
            
            // Remove any existing line container
            const existingLines = container.querySelector('.flowchart-lines-container');
            if (existingLines) existingLines.remove();
            
            const containerRect = container.getBoundingClientRect();
            
            // Create SVG container for lines (behind content)
            const linesContainer = document.createElement('div');
            linesContainer.className = 'flowchart-lines-container';
            container.appendChild(linesContainer);
            
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('width', '100%');
            svg.setAttribute('height', '100%');
            linesContainer.appendChild(svg);
            
            // Draw horizontal lines from each event to its corresponding response
            // Get event nodes (not the wrapper divs)
            const eventNodes = eventsColumn.querySelectorAll('.event-node');
            const responseNodes = responseColumn.querySelectorAll('.response-node');
            
            eventNodes.forEach((eventNode, index) => {
                if (responseNodes[index]) {
                    const eventRect = eventNode.getBoundingClientRect();
                    const responseRect = responseNodes[index].getBoundingClientRect();
                    
                    // Calculate line start from the event node's right edge (before delete button)
                    const eventRight = eventRect.right - containerRect.left;
                    const responseLeft = responseRect.left - containerRect.left;
                    const eventCenterY = eventRect.top + eventRect.height / 2 - containerRect.top;
                    
                    // Draw perfectly horizontal line from event to response
                    // Make sure line stops before the delete button area
                    const lineStartX = eventRight;
                    const lineEndX = responseLeft;
                    
                    const eventToResponseLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    eventToResponseLine.setAttribute('x1', lineStartX);
                    eventToResponseLine.setAttribute('y1', eventCenterY);
                    eventToResponseLine.setAttribute('x2', lineEndX);
                    eventToResponseLine.setAttribute('y2', eventCenterY);
                    eventToResponseLine.setAttribute('class', 'flowchart-line');
                    svg.appendChild(eventToResponseLine);
                }
            });
        }

        function getResponse(eventId) {
            const parts = eventId.split('.');
            let data = contingencyData;
            for (let part of parts) {
                if (data[part] !== undefined) {
                    data = data[part];
                } else {
                    return '';
                }
            }
            return typeof data === 'string' ? data : '';
        }

        function setResponse(eventId, response) {
            const parts = eventId.split('.');
            let data = contingencyData;
            for (let i = 0; i < parts.length - 1; i++) {
                if (!data[parts[i]]) {
                    data[parts[i]] = {};
                }
                data = data[parts[i]];
            }
            data[parts[parts.length - 1]] = response;
        }
        
        function getEventMetadata(eventId) {
            return eventMetadata[eventId] || {
                priority: '',
                likelihood: '',
                impact: '',
                responsible: '',
                recoveryTime: '',
                status: 'Not Started'
            };
        }
        
        function setEventMetadata(eventId, metadata) {
            eventMetadata[eventId] = metadata;
        }

        // Parse response text into sections
        function parseResponseSections(responseText) {
            const sections = {
                immediateActions: '',
                communicationPlan: '',
                recoveryProcedures: '',
                rolesResponsibilities: '',
                resourcesNeeded: ''
            };
            
            if (!responseText || !responseText.trim()) return sections;
            
            // Split by section headers - sections are separated by blank lines (double newline)
            // Use [\s\S] to match any character including newlines
            let immediateMatch = responseText.match(/IMMEDIATE ACTIONS:\s*\n([\s\S]*?)(?=\n\nCOMMUNICATION PLAN:|$)/i);
            let communicationMatch = responseText.match(/COMMUNICATION PLAN:\s*\n([\s\S]*?)(?=\n\nRECOVERY PROCEDURES:|$)/i);
            let recoveryMatch = responseText.match(/RECOVERY PROCEDURES:\s*\n([\s\S]*?)(?=\n\nROLES & RESPONSIBILITIES:|$)/i);
            let rolesMatch = responseText.match(/ROLES & RESPONSIBILITIES:\s*\n([\s\S]*?)(?=\n\nRESOURCES NEEDED:|$)/i);
            let resourcesMatch = responseText.match(/RESOURCES NEEDED:\s*\n([\s\S]*?)$/i);
            
            // If double newline didn't match, try single newline (fallback)
            if (!immediateMatch || !immediateMatch[1]) {
                immediateMatch = responseText.match(/IMMEDIATE ACTIONS:\s*\n([\s\S]*?)(?=\nCOMMUNICATION PLAN:|$)/i);
            }
            if (!communicationMatch || !communicationMatch[1]) {
                communicationMatch = responseText.match(/COMMUNICATION PLAN:\s*\n([\s\S]*?)(?=\nRECOVERY PROCEDURES:|$)/i);
            }
            if (!recoveryMatch || !recoveryMatch[1]) {
                recoveryMatch = responseText.match(/RECOVERY PROCEDURES:\s*\n([\s\S]*?)(?=\nROLES & RESPONSIBILITIES:|$)/i);
            }
            if (!rolesMatch || !rolesMatch[1]) {
                rolesMatch = responseText.match(/ROLES & RESPONSIBILITIES:\s*\n([\s\S]*?)(?=\nRESOURCES NEEDED:|$)/i);
            }
            if (!resourcesMatch || !resourcesMatch[1]) {
                resourcesMatch = responseText.match(/RESOURCES NEEDED:\s*\n([\s\S]*?)$/i);
            }
            
            if (immediateMatch && immediateMatch[1]) sections.immediateActions = immediateMatch[1].trim();
            if (communicationMatch && communicationMatch[1]) sections.communicationPlan = communicationMatch[1].trim();
            if (recoveryMatch && recoveryMatch[1]) sections.recoveryProcedures = recoveryMatch[1].trim();
            if (rolesMatch && rolesMatch[1]) sections.rolesResponsibilities = rolesMatch[1].trim();
            if (resourcesMatch && resourcesMatch[1]) sections.resourcesNeeded = resourcesMatch[1].trim();
            
            return sections;
        }
        
        // Combine sections into formatted response text
        function combineResponseSections(sections) {
            let response = '';
            
            if (sections.immediateActions) {
                response += 'IMMEDIATE ACTIONS:\n' + sections.immediateActions + '\n\n';
            }
            if (sections.communicationPlan) {
                response += 'COMMUNICATION PLAN:\n' + sections.communicationPlan + '\n\n';
            }
            if (sections.recoveryProcedures) {
                response += 'RECOVERY PROCEDURES:\n' + sections.recoveryProcedures + '\n\n';
            }
            if (sections.rolesResponsibilities) {
                response += 'ROLES & RESPONSIBILITIES:\n' + sections.rolesResponsibilities + '\n\n';
            }
            if (sections.resourcesNeeded) {
                response += 'RESOURCES NEEDED:\n' + sections.resourcesNeeded;
            }
            
            return response.trim();
        }
        
        // Switch to edit mode (interactive)
        function switchToEditMode() {
            // Get current response and parse into sections
            if (currentEventId) {
                const currentResponse = getResponse(currentEventId);
                const sections = parseResponseSections(currentResponse);
                
                // Populate fields
                document.getElementById('immediateActions').value = sections.immediateActions;
                document.getElementById('communicationPlan').value = sections.communicationPlan;
                document.getElementById('recoveryProcedures').value = sections.recoveryProcedures;
                document.getElementById('rolesResponsibilities').value = sections.rolesResponsibilities;
                document.getElementById('resourcesNeeded').value = sections.resourcesNeeded;
                
                // Make fields editable
                ['immediateActions', 'communicationPlan', 'recoveryProcedures', 'rolesResponsibilities', 'resourcesNeeded'].forEach(id => {
                    const field = document.getElementById(id);
                    field.readOnly = false;
                    field.style.fontStyle = 'normal';
                    field.style.color = '';
                    field.style.background = '';
                });
            }
            
            document.getElementById('responsePlanView').style.display = 'none';
            document.getElementById('responsePlanInteractive').style.display = 'block';
            document.getElementById('saveResponseBtn').style.display = 'inline-block';
        }
        
        // Switch to view mode (formatted display)
        function switchToViewMode() {
            // Get current response from storage or combine sections
            let formattedResponse = '';
            if (currentEventId) {
                const storedResponse = getResponse(currentEventId);
                if (storedResponse && storedResponse.trim().length > 0) {
                    formattedResponse = storedResponse;
                } else {
                    // Combine sections if no stored response
                    const sections = {
                        immediateActions: document.getElementById('immediateActions').value,
                        communicationPlan: document.getElementById('communicationPlan').value,
                        recoveryProcedures: document.getElementById('recoveryProcedures').value,
                        rolesResponsibilities: document.getElementById('rolesResponsibilities').value,
                        resourcesNeeded: document.getElementById('resourcesNeeded').value
                    };
                    formattedResponse = combineResponseSections(sections);
                }
            }
            
            // Display with proper formatting - preserve all line breaks and formatting exactly as stored
            const textView = document.getElementById('responseTextView');
            textView.textContent = formattedResponse;
            // Ensure proper formatting is preserved
            textView.style.whiteSpace = 'pre-wrap';
            textView.style.fontFamily = 'Inter, sans-serif';
            textView.style.lineHeight = '1.8';
            textView.style.color = 'var(--text-primary)';
            textView.style.fontSize = '1em';
            
            document.getElementById('responsePlanInteractive').style.display = 'none';
            document.getElementById('responsePlanView').style.display = 'block';
            document.getElementById('saveResponseBtn').style.display = 'none';
        }
        
        // Toggle section help
        function toggleSectionHelp(sectionId) {
            const helpDiv = document.getElementById(sectionId + 'Help');
            if (helpDiv) {
                helpDiv.style.display = helpDiv.style.display === 'none' ? 'block' : 'none';
            }
        }
        
        function openResponseModal(eventId, eventName) {
            currentEventId = eventId;
            document.getElementById('responseModalTitle').textContent = `Response Plan: ${eventName}`;
            const toggleBtn = document.getElementById('exampleDataToggleBtn');
            const exampleResponse = getExampleResponse(eventId);
            const hasExample = exampleResponse !== null;
            
            // Reset modal state
            modalExampleBackup = null;
            
            // Check if we're in examples mode
            if (examplesMode) {
                // Examples mode is active - show example data
                const exampleMeta = typeof exampleMetadata !== 'undefined' ? (exampleMetadata[eventId] || {}) : {};
                
                // Populate with example metadata
                document.getElementById('eventPriority').value = exampleMeta.priority || '';
                document.getElementById('eventLikelihood').value = exampleMeta.likelihood || '';
                document.getElementById('eventImpact').value = exampleMeta.impact || '';
                document.getElementById('eventResponsible').value = exampleMeta.responsible || '';
                document.getElementById('eventRecoveryTime').value = exampleMeta.recoveryTime || '';
                document.getElementById('eventStatus').value = exampleMeta.status || 'Not Started';
                
                // Parse and show example response in sections
                const exampleSections = parseResponseSections(exampleResponse || '');
                document.getElementById('immediateActions').value = exampleSections.immediateActions;
                document.getElementById('communicationPlan').value = exampleSections.communicationPlan;
                document.getElementById('recoveryProcedures').value = exampleSections.recoveryProcedures;
                document.getElementById('rolesResponsibilities').value = exampleSections.rolesResponsibilities;
                document.getElementById('resourcesNeeded').value = exampleSections.resourcesNeeded;
                
                // Make fields read-only in example mode
                ['immediateActions', 'communicationPlan', 'recoveryProcedures', 'rolesResponsibilities', 'resourcesNeeded'].forEach(id => {
                    const field = document.getElementById(id);
                    field.readOnly = true;
                    field.style.fontStyle = 'italic';
                    field.style.color = '#666';
                    field.style.background = '#f5f5f5';
                });
                
                // Show "Your Data" button to switch back (both in interactive and view mode)
                const toggleBtnView = document.getElementById('exampleDataToggleBtnView');
                if (toggleBtn && hasExample) {
                    toggleBtn.style.display = 'inline-block';
                    toggleBtn.textContent = 'Your Data';
                    toggleBtn.style.background = '#28a745';
                    toggleBtn.onclick = () => toggleExampleInModal();
                } else {
                    if (toggleBtn) toggleBtn.style.display = 'none';
                }
                if (toggleBtnView && hasExample) {
                    toggleBtnView.style.display = 'inline-block';
                    toggleBtnView.textContent = 'Your Data';
                    toggleBtnView.style.background = '#28a745';
                } else {
                    if (toggleBtnView) toggleBtnView.style.display = 'none';
                }
                
                // In examples mode, always show interactive mode (read-only)
                document.getElementById('responsePlanView').style.display = 'none';
                document.getElementById('responsePlanInteractive').style.display = 'block';
                document.getElementById('saveResponseBtn').style.display = 'none'; // Can't save in examples mode
            } else {
                // Normal mode - show user's data
                const metadata = getEventMetadata(eventId);
                
                // Populate with user's metadata
                document.getElementById('eventPriority').value = metadata.priority || '';
                document.getElementById('eventLikelihood').value = metadata.likelihood || '';
                document.getElementById('eventImpact').value = metadata.impact || '';
                document.getElementById('eventResponsible').value = metadata.responsible || '';
                document.getElementById('eventRecoveryTime').value = metadata.recoveryTime || '';
                document.getElementById('eventStatus').value = metadata.status || 'Not Started';
                
                // Parse and show user's current response in sections
                const currentResponse = getResponse(eventId);
                const userSections = parseResponseSections(currentResponse);
                document.getElementById('immediateActions').value = userSections.immediateActions;
                document.getElementById('communicationPlan').value = userSections.communicationPlan;
                document.getElementById('recoveryProcedures').value = userSections.recoveryProcedures;
                document.getElementById('rolesResponsibilities').value = userSections.rolesResponsibilities;
                document.getElementById('resourcesNeeded').value = userSections.resourcesNeeded;
                
                // Make fields editable
                ['immediateActions', 'communicationPlan', 'recoveryProcedures', 'rolesResponsibilities', 'resourcesNeeded'].forEach(id => {
                    const field = document.getElementById(id);
                    field.readOnly = false;
                    field.style.fontStyle = 'normal';
                    field.style.color = '';
                    field.style.background = '';
                });
                
                // Show "Example" button if example exists (both in interactive and view mode)
                const toggleBtnView = document.getElementById('exampleDataToggleBtnView');
                if (toggleBtn && hasExample) {
                    toggleBtn.style.display = 'inline-block';
                    toggleBtn.textContent = 'üìã Example';
                    toggleBtn.style.background = 'var(--info)';
                    toggleBtn.onclick = () => toggleExampleInModal();
                } else {
                    if (toggleBtn) toggleBtn.style.display = 'none';
                }
                if (toggleBtnView && hasExample) {
                    toggleBtnView.style.display = 'inline-block';
                } else {
                    if (toggleBtnView) toggleBtnView.style.display = 'none';
                }
                
                // Check if user has saved data - if yes, show view mode; if no, show interactive mode
                const hasUserData = currentResponse && currentResponse.trim().length > 0;
                if (hasUserData) {
                    // User has data - show in view mode
                    switchToViewMode();
                } else {
                    // No data - show interactive mode
                    document.getElementById('responsePlanView').style.display = 'none';
                    document.getElementById('responsePlanInteractive').style.display = 'block';
                    document.getElementById('saveResponseBtn').style.display = 'inline-block';
                }
            }
            
            document.getElementById('responseModal').classList.add('show');
        }

        function toggleExampleInModal() {
            if (!currentEventId) return;
            
            const toggleBtn = document.getElementById('exampleDataToggleBtn');
            const exampleResponse = getExampleResponse(currentEventId);
            
            if (!exampleResponse) {
                alert('No example available for this event.');
                return;
            }
            
            // Get example metadata
            const exampleMeta = typeof exampleMetadata !== 'undefined' ? (exampleMetadata[currentEventId] || {}) : {};
            
            // Check if we're currently in view mode
            const isInViewMode = document.getElementById('responsePlanView').style.display !== 'none';
            
            // Determine current state: check if fields are read-only (showing example) or editable (showing user data)
            const immediateActionsField = document.getElementById('immediateActions');
            const isShowingExample = immediateActionsField && immediateActionsField.readOnly && !isInViewMode;
            
            if (isShowingExample) {
                // Currently showing example - switch to user's data
                let userResponse = '';
                let userMeta = {};
                
                if (examplesMode) {
                    // Examples mode is active - get user data from global backup
                    userResponse = getResponseFromBackup(currentEventId);
                    userMeta = metadataBackup ? (metadataBackup[currentEventId] || {}) : {};
                } else {
                    // Normal mode - get from modal backup
                    if (modalExampleBackup) {
                        userResponse = modalExampleBackup.response || '';
                        userMeta = modalExampleBackup.metadata || {};
                    } else {
                        // Fallback: get current user data
                        userResponse = getResponse(currentEventId);
                        userMeta = getEventMetadata(currentEventId);
                    }
                }
                
                // Parse and show user's response in sections
                const userSections = parseResponseSections(userResponse);
                document.getElementById('immediateActions').value = userSections.immediateActions;
                document.getElementById('communicationPlan').value = userSections.communicationPlan;
                document.getElementById('recoveryProcedures').value = userSections.recoveryProcedures;
                document.getElementById('rolesResponsibilities').value = userSections.rolesResponsibilities;
                document.getElementById('resourcesNeeded').value = userSections.resourcesNeeded;
                
                // Make fields editable
                ['immediateActions', 'communicationPlan', 'recoveryProcedures', 'rolesResponsibilities', 'resourcesNeeded'].forEach(id => {
                    const field = document.getElementById(id);
                    field.readOnly = false;
                    field.style.fontStyle = 'normal';
                    field.style.color = '';
                    field.style.background = '';
                });
                
                // Show user's metadata
                document.getElementById('eventPriority').value = userMeta.priority || '';
                document.getElementById('eventLikelihood').value = userMeta.likelihood || '';
                document.getElementById('eventImpact').value = userMeta.impact || '';
                document.getElementById('eventResponsible').value = userMeta.responsible || '';
                document.getElementById('eventRecoveryTime').value = userMeta.recoveryTime || '';
                document.getElementById('eventStatus').value = userMeta.status || 'Not Started';
                
                // Update button to show "Example" (both buttons)
                const toggleBtnView = document.getElementById('exampleDataToggleBtnView');
                if (toggleBtn) {
                    toggleBtn.textContent = 'üìã Example';
                    toggleBtn.style.background = 'var(--info)';
                }
                if (toggleBtnView) {
                    toggleBtnView.textContent = 'üìã Example';
                    toggleBtnView.style.background = 'var(--info)';
                }
            } else {
                // Currently showing user data - switch to example
                // If in view mode, get data from storage; otherwise get from fields
                if (isInViewMode) {
                    // In view mode - backup from storage
                    if (modalExampleBackup === null && !examplesMode) {
                        const storedResponse = getResponse(currentEventId);
                        modalExampleBackup = {
                            response: storedResponse || '',
                            metadata: getEventMetadata(currentEventId)
                        };
                    }
                } else {
                    // In interactive mode - backup from fields
                    if (modalExampleBackup === null && !examplesMode) {
                        const sections = {
                            immediateActions: document.getElementById('immediateActions').value,
                            communicationPlan: document.getElementById('communicationPlan').value,
                            recoveryProcedures: document.getElementById('recoveryProcedures').value,
                            rolesResponsibilities: document.getElementById('rolesResponsibilities').value,
                            resourcesNeeded: document.getElementById('resourcesNeeded').value
                        };
                        modalExampleBackup = {
                            response: combineResponseSections(sections),
                            metadata: {
                                priority: document.getElementById('eventPriority').value,
                                likelihood: document.getElementById('eventLikelihood').value,
                                impact: document.getElementById('eventImpact').value,
                                responsible: document.getElementById('eventResponsible').value,
                                recoveryTime: document.getElementById('eventRecoveryTime').value,
                                status: document.getElementById('eventStatus').value
                            }
                        };
                    }
                }
                
                // Parse and show example response in sections
                const exampleSections = parseResponseSections(exampleResponse);
                
                // Ensure we're in interactive mode before populating fields
                document.getElementById('responsePlanView').style.display = 'none';
                document.getElementById('responsePlanInteractive').style.display = 'block';
                
                // Populate fields with example data immediately
                const immediateActionsField = document.getElementById('immediateActions');
                const communicationPlanField = document.getElementById('communicationPlan');
                const recoveryProceduresField = document.getElementById('recoveryProcedures');
                const rolesResponsibilitiesField = document.getElementById('rolesResponsibilities');
                const resourcesNeededField = document.getElementById('resourcesNeeded');
                
                if (immediateActionsField) {
                    immediateActionsField.value = exampleSections.immediateActions || '';
                    immediateActionsField.readOnly = true;
                    immediateActionsField.style.fontStyle = 'italic';
                    immediateActionsField.style.color = '#666';
                    immediateActionsField.style.background = '#f5f5f5';
                }
                if (communicationPlanField) {
                    communicationPlanField.value = exampleSections.communicationPlan || '';
                    communicationPlanField.readOnly = true;
                    communicationPlanField.style.fontStyle = 'italic';
                    communicationPlanField.style.color = '#666';
                    communicationPlanField.style.background = '#f5f5f5';
                }
                if (recoveryProceduresField) {
                    recoveryProceduresField.value = exampleSections.recoveryProcedures || '';
                    recoveryProceduresField.readOnly = true;
                    recoveryProceduresField.style.fontStyle = 'italic';
                    recoveryProceduresField.style.color = '#666';
                    recoveryProceduresField.style.background = '#f5f5f5';
                }
                if (rolesResponsibilitiesField) {
                    rolesResponsibilitiesField.value = exampleSections.rolesResponsibilities || '';
                    rolesResponsibilitiesField.readOnly = true;
                    rolesResponsibilitiesField.style.fontStyle = 'italic';
                    rolesResponsibilitiesField.style.color = '#666';
                    rolesResponsibilitiesField.style.background = '#f5f5f5';
                }
                if (resourcesNeededField) {
                    resourcesNeededField.value = exampleSections.resourcesNeeded || '';
                    resourcesNeededField.readOnly = true;
                    resourcesNeededField.style.fontStyle = 'italic';
                    resourcesNeededField.style.color = '#666';
                    resourcesNeededField.style.background = '#f5f5f5';
                }
                
                // Show example metadata
                document.getElementById('eventPriority').value = exampleMeta.priority || '';
                document.getElementById('eventLikelihood').value = exampleMeta.likelihood || '';
                document.getElementById('eventImpact').value = exampleMeta.impact || '';
                document.getElementById('eventResponsible').value = exampleMeta.responsible || '';
                document.getElementById('eventRecoveryTime').value = exampleMeta.recoveryTime || '';
                document.getElementById('eventStatus').value = exampleMeta.status || 'Not Started';
                
                // Switch to interactive mode to show example data
                document.getElementById('responsePlanView').style.display = 'none';
                document.getElementById('responsePlanInteractive').style.display = 'block';
                document.getElementById('saveResponseBtn').style.display = 'none'; // Can't save examples
                
                // Update button to show "Your Data" (both buttons)
                const toggleBtnView = document.getElementById('exampleDataToggleBtnView');
                if (toggleBtn) {
                    toggleBtn.textContent = 'Your Data';
                    toggleBtn.style.background = '#28a745';
                }
                if (toggleBtnView) {
                    toggleBtnView.textContent = 'Your Data';
                    toggleBtnView.style.background = '#28a745';
                }
            }
        }
        
        function getResponseFromBackup(eventId) {
            if (!userDataBackup) return '';
            const parts = eventId.split('.');
            let data = userDataBackup;
            for (let part of parts) {
                if (data[part] !== undefined) {
                    data = data[part];
                } else {
                    return '';
                }
            }
            return typeof data === 'string' ? data : '';
        }

        function closeResponseModal(event) {
            if (!event || event.target.id === 'responseModal' || event.target.classList.contains('response-modal-close')) {
                document.getElementById('responseModal').classList.remove('show');
                currentEventId = null;
            }
        }

        function saveResponse() {
            if (!currentEventId) return;
            
            // Combine sections into formatted response
            const sections = {
                immediateActions: document.getElementById('immediateActions').value,
                communicationPlan: document.getElementById('communicationPlan').value,
                recoveryProcedures: document.getElementById('recoveryProcedures').value,
                rolesResponsibilities: document.getElementById('rolesResponsibilities').value,
                resourcesNeeded: document.getElementById('resourcesNeeded').value
            };
            
            const response = combineResponseSections(sections);
            setResponse(currentEventId, response);
            
            // Save metadata
            const metadata = {
                priority: document.getElementById('eventPriority').value,
                likelihood: document.getElementById('eventLikelihood').value,
                impact: document.getElementById('eventImpact').value,
                responsible: document.getElementById('eventResponsible').value,
                recoveryTime: document.getElementById('eventRecoveryTime').value,
                status: document.getElementById('eventStatus').value
            };
            setEventMetadata(currentEventId, metadata);
            
            saveData();
            saveMetadata();
            
            // Switch to view mode after saving
            switchToViewMode();
            
            showSaveIndicator();
            
            // Don't close modal - stay in view mode
            // Refresh the subcategory view to show updated response status
            // Make sure it stays on the events list (subcategory view)
            if (currentOpenSubcategory) {
                const [categoryType, subcategoryIndex] = currentOpenSubcategory.split('-');
                const category = categoryData[categoryType];
                if (category && category.subcategories[parseInt(subcategoryIndex)]) {
                    const subcategory = category.subcategories[parseInt(subcategoryIndex)];
                    const detailSection = document.getElementById('subcategoryDetailSection');
                    if (detailSection) {
                        // Ensure the section stays expanded
                        detailSection.classList.add('expanded');
                        detailSection.innerHTML = generateSubcategoryFlowchartHTML(categoryType, subcategory, parseInt(subcategoryIndex));
                        setTimeout(() => {
                            drawSubcategoryFlowchartLines(parseInt(subcategoryIndex));
                        }, 50);
                    }
                }
            } else {
                // If no subcategory is open, just update categories
                updateCategories();
            }
        }

        function updateCategories() {
            initCategories();
            // Also update the detail section if it's open
            if (currentOpenCategory) {
                const category = categoryData[currentOpenCategory];
                const categoryFlowchart = document.getElementById('categoryFlowchart');
                if (categoryFlowchart) {
                    categoryFlowchart.innerHTML = generateCategoryFlowchartHTML(currentOpenCategory, category);
                    // Redraw lines
                    setTimeout(() => {
                        drawCategoryToSubcategoryLines();
                    }, 50);
                }
            }
            // Also update subcategory if open - keep it expanded
            if (currentOpenSubcategory) {
                const [categoryType, subcategoryIndex] = currentOpenSubcategory.split('-');
                const category = categoryData[categoryType];
                if (category && category.subcategories[parseInt(subcategoryIndex)]) {
                    const subcategory = category.subcategories[parseInt(subcategoryIndex)];
                    const detailSection = document.getElementById('subcategoryDetailSection');
                    if (detailSection) {
                        // Keep the section expanded
                        detailSection.classList.add('expanded');
                        detailSection.innerHTML = generateSubcategoryFlowchartHTML(categoryType, subcategory, parseInt(subcategoryIndex));
                        // Redraw lines
                        setTimeout(() => {
                            drawSubcategoryFlowchartLines(parseInt(subcategoryIndex));
                        }, 50);
                    }
                }
            }
        }

        // Add event to subcategory
        function addEventToSubcategory(categoryType, subcategoryIndex) {
            const eventName = prompt('Enter the name of the new event:');
            if (!eventName || !eventName.trim()) return;
            
            const category = categoryData[categoryType];
            if (!category || !category.subcategories[subcategoryIndex]) return;
            
            const subcategory = category.subcategories[subcategoryIndex];
            const subcategoryKey = subcategory.subcategory || categoryType;
            
            // Generate a unique ID for the new event
            const eventId = generateEventId(categoryType, subcategoryKey, eventName.trim());
            
            // Add event to categoryData
            const newEvent = {
                id: eventId,
                name: eventName.trim()
            };
            subcategory.events.push(newEvent);
            
            // Initialize empty response in contingencyData
            // Ensure the structure exists
            const eventIdParts = eventId.split('.');
            let data = contingencyData;
            for (let i = 0; i < eventIdParts.length - 1; i++) {
                if (!data[eventIdParts[i]]) {
                    data[eventIdParts[i]] = {};
                }
                data = data[eventIdParts[i]];
            }
            data[eventIdParts[eventIdParts.length - 1]] = '';
            
            // Save and refresh
            saveData();
            saveCategoryData();
            showSaveIndicator();
            
            // Refresh the subcategory view
            const detailSection = document.getElementById('subcategoryDetailSection');
            if (detailSection) {
                detailSection.innerHTML = generateSubcategoryFlowchartHTML(categoryType, subcategory, subcategoryIndex);
                setTimeout(() => {
                    drawSubcategoryFlowchartLines(subcategoryIndex);
                }, 50);
            }
        }

        // Delete event from subcategory
        function deleteEventFromSubcategory(categoryType, subcategoryIndex, eventIndex) {
            const category = categoryData[categoryType];
            if (!category || !category.subcategories[subcategoryIndex]) return;
            
            const subcategory = category.subcategories[subcategoryIndex];
            const event = subcategory.events[eventIndex];
            
            if (!event) return;
            
            if (!confirm(`Are you sure you want to delete "${event.name}"? This will also delete its response plan.`)) {
                return;
            }
            
            // Remove from categoryData
            subcategory.events.splice(eventIndex, 1);
            
            // Remove from contingencyData
            const eventIdParts = event.id.split('.');
            let data = contingencyData;
            for (let i = 0; i < eventIdParts.length - 1; i++) {
                if (data[eventIdParts[i]]) {
                    data = data[eventIdParts[i]];
                } else {
                    break;
                }
            }
            if (data[eventIdParts[eventIdParts.length - 1]] !== undefined) {
                delete data[eventIdParts[eventIdParts.length - 1]];
            }
            
            // Remove metadata
            if (eventMetadata[event.id]) {
                delete eventMetadata[event.id];
            }
            
            // Save and refresh
            saveData();
            saveMetadata();
            saveCategoryData();
            showSaveIndicator();
            
            // Refresh the subcategory view
            const detailSection = document.getElementById('subcategoryDetailSection');
            if (detailSection) {
                detailSection.innerHTML = generateSubcategoryFlowchartHTML(categoryType, subcategory, subcategoryIndex);
                setTimeout(() => {
                    drawSubcategoryFlowchartLines(subcategoryIndex);
                }, 50);
            }
        }

        // Generate unique category key
        function generateCategoryKey(categoryTitle) {
            // Convert to camelCase for the key
            return categoryTitle.toLowerCase().replace(/[^a-z0-9]+/g, '');
        }
        
        // Generate unique category type (for categoryData keys)
        function generateCategoryType(categoryTitle) {
            // Create a short unique type identifier
            const base = categoryTitle.toLowerCase().replace(/[^a-z0-9]+/g, '').substring(0, 10);
            let counter = 1;
            let type = base;
            while (categoryData[type]) {
                type = base + counter;
                counter++;
            }
            return type;
        }
        
        // Generate unique event ID
        function generateEventId(categoryType, subcategoryKey, eventName) {
            // Convert to camelCase for the ID
            const cleanName = eventName.toLowerCase().replace(/[^a-z0-9]+/g, '');
            
            // Get category key from categoryData
            const category = categoryData[categoryType];
            let categoryKey = categoryType;
            if (category) {
                // Try to find the matching key in contingencyData structure
                const categoryTitle = category.title.toLowerCase().replace(/[^a-z0-9]+/g, '');
                // Map common categories
                const categoryMap = {
                    'naturalhazards': 'naturalHazards',
                    'humancausedevents': 'humanCaused',
                    'technologicalissue': 'technological'
                };
                categoryKey = categoryMap[categoryTitle] || categoryTitle;
            }
            
            const subcategoryKeyClean = subcategoryKey ? subcategoryKey.toLowerCase().replace(/[^a-z0-9]+/g, '') : '';
            
            return subcategoryKeyClean ? `${categoryKey}.${subcategoryKeyClean}.${cleanName}` : `${categoryKey}.${cleanName}`;
        }
        
        // Add new category
        function addCategory() {
            // Show the category selection modal
            showCategorySelectModal();
        }

        function showCategorySelectModal() {
            const modal = document.getElementById('categorySelectModal');
            const list = document.getElementById('categorySelectList');
            
            // Clear previous list
            list.innerHTML = '';
            
            // Get currently added categories
            const addedCategories = Object.keys(categoryData);
            
            // Add "Blank Category" option first
            const blankItem = document.createElement('div');
            blankItem.className = 'category-select-item';
            blankItem.style.border = '2px dashed var(--primary-color)';
            blankItem.onclick = () => createBlankCategory();
            
            const blankTitle = document.createElement('div');
            blankTitle.className = 'category-select-item-title';
            blankTitle.textContent = '‚ûï Create Custom Category';
            blankTitle.style.color = 'var(--primary-color)';
            
            const blankSubtitle = document.createElement('div');
            blankSubtitle.className = 'category-select-item-subtitle';
            blankSubtitle.textContent = 'Start with a blank category and build it yourself';
            blankSubtitle.style.color = 'var(--text-secondary)';
            
            blankItem.appendChild(blankTitle);
            blankItem.appendChild(blankSubtitle);
            list.appendChild(blankItem);
            
            // Add separator
            const separator = document.createElement('div');
            separator.style.height = '1px';
            separator.style.background = 'var(--bg-tertiary)';
            separator.style.margin = '20px 0';
            list.appendChild(separator);
            
            // Add header for library categories
            const header = document.createElement('div');
            header.style.fontWeight = '600';
            header.style.color = 'var(--text-secondary)';
            header.style.marginBottom = '12px';
            header.style.fontSize = '0.9em';
            header.textContent = 'Or select from predefined categories:';
            list.appendChild(header);
            
            // Populate list with all available categories from library
            Object.keys(categoryLibrary).forEach(categoryType => {
                const category = categoryLibrary[categoryType];
                const isAdded = addedCategories.includes(categoryType);
                
                const item = document.createElement('div');
                item.className = `category-select-item ${isAdded ? 'disabled' : ''}`;
                item.onclick = isAdded ? null : () => selectCategoryFromLibrary(categoryType);
                
                const title = document.createElement('div');
                title.className = 'category-select-item-title';
                title.textContent = category.title;
                
                const subtitle = document.createElement('div');
                subtitle.className = 'category-select-item-subtitle';
                const subcategoryCount = category.subcategories.length;
                const eventCount = category.subcategories.reduce((sum, sub) => sum + (sub.events ? sub.events.length : 0), 0);
                subtitle.textContent = `${subcategoryCount} subcategories, ${eventCount} events${isAdded ? ' (Already Added)' : ''}`;
                
                item.appendChild(title);
                item.appendChild(subtitle);
                list.appendChild(item);
            });
            
            modal.classList.add('show');
        }

        function closeCategorySelectModal(event) {
            if (!event || event.target.id === 'categorySelectModal' || event.target.classList.contains('response-modal-close')) {
                document.getElementById('categorySelectModal').classList.remove('show');
            }
        }

        function createBlankCategory() {
            // Close modal first
            closeCategorySelectModal();
            
            // Prompt for category name
            const categoryTitle = prompt('Enter the name of your custom category:');
            if (!categoryTitle || !categoryTitle.trim()) return;
            
            const categoryType = generateCategoryType(categoryTitle.trim());
            
            // Check if category type already exists
            if (categoryData[categoryType]) {
                alert('A category with a similar name already exists. Please choose a different name.');
                return;
            }
            
            // Create blank category structure
            categoryData[categoryType] = {
                title: categoryTitle.trim(),
                subcategories: []
            };
            
            // Save and refresh
            saveCategoryData();
            saveData();
            showSaveIndicator();
            
            // Refresh main view
            updateCategories();
        }

        function selectCategoryFromLibrary(categoryType) {
            const category = categoryLibrary[categoryType];
            if (!category) return;
            
            // Deep clone the category structure
            const categoryClone = JSON.parse(JSON.stringify(category));
            
            // Add to categoryData
            categoryData[categoryType] = categoryClone;
            
            // Initialize contingencyData structure for all events
            categoryClone.subcategories.forEach(subcategory => {
                if (subcategory.events) {
                    subcategory.events.forEach(event => {
                        const eventId = event.id;
                        if (!contingencyData[eventId]) {
                            contingencyData[eventId] = '';
                        }
                        // Initialize empty metadata for new events
                        if (!eventMetadata[eventId]) {
                            eventMetadata[eventId] = {
                                priority: '',
                                likelihood: '',
                                impact: '',
                                responsible: '',
                                recoveryTime: '',
                                status: 'Not Started'
                            };
                        }
                    });
                }
            });
            
            // Save and refresh
            saveCategoryData();
            saveData();
            saveMetadata();
            showSaveIndicator();
            
            // Close modal
            closeCategorySelectModal();
            
            // Refresh main view
            updateCategories();
        }
        
        // Delete category
        function deleteCategory(categoryType) {
            const category = categoryData[categoryType];
            if (!category) return;
            
            // Count events in this category
            let totalEvents = 0;
            category.subcategories.forEach(sub => {
                totalEvents += sub.events.length;
            });
            
            if (!confirm(`Are you sure you want to delete "${category.title}"? This will delete ${totalEvents} event(s) and all their response plans.`)) {
                return;
            }
            
            // Delete all events and their data
            category.subcategories.forEach(subcategory => {
                subcategory.events.forEach(event => {
                    // Remove from contingencyData
                    const eventIdParts = event.id.split('.');
                    let data = contingencyData;
                    for (let i = 0; i < eventIdParts.length - 1; i++) {
                        if (data[eventIdParts[i]]) {
                            data = data[eventIdParts[i]];
                        } else {
                            break;
                        }
                    }
                    if (data[eventIdParts[eventIdParts.length - 1]] !== undefined) {
                        delete data[eventIdParts[eventIdParts.length - 1]];
                    }
                    
                    // Remove metadata
                    if (eventMetadata[event.id]) {
                        delete eventMetadata[event.id];
                    }
                });
            });
            
            // Remove category from categoryData
            delete categoryData[categoryType];
            
            // Remove category from contingencyData
            const categoryKey = generateCategoryKey(category.title);
            if (contingencyData[categoryKey]) {
                delete contingencyData[categoryKey];
            }
            
            // Close category if it's open
            if (currentOpenCategory === categoryType) {
                currentOpenCategory = null;
                const detailSection = document.getElementById('categoryDetailSection');
                if (detailSection) {
                    detailSection.classList.remove('expanded');
                }
            }
            
            // Save and refresh
            saveCategoryData();
            saveData();
            saveMetadata();
            showSaveIndicator();
            
            // Refresh main view
            updateCategories();
        }
        
        // Add new subcategory
        function addSubcategory(categoryType) {
            const subcategoryName = prompt('Enter the name of the new subcategory:');
            if (!subcategoryName || !subcategoryName.trim()) return;
            
            const category = categoryData[categoryType];
            if (!category) return;
            
            // Add subcategory to categoryData
            category.subcategories.push({
                subcategory: subcategoryName.trim(),
                events: []
            });
            
            // Save and refresh
            saveCategoryData();
            showSaveIndicator();
            
            // Refresh category view if it's open
            if (currentOpenCategory === categoryType) {
                const flowchartContainer = document.getElementById('categoryFlowchart');
                if (flowchartContainer) {
                    flowchartContainer.innerHTML = generateCategoryFlowchartHTML(categoryType, category);
                    setTimeout(() => {
                        drawCategoryToSubcategoryLines();
                    }, 50);
                }
            }
        }
        
        // Delete subcategory
        function deleteSubcategory(categoryType, subcategoryIndex) {
            const category = categoryData[categoryType];
            if (!category || !category.subcategories[subcategoryIndex]) return;
            
            const subcategory = category.subcategories[subcategoryIndex];
            const subcategoryName = subcategory.subcategory || 'this subcategory';
            
            // Count events in this subcategory
            const eventCount = subcategory.events.length;
            
            if (!confirm(`Are you sure you want to delete "${subcategoryName}"? This will delete ${eventCount} event(s) and all their response plans.`)) {
                return;
            }
            
            // Delete all events and their data
            subcategory.events.forEach(event => {
                // Remove from contingencyData
                const eventIdParts = event.id.split('.');
                let data = contingencyData;
                for (let i = 0; i < eventIdParts.length - 1; i++) {
                    if (data[eventIdParts[i]]) {
                        data = data[eventIdParts[i]];
                    } else {
                        break;
                    }
                }
                if (data[eventIdParts[eventIdParts.length - 1]] !== undefined) {
                    delete data[eventIdParts[eventIdParts.length - 1]];
                }
                
                // Remove metadata
                if (eventMetadata[event.id]) {
                    delete eventMetadata[event.id];
                }
            });
            
            // Remove subcategory from categoryData
            category.subcategories.splice(subcategoryIndex, 1);
            
            // Close subcategory if it's open
            if (currentOpenSubcategory) {
                const [openCategoryType, openSubcategoryIndex] = currentOpenSubcategory.split('-');
                if (openCategoryType === categoryType && parseInt(openSubcategoryIndex) === subcategoryIndex) {
                    currentOpenSubcategory = null;
                    const detailSection = document.getElementById('subcategoryDetailSection');
                    if (detailSection) {
                        detailSection.classList.remove('expanded');
                    }
                }
            }
            
            // Save and refresh
            saveCategoryData();
            saveData();
            saveMetadata();
            showSaveIndicator();
            
            // Refresh category view if it's open
            if (currentOpenCategory === categoryType) {
                const flowchartContainer = document.getElementById('categoryFlowchart');
                if (flowchartContainer) {
                    flowchartContainer.innerHTML = generateCategoryFlowchartHTML(categoryType, category);
                    setTimeout(() => {
                        drawCategoryToSubcategoryLines();
                    }, 50);
                }
            }
        }

        // Save categoryData (custom events structure)
        function saveCategoryData() {
            const username = getCurrentUsername();
            if (!username) return;
            
            try {
                const storageKey = 'contingencyCategoryData_' + username;
                localStorage.setItem(storageKey, JSON.stringify(categoryData));
            } catch (e) {
                console.log('Could not save category data');
            }
        }

        // Load categoryData (custom events, categories, and subcategories structure)
        function loadCategoryData() {
            const username = getCurrentUsername();
            if (!username) return;
            
            try {
                const storageKey = 'contingencyCategoryData_' + username;
                const saved = localStorage.getItem(storageKey);
                if (saved) {
                    const loaded = JSON.parse(saved);
                    // If loaded data has categories, merge them
                    // Otherwise, merge custom events into default structure
                    Object.keys(loaded).forEach(categoryType => {
                        if (categoryData[categoryType] && loaded[categoryType].subcategories) {
                            // Merge subcategories and events
                            categoryData[categoryType].subcategories = loaded[categoryType].subcategories;
                        } else if (!categoryData[categoryType]) {
                            // New category that doesn't exist in defaults
                            categoryData[categoryType] = loaded[categoryType];
                        }
                    });
                }
            } catch (e) {
                console.log('Could not load category data');
            }
        }

        // Auto-save functionality
        function saveData() {
            const username = getCurrentUsername();
            if (!username) return;
            
            try {
                const storageKey = 'contingencyPlanData_' + username;
                localStorage.setItem(storageKey, JSON.stringify(contingencyData));
            } catch (e) {
                console.log('Could not save data');
            }
        }
        
        function saveMetadata() {
            const username = getCurrentUsername();
            if (!username) return;
            
            try {
                const storageKey = 'contingencyPlanMetadata_' + username;
                localStorage.setItem(storageKey, JSON.stringify(eventMetadata));
            } catch (e) {
                console.log('Could not save metadata');
            }
        }

        // Import functionality
        function triggerImportWordExport() {
            var input = document.getElementById('importWordExportInput');
            if (!input) return;
            input.value = '';
            input.click();
        }

        // Hook up import input change
        try {
            var __importInput = document.getElementById('importWordExportInput');
            if (__importInput) {
                __importInput.addEventListener('change', function(e) {
                    var file = e.target.files && e.target.files[0];
                    if (file) importContingencyPlanFromWordExport(file);
                });
            }
        } catch (e) { /* ignore */ }

        function importContingencyPlanFromWordExport(file) {
            if (!file) return;
            if (!confirm('This will replace your current Contingency Plan with the contents of the uploaded export. Continue?')) {
                return;
            }

            var reader = new FileReader();
            reader.onerror = function() {
                alert('Could not read the file. Please try again.');
            };
            reader.onload = function() {
                try {
                    var buf = reader.result;
                    var bytes = new Uint8Array(buf);
                    // Detect real DOCX zip (PK..). We cannot parse zipped OOXML without a library.
                    if (bytes && bytes.length >= 2 && bytes[0] === 0x50 && bytes[1] === 0x4B) {
                        alert('That looks like a standard Word .docx (zipped) file. This importer supports the Word export generated by this app (HTML in a .doc/.docx). Please upload the file you downloaded from the Export button in this app.');
                        return;
                    }

                    var text = new TextDecoder('utf-8', { fatal: false }).decode(bytes);
                    // Basic sanity check that it's our exported HTML
                    if (text.indexOf('CONTINGENCY PLAN') === -1 || text.indexOf('class="meta"') === -1) {
                        alert('This file does not look like a Contingency Plan export from this app. Please export using "Export as Word" and upload that file.');
                        return;
                    }

                    var imported = parseContingencyPlanFromExportHtml(text);
                    if (!imported) {
                        alert('Could not parse the uploaded export. Please try re-exporting and importing again.');
                        return;
                    }

                    // Apply imported data
                    contingencyData = imported.data;
                    eventMetadata = imported.metadata;
                    renderEvents();
                    saveData();
                    saveMetadata();
                    alert('‚úÖ Imported your Contingency Plan from the Word export.');
                } catch (err) {
                    console.error(err);
                    alert('Import failed. Please try again with a fresh export from this app.');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function parseContingencyPlanFromExportHtml(htmlText) {
            var doc;
            try {
                doc = new DOMParser().parseFromString(htmlText, 'text/html');
            } catch (e) {
                return null;
            }
            if (!doc) return null;

            function norm(s) {
                if (!s) return '';
                return String(s)
                    .replace(/\r\n/g, '\n')
                    .replace(/\r/g, '\n')
                    .replace(/[ \t]+\n/g, '\n')
                    .replace(/\n{3,}/g, '\n\n')
                    .trim();
            }

            function textOf(el) {
                if (!el) return '';
                return norm(el.innerText || el.textContent || '');
            }

            // Initialize empty contingency data structure
            var importedData = {};
            var importedMetadata = {};

            // Find all event sections (h2 elements)
            var eventSections = doc.querySelectorAll('h2');
            for (var i = 0; i < eventSections.length; i++) {
                var eventTitle = norm(eventSections[i].textContent || '');
                if (eventTitle && eventTitle !== 'CONTINGENCY PLAN' && eventTitle !== 'CONTINGENCY EVENTS') {
                    var eventId = 'event_' + Date.now().toString() + Math.random().toString(16).slice(2);

                    // Find the content after this h2
                    var current = eventSections[i];
                    var eventData = {
                        response: '',
                        procedures: '',
                        resources: '',
                        timeline: '',
                        owner: ''
                    };

                    while (current = current.nextElementSibling) {
                        if (current.tagName === 'H2') break; // Stop at next event

                        if (current.tagName === 'H3') {
                            var subsectionTitle = norm(current.textContent || '');
                            // Find the next P for the subsection content
                            var nextP = current;
                            while (nextP = nextP.nextElementSibling) {
                                if (nextP.tagName === 'P') {
                                    var content = textOf(nextP);
                                    if (subsectionTitle === 'Immediate Response Actions') {
                                        eventData.response = content;
                                    } else if (subsectionTitle === 'Recovery Procedures') {
                                        eventData.procedures = content;
                                    } else if (subsectionTitle === 'Required Resources') {
                                        eventData.resources = content;
                                    } else if (subsectionTitle === 'Timeline') {
                                        eventData.timeline = content;
                                    } else if (subsectionTitle === 'Owner') {
                                        eventData.owner = content;
                                    }
                                    break;
                                }
                                if (nextP.tagName === 'H2' || nextP.tagName === 'H3') break;
                            }
                        }
                    }

                    importedData[eventId] = eventData;
                    importedMetadata[eventId] = {
                        title: eventTitle,
                        category: 'Other', // Default category
                        probability: 'Medium',
                        impact: 'Medium'
                    };
                }
            }

            return { data: importedData, metadata: importedMetadata };
        }

        function loadSavedData() {
            const username = getCurrentUsername();
            if (!username) return;
            
            try {
                const storageKey = 'contingencyPlanData_' + username;
                const saved = localStorage.getItem(storageKey);
                if (saved) {
                    contingencyData = JSON.parse(saved);
                }
                
                // Load metadata
                const metadataKey = 'contingencyPlanMetadata_' + username;
                const savedMetadata = localStorage.getItem(metadataKey);
                if (savedMetadata) {
                    eventMetadata = JSON.parse(savedMetadata);
                }
                
                // Also load custom events
                loadCategoryData();
                updateCategories();
            } catch (e) {
                console.log('Could not load saved data');
            }
        }

        function getCurrentUsername() {
            try {
                const session = sessionStorage.getItem('prototype_userSession');
                if (session) {
                    const sessionData = JSON.parse(session);
                    return sessionData.user ? sessionData.user.username : null;
                }
            } catch (e) {
                return null;
            }
            return null;
        }

        // Premium gate: require login (Strategic Planning is the only free tool)
        (function requireLoginForPremium() {
            if (!getCurrentUsername()) {
                const page = window.location.pathname.split('/').pop() + window.location.search + window.location.hash;
                window.location.replace('prototypes_home.html?action=login&return=' + encodeURIComponent(page));
            }
        })();

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        // Education functions
        function toggleEducation(btn) {
            const content = btn.parentElement.nextElementSibling;
            content.classList.toggle('collapsed');
            btn.textContent = content.classList.contains('collapsed') ? '+' : '‚àí';
        }

        function toggleHelp(btn) {
            const helpText = btn.parentElement.nextElementSibling;
            helpText.style.display = helpText.style.display === 'none' ? 'block' : 'none';
        }

        function toggleVideoSection(header) {
            const videoSection = header.closest('.video-link-section');
            if (videoSection) {
                videoSection.classList.toggle('collapsed');
                const toggleBtn = header.querySelector('.video-toggle-btn');
                if (toggleBtn) {
                    toggleBtn.textContent = videoSection.classList.contains('collapsed') ? '+' : '‚àí';
                }
            }
        }

        // Learn Menu
        function showLearnMenu() {
            document.getElementById('learnModal').classList.add('show');
        }

        function closeLearnMenu(event) {
            if (!event || event.target.id === 'learnModal' || event.target.classList.contains('response-modal-close')) {
                document.getElementById('learnModal').classList.remove('show');
                hideLearnContent();
            }
        }

        // Video Links for Educational Content (HBR prioritized, with basic options)
        const videoLinks = {
            'what-is-contingency': {
                url: 'https://www.youtube.com/watch?v=yDVcw9kDRTs',
                description: 'Learn the fundamentals of contingency planning and how to create effective business continuity plans.',
                hbrCreator: 'Online PM Courses - Mike Clayton',
                basicUrl: 'https://www.youtube.com/watch?v=3Q5ZfpjZ3tY',
                basicDescription: 'Basic Tutorial: Learn the fundamentals of contingency planning and how to create effective business continuity plans - perfect for beginners.',
                basicCreator: 'B2U - Business To You'
            },
            'risk-assessment': {
                url: 'https://www.youtube.com/watch?v=iuYlGRnC7J8',
                description: 'Harvard Business Review: Learn strategic approaches to risk assessment and management.',
                hbrCreator: 'Harvard Business Review',
                basicUrl: 'https://www.youtube.com/watch?v=xjOUe107mk8',
                basicDescription: 'Basic Tutorial: Watch this tutorial on conducting comprehensive risk assessments to identify and prioritize potential threats.',
                basicCreator: 'GreggU'
            },
            'response-structure': {
                url: 'https://www.youtube.com/watch?v=iuYlGRnC7J8',
                description: 'Harvard Business Review: Strategic insights on structuring effective response plans and execution strategies.',
                hbrCreator: 'Harvard Business Review',
                basicUrl: 'https://www.youtube.com/watch?v=HQ6348u6o08',
                basicDescription: 'Basic Tutorial: Learn how to structure effective response plans with clear actions, communication, and recovery procedures.',
                basicCreator: 'GreggU'
            }
        };

        // Helper function to render video link (HBR prioritized, with basic option)
        function renderVideoLink(contentKey) {
            const video = videoLinks[contentKey];
            if (!video) return '';

            const creator = (video.hbrCreator || video.creator || '').toString();
            const isHbr = creator.toLowerCase().includes('harvard business review');
            const headerLabel = isHbr ? 'üéì Harvard Business Review (Recommended):' : 'üéì Recommended Video:';
            const buttonLabel = isHbr ? 'Watch HBR Video' : 'Watch Video';
            const creditLabel = creator || (isHbr ? 'Harvard Business Review' : 'YouTube Creator');
            const desc = isHbr ? (video.description || '') : String(video.description || '').replace(/^Harvard Business Review:\s*/i, '');
            
            let html = `
                <div class="video-link-section collapsible collapsed">
                    <div class="video-link-header" onclick="toggleVideoSection(this)">
                        <h4>
                            <span>üìπ</span> Video Tutorials
                        </h4>
                        <button class="video-toggle-btn" aria-label="Toggle video section">+</button>
                    </div>
                    <div class="video-link-content">
                    <div style="margin-bottom: 15px;">
                        <p style="color: var(--text-secondary); margin-bottom: 8px; font-size: 0.95em; font-weight: 600;">${headerLabel}</p>
                        <p style="color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9em;">${desc}</p>
                        <a href="${video.url}" target="_blank" rel="noopener noreferrer" 
                           class="video-link-btn" 
                           style="display: inline-flex; align-items: center; gap: 8px; background: #FF0000; color: white; padding: 12px 20px; border-radius: var(--radius-full); text-decoration: none; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(255, 0, 0, 0.3); margin-bottom: 10px;">
                            <span>‚ñ∂Ô∏è</span> ${buttonLabel}
                        </a>
                        <div style="margin-top: 8px; font-size: 0.8em; color: var(--text-tertiary); font-style: italic;">
                            <p style="margin: 0;"><strong>Video Credit:</strong> ${creditLabel}</p>
                        </div>
                    </div>`;
            
            // Add basic video if available
            if (video.basicUrl) {
                html += `
                    <div style="padding-top: 15px; border-top: 1px solid rgba(0,0,0,0.1);">
                        <p style="color: var(--text-secondary); margin-bottom: 8px; font-size: 0.95em; font-weight: 600;">üìö Basic Tutorial (For Beginners):</p>
                        <p style="color: var(--text-secondary); margin-bottom: 12px; font-size: 0.9em;">${video.basicDescription}</p>
                        <a href="${video.basicUrl}" target="_blank" rel="noopener noreferrer" 
                           class="video-link-btn" 
                           style="display: inline-flex; align-items: center; gap: 8px; background: #6B7280; color: white; padding: 12px 20px; border-radius: var(--radius-full); text-decoration: none; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(107, 114, 128, 0.3); margin-bottom: 10px;">
                            <span>‚ñ∂Ô∏è</span> Watch Basic Tutorial
                        </a>
                        <div style="margin-top: 8px; font-size: 0.8em; color: var(--text-tertiary); font-style: italic;">
                            <p style="margin: 0;"><strong>Video Credit:</strong> ${video.basicCreator || 'YouTube Creator'}</p>
                        </div>
                    </div>`;
            }
            
            html += `
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,0,0,0.1); font-size: 0.75em; color: var(--text-tertiary); font-style: italic;">
                        <p style="margin: 0;">This is an external link to a YouTube video. We do not own this content; it is linked for educational purposes only. Content is subject to YouTube's terms and may change or be removed by the original creator.</p>
                    </div>
                    </div>
                </div>`;
            return html;
        }

        function showLearnContent(topic) {
            const display = document.getElementById('learnContentDisplay');
            const content = document.getElementById('learnContentText');
            
            const learnContent = {
                'what-is-contingency': {
                    title: 'What is a Contingency Plan?',
                    text: '<h3>What is a Contingency Plan?</h3><p>A contingency plan is a proactive strategy that outlines procedures and actions to take in response to potential future events or disruptions. It ensures that an organization can maintain or quickly resume critical functions when unexpected situations occur.</p><p><strong>Key Components:</strong></p><ul><li>Risk identification and assessment</li><li>Response strategies for each identified risk</li><li>Communication protocols</li><li>Recovery procedures</li><li>Roles and responsibilities</li></ul>'
                },
                'why-important': {
                    title: 'Why is Contingency Planning Important?',
                    text: '<h3>Why is Contingency Planning Important?</h3><p>Contingency planning is essential for business resilience and continuity. It helps organizations:</p><ul><li><strong>Minimize Downtime:</strong> Quick response reduces operational interruptions</li><li><strong>Protect Assets:</strong> Safeguards physical and digital assets</li><li><strong>Ensure Safety:</strong> Protects employees, customers, and stakeholders</li><li><strong>Maintain Reputation:</strong> Demonstrates preparedness and professionalism</li><li><strong>Meet Compliance:</strong> Fulfills regulatory and industry requirements</li><li><strong>Reduce Financial Impact:</strong> Limits losses from disruptions</li></ul>'
                },
                'risk-assessment': {
                    title: 'How to Conduct a Risk Assessment',
                    text: '<h3>How to Conduct a Risk Assessment</h3><p>A thorough risk assessment is the foundation of effective contingency planning:</p><p><strong>Step 1: Identify Risks</strong><br>List all potential threats that could disrupt your operations. Consider natural disasters, human errors, technological failures, and external factors.</p><p><strong>Step 2: Evaluate Likelihood</strong><br>Assess how likely each risk is to occur. Consider your location, industry, and historical data.</p><p><strong>Step 3: Assess Impact</strong><br>Determine the potential impact of each risk on your operations, finances, reputation, and stakeholders.</p><p><strong>Step 4: Prioritize</strong><br>Rank risks based on both likelihood and impact. Focus planning efforts on high-priority risks first.</p>'
                },
                'natural-hazards': {
                    title: 'Natural Hazards',
                    text: '<h3>Natural Hazards</h3><p>Natural hazards are environmental events that can disrupt business operations:</p><p><strong>Geological Hazards:</strong></p><ul><li><strong>Landslides:</strong> Ground movement that can damage infrastructure</li><li><strong>Earthquakes:</strong> Seismic activity that can cause structural damage</li><li><strong>Volcanoes:</strong> Volcanic activity affecting air quality and infrastructure</li></ul><p><strong>Meteorological Hazards:</strong></p><ul><li><strong>Floods:</strong> Water damage and access issues</li><li><strong>Extreme Temperatures:</strong> Heat waves or cold snaps affecting operations</li><li><strong>Snow/Ice:</strong> Transportation and access problems</li><li><strong>Lightning:</strong> Power outages and fire risks</li><li><strong>Dust Storms:</strong> Visibility and air quality issues</li></ul>'
                },
                'human-caused': {
                    title: 'Human-Caused Events',
                    text: '<h3>Human-Caused Events</h3><p>Events caused by human action, either accidental or intentional:</p><p><strong>Accidental Events:</strong></p><ul><li><strong>Fire:</strong> Most common workplace emergency, can cause significant damage</li><li><strong>Building Collapse:</strong> Structural failures requiring evacuation</li><li><strong>Hazardous Material Spills:</strong> Chemical or biological contamination risks</li></ul><p><strong>Intentional Events:</strong></p><ul><li><strong>Workplace Violence:</strong> Threats to employee safety requiring security protocols</li><li><strong>Protests:</strong> Civil unrest affecting access and operations</li></ul><p>These events require clear security protocols and communication plans.</p>'
                },
                'technological': {
                    title: 'Technological Issues',
                    text: '<h3>Technological Issues</h3><p>Technology-related disruptions that can halt operations:</p><p><strong>Infrastructure Failure:</strong></p><ul><li>Power outages</li><li>Network failures</li><li>Equipment breakdowns</li><li>Water/sewer system failures</li></ul><p><strong>Cyber Security:</strong></p><ul><li>Data breaches</li><li>Ransomware attacks</li><li>System intrusions</li><li>Denial of service attacks</li></ul><p>These require backup systems, data protection protocols, and IT security measures.</p>'
                },
                'response-structure': {
                    title: 'Response Plan Structure',
                    text: '<h3>Response Plan Structure</h3><p>Each response plan should include:</p><p><strong>1. Immediate Actions</strong><br>First steps to take when the event occurs. This might include evacuation, securing the area, or activating emergency protocols.</p><p><strong>2. Communication Plan</strong><br>Who to contact, how to reach them, and what information to share. Include internal staff, emergency services, customers, and stakeholders.</p><p><strong>3. Recovery Procedures</strong><br>Steps to restore normal operations. Include timelines, required resources, and checkpoints.</p><p><strong>4. Roles and Responsibilities</strong><br>Clearly define who is responsible for each action. Assign backup personnel for key roles.</p><p><strong>5. Resources Needed</strong><br>List equipment, supplies, personnel, and external support required.</p>'
                },
                'communication': {
                    title: 'Communication Protocols',
                    text: '<h3>Communication Protocols</h3><p>Effective communication is critical during emergencies:</p><p><strong>Internal Communication:</strong></p><ul><li>Establish a chain of command</li><li>Use multiple communication channels (phone, email, text, radio)</li><li>Designate spokespersons</li><li>Maintain updated contact lists</li></ul><p><strong>External Communication:</strong></p><ul><li>Notify emergency services immediately when needed</li><li>Inform customers and stakeholders promptly</li><li>Use social media and website for public updates</li><li>Coordinate with media if necessary</li></ul><p><strong>Best Practices:</strong></p><ul><li>Keep messages clear and concise</li><li>Provide regular updates</li><li>Be transparent and honest</li><li>Designate backup communicators</li></ul>'
                },
                'recovery': {
                    title: 'Recovery Procedures',
                    text: '<h3>Recovery Procedures</h3><p>Recovery procedures help restore normal operations:</p><p><strong>Assessment Phase:</strong></p><ul><li>Evaluate damage and impact</li><li>Determine what can be restored immediately</li><li>Identify critical functions that must resume first</li></ul><p><strong>Restoration Phase:</strong></p><ul><li>Repair or replace damaged equipment</li><li>Restore data and systems from backups</li><li>Reopen facilities or establish alternate locations</li><li>Resume critical operations</li></ul><p><strong>Full Recovery:</strong></p><ul><li>Restore all operations</li><li>Conduct post-incident review</li><li>Update plans based on lessons learned</li><li>Document all actions taken</li></ul>'
                },
                'prioritization': {
                    title: 'Prioritizing Risks',
                    text: '<h3>Prioritizing Risks</h3><p>Not all risks are equal. Prioritize based on:</p><p><strong>Likelihood:</strong> How probable is the event?</p><ul><li>High: Very likely to occur</li><li>Medium: Possible but not certain</li><li>Low: Unlikely but possible</li></ul><p><strong>Impact:</strong> What would be the consequences?</p><ul><li>High: Severe disruption, significant financial loss</li><li>Medium: Moderate disruption, manageable losses</li><li>Low: Minor disruption, minimal impact</li></ul><p><strong>Priority Matrix:</strong><br>Focus planning efforts on high-likelihood, high-impact risks first. However, don\'t ignore low-probability, high-impact events (like natural disasters) that could be catastrophic.</p>'
                },
                'testing': {
                    title: 'Testing Your Plan',
                    text: '<h3>Testing Your Plan</h3><p>Regular testing ensures your plan works when needed:</p><p><strong>Types of Tests:</strong></p><ul><li><strong>Tabletop Exercises:</strong> Walk through scenarios with your team</li><li><strong>Drills:</strong> Practice specific procedures (evacuation, communication)</li><li><strong>Full-Scale Exercises:</strong> Simulate complete emergency scenarios</li></ul><p><strong>Testing Schedule:</strong></p><ul><li>Test critical plans annually</li><li>Conduct drills quarterly</li><li>Review and update after each test</li></ul><p><strong>What to Test:</strong></p><ul><li>Communication systems</li><li>Evacuation procedures</li><li>Backup systems</li><li>Response times</li><li>Team coordination</li></ul>'
                },
                'updates': {
                    title: 'Regular Updates and Reviews',
                    text: '<h3>Regular Updates and Reviews</h3><p>Contingency plans must evolve with your business:</p><p><strong>When to Update:</strong></p><ul><li>After any incident or near-miss</li><li>When business operations change</li><li>When personnel changes occur</li><li>When new risks emerge</li><li>After testing reveals gaps</li><li>Annually as part of regular review</li></ul><p><strong>What to Review:</strong></p><ul><li>Contact information (keep it current!)</li><li>Procedures and protocols</li><li>Resource availability</li><li>Risk assessments</li><li>Recovery timelines</li></ul><p><strong>Documentation:</strong> Keep detailed records of all updates, tests, and incidents to improve your plan continuously.</p>'
                }
            };

            if (learnContent[topic]) {
                let htmlContent = learnContent[topic].text;
                // Add video link if available
                htmlContent += renderVideoLink(topic);
                content.innerHTML = htmlContent;
                display.style.display = 'block';
                display.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        function hideLearnContent() {
            document.getElementById('learnContentDisplay').style.display = 'none';
        }

        // Export functionality
        function showExportOptions() {
            const dropdown = document.getElementById('exportDropdown');
            dropdown.classList.toggle('show');
        }

        function exportPlan(format) {
            saveData();
            document.getElementById('exportDropdown').classList.remove('show');
            
            // Prompt for document author name
            const defaultOwner = getCurrentUsername() || '';
            const ownerName = prompt('Enter the document author name for the export:', defaultOwner);
            
            // If user cancels, don't export
            if (ownerName === null) {
                return;
            }
            
            // Use entered name or fallback
            const documentOwner = ownerName.trim() || defaultOwner || 'User';
            
            const filename = 'Contingency_Plan_' + new Date().toISOString().split('T')[0];
            let blob, mimeType, extension, content;
            
            if (format === 'docx') {
                content = generateWordDocument(documentOwner);
                blob = new Blob([content], { type: 'application/msword' });
                mimeType = 'application/msword';
                extension = '.doc';
            } else if (format === 'xlsx') {
                content = generateExcelDocument(documentOwner);
                blob = new Blob([content], { type: 'application/vnd.ms-excel' });
                mimeType = 'application/vnd.ms-excel';
                extension = '.xls';
            } else {
                content = generateTextDocument(documentOwner);
                blob = new Blob([content], { type: 'text/plain' });
                mimeType = 'text/plain';
                extension = '.txt';
            }
            
            const fullFilename = filename + extension;
            downloadFile(blob, fullFilename);
        }
        
        function generateTextDocument(ownerName) {
            const owner = ownerName || getCurrentUsername() || 'User';
            let content = 'BUSINESS CONTINGENCY PLAN\n';
            content += '==========================\n\n';
            content += `Document Author: ${owner}\n`;
            content += `Generated: ${new Date().toLocaleDateString()}\n\n`;
            
            // Iterate through all categories and subcategories
            Object.keys(categoryData).forEach(categoryType => {
                const category = categoryData[categoryType];
                content += `${category.title.toUpperCase()}\n`;
                content += '-'.repeat(category.title.length) + '\n\n';
                
                category.subcategories.forEach(subcategory => {
                    if (subcategory.subcategory) {
                        content += `${subcategory.subcategory}:\n`;
                    }
                    
                    subcategory.events.forEach(event => {
                        const response = getResponse(event.id);
                        content += formatEvent(event.name, response);
                    });
                    
                    if (subcategory.subcategory) {
                        content += '\n';
                    }
                });
                
                content += '\n';
            });
            
            return content;
        }

        function formatEvent(name, response) {
            if (!response || response.trim() === '') {
                return `  ${name}: [No response plan created]\n\n`;
            }
            return `  ${name}:\n  ${response.split('\n').join('\n  ')}\n\n`;
        }

        function downloadFile(blob, filename) {
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function generateWordDocument(ownerName) {
            const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            const username = ownerName || getCurrentUsername() || 'User';
            
            // Count total events and completed plans
            let totalEvents = 0;
            let completedPlans = 0;
            Object.keys(categoryData).forEach(categoryType => {
                categoryData[categoryType].subcategories.forEach(subcategory => {
                    subcategory.events.forEach(event => {
                        totalEvents++;
                        const response = getResponse(event.id);
                        if (response && response.trim() !== '') {
                            completedPlans++;
                        }
                    });
                });
            });
            
            let html = '<!DOCTYPE html>\n';
            html += '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">\n';
            html += '<head>\n';
            html += '<meta charset="utf-8">\n';
            html += '<meta name="ProgId" content="Word.Document">\n';
            html += '<meta name="Generator" content="Microsoft Word">\n';
            html += '<meta name="Originator" content="Microsoft Word">\n';
            html += '<title>Business Contingency Plan</title>\n';
            html += '<!--[if gte mso 9]><xml>\n';
            html += '<w:WordDocument>\n';
            html += '<w:View>Print</w:View>\n';
            html += '<w:Zoom>100</w:Zoom>\n';
            html += '<w:DoNotOptimizeForBrowser/>\n';
            html += '</w:WordDocument>\n';
            html += '</xml><![endif]-->\n';
            html += '<style>\n';
            html += '@page { size: 8.5in 11in; margin: 1in 0.75in; }\n';
            html += 'body { font-family: "Calibri", "Arial", sans-serif; font-size: 11pt; margin: 0; padding: 0; line-height: 1.5; color: #1a1a1a; }\n';
            html += 'h1 { color: #0f4c75; font-size: 28pt; font-weight: bold; margin-top: 0; margin-bottom: 12pt; text-align: center; page-break-after: avoid; }\n';
            html += 'h2 { color: #0f4c75; font-size: 18pt; font-weight: bold; margin-top: 24pt; margin-bottom: 12pt; border-bottom: 2px solid #0f4c75; padding-bottom: 6pt; page-break-after: avoid; }\n';
            html += 'h3 { color: #764ba2; font-size: 14pt; font-weight: bold; margin-top: 18pt; margin-bottom: 8pt; }\n';
            html += 'h4 { color: #555; font-size: 12pt; font-weight: bold; margin-top: 12pt; margin-bottom: 6pt; }\n';
            html += '.header { text-align: center; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 3px solid #0f4c75; page-break-after: avoid; }\n';
            html += '.header-subtitle { color: #666; font-size: 14pt; margin-top: 8px; font-weight: normal; }\n';
            html += '.meta-info { color: #666; font-size: 10pt; margin-top: 15px; }\n';
            html += '.executive-summary { background: #f8f9fa; padding: 20pt; margin-bottom: 30pt; border-left: 4px solid #0f4c75; page-break-inside: avoid; }\n';
            html += '.summary-table { width: 100%; border-collapse: collapse; margin: 15pt 0; }\n';
            html += '.summary-table td { padding: 8pt; border: 1px solid #ddd; }\n';
            html += '.summary-table td:first-child { font-weight: bold; background: #f0f0f0; width: 40%; }\n';
            html += '.section { margin-bottom: 30pt; page-break-inside: avoid; }\n';
            html += '.event-item { margin-bottom: 24pt; padding: 15pt; background: #ffffff; border: 1px solid #e0e0e0; border-left: 4px solid #0f4c75; page-break-inside: avoid; }\n';
            html += '.event-name { font-weight: bold; color: #0f4c75; font-size: 13pt; margin-bottom: 10pt; }\n';
            html += '.response-section { margin-bottom: 12pt; }\n';
            html += '.response-section-title { font-weight: bold; color: #764ba2; font-size: 11pt; margin-bottom: 6pt; margin-top: 10pt; }\n';
            html += '.response-content { margin-left: 12pt; color: #333; font-size: 11pt; line-height: 1.6; }\n';
            html += '.response-content ul { margin: 6pt 0; padding-left: 20pt; }\n';
            html += '.response-content li { margin-bottom: 4pt; }\n';
            html += '.no-response { font-style: italic; color: #999; padding: 15pt; background: #fafafa; border: 1px dashed #ddd; }\n';
            html += 'table { width: 100%; border-collapse: collapse; margin: 15pt 0; }\n';
            html += 'table th { background-color: #0f4c75; color: white; font-weight: bold; padding: 10pt; text-align: left; border: 1px solid #0a3a5a; }\n';
            html += 'table td { padding: 8pt; border: 1px solid #ddd; vertical-align: top; }\n';
            html += 'table tr:nth-child(even) { background-color: #f8f9fa; }\n';
            html += '</style>\n';
            html += '</head>\n';
            html += '<body>\n';
            
            // Cover Page / Header
            html += '<div class="header">\n';
            html += '<h1>BUSINESS CONTINGENCY PLAN</h1>\n';
            html += '<div class="header-subtitle">Comprehensive Risk Management and Response Strategy</div>\n';
            html += '<div class="meta-info">\n';
            html += `Document Author: ${escapeHtml(username)}<br>\n`;
            html += `Date Generated: ${date}<br>\n`;
            html += `Version: 1.0\n`;
            html += '</div>\n';
            html += '</div>\n';
            
            // Executive Summary
            html += '<div class="executive-summary">\n';
            html += '<h2>Executive Summary</h2>\n';
            html += '<p>This Business Contingency Plan outlines comprehensive response strategies for potential risks and disruptions that may impact business operations. The plan covers natural hazards, human-caused events, and technological issues, providing detailed procedures for immediate response, communication, recovery, and resource allocation.</p>\n';
            html += '<table class="summary-table">\n';
            html += '<tr><td>Total Risk Categories</td><td>' + Object.keys(categoryData).length + '</td></tr>\n';
            html += '<tr><td>Total Identified Events</td><td>' + totalEvents + '</td></tr>\n';
            html += '<tr><td>Response Plans Completed</td><td>' + completedPlans + ' (' + Math.round((completedPlans/totalEvents)*100) + '%)</td></tr>\n';
            html += '<tr><td>Plan Status</td><td>' + (completedPlans === totalEvents ? 'Complete' : 'In Progress') + '</td></tr>\n';
            html += '</table>\n';
            html += '</div>\n';
            
            // Table of Contents placeholder
            html += '<div class="section">\n';
            html += '<h2>Table of Contents</h2>\n';
            html += '<p>1. Executive Summary<br>2. Natural Hazards<br>3. Human Caused Events<br>4. Technological Issues<br>5. Appendices</p>\n';
            html += '</div>\n';
            
            // Detailed Response Plans
            Object.keys(categoryData).forEach(categoryType => {
                const category = categoryData[categoryType];
                html += '<div class="section">\n';
                html += `<h2>${escapeHtml(category.title)}</h2>\n`;
                
                category.subcategories.forEach(subcategory => {
                    if (subcategory.subcategory) {
                        html += `<h3>${escapeHtml(subcategory.subcategory)}</h3>\n`;
                    }
                    
                    subcategory.events.forEach(event => {
                        const response = getResponse(event.id);
                        html += '<div class="event-item">\n';
                        html += `<div class="event-name">${escapeHtml(event.name)}</div>\n`;
                        
                        if (response && response.trim() !== '') {
                            // Parse response into structured sections
                            const sections = parseResponseSections(response);
                            sections.forEach(section => {
                                html += '<div class="response-section">\n';
                                html += `<div class="response-section-title">${escapeHtml(section.title)}</div>\n`;
                                html += '<div class="response-content">\n';
                                html += formatResponseContent(section.content);
                                html += '</div>\n';
                                html += '</div>\n';
                            });
                        } else {
                            html += '<div class="no-response">[No response plan created for this event]</div>\n';
                        }
                        
                        html += '</div>\n';
                    });
                });
                
                html += '</div>\n';
            });
            
            // Appendices
            html += '<div class="section">\n';
            html += '<h2>Appendices</h2>\n';
            html += '<h3>Document Control</h3>\n';
            html += '<table>\n';
            html += '<tr><th>Item</th><th>Details</th></tr>\n';
            html += '<tr><td>Document Title</td><td>Business Contingency Plan</td></tr>\n';
            html += '<tr><td>Version</td><td>1.0</td></tr>\n';
            html += '<tr><td>Date Created</td><td>' + date + '</td></tr>\n';
            html += '<tr><td>Owner</td><td>' + escapeHtml(username) + '</td></tr>\n';
            html += '<tr><td>Review Frequency</td><td>Quarterly or as needed</td></tr>\n';
            html += '</table>\n';
            html += '</div>\n';
            
            html += '</body>\n';
            html += '</html>\n';
            
            return html;
        }
        
        function parseResponseSections(response) {
            const sections = [];
            const lines = response.split('\n');
            let currentSection = null;
            let currentContent = [];
            
            lines.forEach(line => {
                const trimmed = line.trim();
                // Check if line is a section header (all caps, ends with colon)
                if (trimmed && trimmed === trimmed.toUpperCase() && trimmed.endsWith(':')) {
                    // Save previous section
                    if (currentSection) {
                        sections.push({
                            title: currentSection,
                            content: currentContent.join('\n')
                        });
                    }
                    // Start new section
                    currentSection = trimmed.slice(0, -1); // Remove colon
                    currentContent = [];
                } else if (trimmed) {
                    currentContent.push(trimmed);
                }
            });
            
            // Save last section
            if (currentSection) {
                sections.push({
                    title: currentSection,
                    content: currentContent.join('\n')
                });
            } else if (response.trim()) {
                // If no sections found, treat entire response as content
                sections.push({
                    title: 'Response Plan',
                    content: response.trim()
                });
            }
            
            return sections;
        }
        
        function formatResponseContent(content) {
            // Convert bullet points and format content
            const lines = content.split('\n');
            let html = '';
            let inList = false;
            
            lines.forEach(line => {
                const trimmed = line.trim();
                if (trimmed.startsWith('‚Ä¢') || trimmed.startsWith('-')) {
                    if (!inList) {
                        html += '<ul>\n';
                        inList = true;
                    }
                    const item = trimmed.substring(1).trim();
                    html += `<li>${escapeHtml(item)}</li>\n`;
                } else if (trimmed) {
                    if (inList) {
                        html += '</ul>\n';
                        inList = false;
                    }
                    html += `<p>${escapeHtml(trimmed)}</p>\n`;
                }
            });
            
            if (inList) {
                html += '</ul>\n';
            }
            
            return html || '<p>' + escapeHtml(content) + '</p>';
        }

        function generateExcelDocument(ownerName) {
            const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            const username = ownerName || getCurrentUsername() || 'User';
            
            // Count statistics
            let totalEvents = 0;
            let completedPlans = 0;
            const eventList = [];
            
            Object.keys(categoryData).forEach(categoryType => {
                const category = categoryData[categoryType];
                category.subcategories.forEach(subcategory => {
                    subcategory.events.forEach(event => {
                        totalEvents++;
                        const response = getResponse(event.id);
                        const hasResponse = response && response.trim() !== '';
                        if (hasResponse) completedPlans++;
                        
                        // Get metadata for this event
                        const metadata = getEventMetadata(event.id);
                        const defaultPriority = determinePriority(categoryType, event.name);
                        
                        eventList.push({
                            category: category.title,
                            subcategory: subcategory.subcategory || '',
                            event: event.name,
                            response: hasResponse ? response : '[No response plan]',
                            status: metadata.status || (hasResponse ? 'Complete' : 'Not Started'),
                            priority: metadata.priority || defaultPriority,
                            likelihood: metadata.likelihood || '',
                            impact: metadata.impact || '',
                            responsible: metadata.responsible || '',
                            recoveryTime: metadata.recoveryTime || ''
                        });
                    });
                });
            });
            
            let html = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">\n';
            html += '<head>\n';
            html += '<meta charset="utf-8">\n';
            html += '<!--[if gte mso 9]><xml>\n';
            html += '<x:ExcelWorkbook>\n';
            html += '<x:ExcelWorksheets>\n';
            
            // Sheet 1: Overview
            html += '<x:ExcelWorksheet>\n';
            html += '<x:Name>Overview</x:Name>\n';
            html += '<x:WorksheetOptions>\n';
            html += '<x:PrintGridlines/>\n';
            html += '<x:FitToPage/>\n';
            html += '</x:WorksheetOptions>\n';
            html += '</x:ExcelWorksheet>\n';
            
            // Sheet 2: Risk Matrix
            html += '<x:ExcelWorksheet>\n';
            html += '<x:Name>Risk Matrix</x:Name>\n';
            html += '<x:WorksheetOptions>\n';
            html += '<x:PrintGridlines/>\n';
            html += '</x:WorksheetOptions>\n';
            html += '</x:ExcelWorksheet>\n';
            
            // Sheet 3: Response Plans
            html += '<x:ExcelWorksheet>\n';
            html += '<x:Name>Response Plans</x:Name>\n';
            html += '<x:WorksheetOptions>\n';
            html += '<x:PrintGridlines/>\n';
            html += '<x:FreezePanes/>\n';
            html += '<x:FrozenNoSplit/>\n';
            html += '<x:SplitHorizontal>1</x:SplitHorizontal>\n';
            html += '<x:TopRowBottomPane>1</x:TopRowBottomPane>\n';
            html += '</x:WorksheetOptions>\n';
            html += '</x:ExcelWorksheet>\n';
            
            html += '</x:ExcelWorksheets>\n';
            html += '</x:ExcelWorkbook>\n';
            html += '</xml><![endif]-->\n';
            html += '<style>\n';
            html += 'body { font-family: Calibri, Arial, sans-serif; font-size: 11pt; }\n';
            html += 'table { border-collapse: collapse; width: 100%; margin: 10px 0; }\n';
            html += 'td, th { border: 1px solid #000000; padding: 8px; vertical-align: top; font-size: 11pt; }\n';
            html += 'th { background-color: #0f4c75; color: white; font-weight: bold; text-align: center; }\n';
            html += 'td { background-color: #ffffff; white-space: normal; word-wrap: break-word; }\n';
            html += '.header-row { background-color: #0f4c75; color: white; font-weight: bold; font-size: 14pt; text-align: center; }\n';
            html += '.summary-cell { background-color: #f0f0f0; font-weight: bold; }\n';
            html += '.complete { background-color: #d4edda; color: #155724; }\n';
            html += '.incomplete { background-color: #f8d7da; color: #721c24; }\n';
            html += '.high-priority { background-color: #fff3cd; }\n';
            html += '.medium-priority { background-color: #d1ecf1; }\n';
            html += '.low-priority { background-color: #d4edda; }\n';
            html += '</style>\n';
            html += '</head>\n';
            html += '<body>\n';
            
            // Sheet 1: Overview
            html += '<table>\n';
            html += '<tr class="header-row"><td colspan="2">BUSINESS CONTINGENCY PLAN - OVERVIEW</td></tr>\n';
            html += '<tr><td class="summary-cell">Document Author</td><td>' + escapeHtml(username) + '</td></tr>\n';
            html += '<tr><td class="summary-cell">Date Generated</td><td>' + date + '</td></tr>\n';
            html += '<tr><td class="summary-cell">Version</td><td>1.0</td></tr>\n';
            html += '<tr><td class="summary-cell">Total Risk Categories</td><td>' + Object.keys(categoryData).length + '</td></tr>\n';
            html += '<tr><td class="summary-cell">Total Identified Events</td><td>' + totalEvents + '</td></tr>\n';
            html += '<tr><td class="summary-cell">Response Plans Completed</td><td>' + completedPlans + '</td></tr>\n';
            html += '<tr><td class="summary-cell">Completion Percentage</td><td>' + Math.round((completedPlans/totalEvents)*100) + '%</td></tr>\n';
            html += '<tr><td class="summary-cell">Plan Status</td><td>' + (completedPlans === totalEvents ? 'Complete' : 'In Progress') + '</td></tr>\n';
            html += '</table>\n';
            
            // Category Breakdown
            html += '<table style="margin-top: 20px;">\n';
            html += '<tr class="header-row"><td>Category</td><td>Total Events</td><td>Completed Plans</td><td>Completion %</td></tr>\n';
            Object.keys(categoryData).forEach(categoryType => {
                const category = categoryData[categoryType];
                let catTotal = 0;
                let catCompleted = 0;
                category.subcategories.forEach(subcategory => {
                    subcategory.events.forEach(event => {
                        catTotal++;
                        const response = getResponse(event.id);
                        if (response && response.trim() !== '') catCompleted++;
                    });
                });
                const percentage = catTotal > 0 ? Math.round((catCompleted/catTotal)*100) : 0;
                html += '<tr>\n';
                html += `<td>${escapeHtml(category.title)}</td>\n`;
                html += `<td>${catTotal}</td>\n`;
                html += `<td>${catCompleted}</td>\n`;
                html += `<td>${percentage}%</td>\n`;
                html += '</tr>\n';
            });
            html += '</table>\n';
            
            html += '<p style="page-break-before: always;"></p>\n';
            
            // Sheet 2: Risk Matrix
            html += '<table>\n';
            html += '<tr class="header-row"><td colspan="9">RISK ASSESSMENT MATRIX</td></tr>\n';
            html += '<tr><th>Category</th><th>Subcategory</th><th>Event</th><th>Priority</th><th>Likelihood</th><th>Impact</th><th>Responsible</th><th>Recovery Time</th><th>Status</th></tr>\n';
            eventList.forEach(event => {
                const priorityClass = event.priority === 'High' ? 'high-priority' : 
                                     event.priority === 'Medium' ? 'medium-priority' : 'low-priority';
                const statusClass = event.status === 'Complete' ? 'complete' : 
                                   event.status === 'In Progress' ? 'medium-priority' : 'incomplete';
                html += '<tr>\n';
                html += `<td>${escapeHtml(event.category)}</td>\n`;
                html += `<td>${escapeHtml(event.subcategory)}</td>\n`;
                html += `<td>${escapeHtml(event.event)}</td>\n`;
                html += `<td class="${priorityClass}">${escapeHtml(event.priority || 'Not Set')}</td>\n`;
                html += `<td>${escapeHtml(event.likelihood || 'Not Set')}</td>\n`;
                html += `<td>${escapeHtml(event.impact || 'Not Set')}</td>\n`;
                html += `<td>${escapeHtml(event.responsible || 'Not Assigned')}</td>\n`;
                html += `<td>${escapeHtml(event.recoveryTime || 'Not Estimated')}</td>\n`;
                html += `<td class="${statusClass}">${escapeHtml(event.status)}</td>\n`;
                html += '</tr>\n';
            });
            html += '</table>\n';
            
            html += '<p style="page-break-before: always;"></p>\n';
            
            // Sheet 3: Detailed Response Plans
            html += '<table>\n';
            html += '<tr class="header-row"><td colspan="6">DETAILED RESPONSE PLANS</td></tr>\n';
            html += '<tr><th>Category</th><th>Subcategory</th><th>Event</th><th>Responsible Party</th><th>Recovery Time</th><th>Response Plan</th></tr>\n';
            eventList.forEach(event => {
                html += '<tr>\n';
                html += `<td>${escapeHtml(event.category)}</td>\n`;
                html += `<td>${escapeHtml(event.subcategory)}</td>\n`;
                html += `<td>${escapeHtml(event.event)}</td>\n`;
                html += `<td>${escapeHtml(event.responsible || 'Not Assigned')}</td>\n`;
                html += `<td>${escapeHtml(event.recoveryTime || 'Not Estimated')}</td>\n`;
                html += `<td style="max-width: 500px;">${escapeHtml(event.response)}</td>\n`;
                html += '</tr>\n';
            });
            html += '</table>\n';
            
            html += '</body>\n';
            html += '</html>\n';
            
            return html;
        }
        
        function determinePriority(categoryType, eventName) {
            // Determine priority based on event type
            const highPriorityEvents = [
                'Fire', 'Building Collapse', 'Workplace Violence', 'Cyber Security',
                'Earthquake', 'Flood', 'Hazardous Material Spill'
            ];
            const mediumPriorityEvents = [
                'Infrastructure Failure', 'Protests', 'Landslide', 'Volcano',
                'Extreme Temperatures', 'Lightning'
            ];
            
            if (highPriorityEvents.includes(eventName)) {
                return 'High';
            } else if (mediumPriorityEvents.includes(eventName)) {
                return 'Medium';
            } else {
                return 'Low';
            }
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        let metadataBackup = null;
        
        function toggleExamplesMode() {
            try {
                if (!examplesMode) {
                    // Loading examples - backup user data first
                    saveData(); // Ensure current data is saved
                    saveMetadata(); // Ensure metadata is saved
                    userDataBackup = JSON.parse(JSON.stringify(contingencyData)); // Deep copy current data
                    metadataBackup = JSON.parse(JSON.stringify(eventMetadata || {})); // Deep copy metadata
                    
                    // Load all example responses and metadata
                    loadAllExamples();
                    
                    examplesMode = true;
                    const btn = document.getElementById('examplesModeBtn');
                    if (btn) {
                        btn.textContent = '‚úñÔ∏è Hide Examples';
                        btn.style.background = 'var(--error)';
                    }
                    
                    // Show "Your Data" button
                    const yourDataContainer = document.getElementById('yourDataButtonContainer');
                    if (yourDataContainer) {
                        yourDataContainer.style.display = 'inline-block';
                    }
                    
                    // Refresh all views to show examples
                    updateCategories();
                    showSaveIndicator();
                } else {
                    // Hiding examples - restore user data
                    restoreUserData();
                }
            } catch (error) {
                console.error('Error in toggleExamplesMode:', error);
                console.error('Error details:', error.message, error.stack);
                alert('An error occurred while loading examples: ' + error.message + '\n\nPlease check the browser console for more details.');
            }
        }
        
        function loadAllExamples() {
            try {
                // Load all example responses into contingencyData
                if (typeof exampleResponses === 'undefined') {
                    throw new Error('exampleResponses is not defined');
                }
                
                Object.keys(exampleResponses).forEach(eventId => {
                    const exampleResponse = exampleResponses[eventId];
                    if (exampleResponse) {
                        setResponse(eventId, exampleResponse);
                    }
                });
                
                // Load all example metadata
                if (typeof exampleMetadata === 'undefined') {
                    console.warn('exampleMetadata is not defined, skipping metadata load');
                } else {
                    Object.keys(exampleMetadata).forEach(eventId => {
                        const metadata = exampleMetadata[eventId];
                        if (metadata) {
                            setEventMetadata(eventId, metadata);
                        }
                    });
                }
                
                saveData();
                saveMetadata();
            } catch (error) {
                console.error('Error in loadAllExamples:', error);
                throw error; // Re-throw to be caught by toggleExamplesMode
            }
        }
        
        function restoreUserData() {
            if (!userDataBackup) {
                // No backup means user hasn't entered anything, so clear all responses
                clearAllResponses();
                eventMetadata = {};
                saveMetadata();
            } else {
                // Restore the user's data
                contingencyData = JSON.parse(JSON.stringify(userDataBackup)); // Deep copy backup
                userDataBackup = null; // Clear backup
                saveData();
                
                // Restore metadata
                if (metadataBackup) {
                    eventMetadata = JSON.parse(JSON.stringify(metadataBackup));
                    metadataBackup = null;
                    saveMetadata();
                }
            }
            
            examplesMode = false;
            const btn = document.getElementById('examplesModeBtn');
            if (btn) {
                btn.textContent = 'üëÅÔ∏è View Examples';
                btn.style.background = 'var(--info)';
            }
            
            // Hide "Your Data" button
            const yourDataContainer = document.getElementById('yourDataButtonContainer');
            if (yourDataContainer) {
                yourDataContainer.style.display = 'none';
            }
            
            // Refresh all views to show user data
            updateCategories();
            showSaveIndicator();
        }
        
        function clearAllResponses() {
            // Reset all responses to empty strings
            Object.keys(categoryData).forEach(categoryType => {
                const category = categoryData[categoryType];
                category.subcategories.forEach(subcategory => {
                    subcategory.events.forEach(event => {
                        setResponse(event.id, '');
                    });
                });
            });
            saveData();
        }

        // Delete response content (but keep the event)
        function deleteResponse(eventId, eventName) {
            if (confirm(`Clear the response plan for "${eventName}"? The event will remain, but the response content will be deleted.`)) {
                setResponse(eventId, '');
                saveData();
                showSaveIndicator();
                updateCategories();
            }
        }

        function getExampleResponse(eventId) {
            // Check if exact match exists
            if (exampleResponses[eventId]) {
                return exampleResponses[eventId];
            }
            // Try to find partial match based on event type
            const eventIdParts = eventId.split('.');
            if (eventIdParts.length >= 3) {
                const category = eventIdParts[0];
                const subcategory = eventIdParts[1];
                const eventName = eventIdParts[2];
                
                // Try to find similar event
                for (const key in exampleResponses) {
                    const keyParts = key.split('.');
                    if (keyParts[0] === category && keyParts[1] === subcategory) {
                        // Return first example from same category/subcategory
                        return exampleResponses[key];
                    }
                }
            }
            return null;
        }

        function loadExampleResponse(eventId) {
            const example = getExampleResponse(eventId);
            if (example) {
                if (confirm('Load this example response plan? This will replace your current response plan.')) {
                    setResponse(eventId, example);
                    saveData();
                    showSaveIndicator();
                    updateCategories();
                    // Refresh the modal if it's open
                    if (currentEventId === eventId) {
                        document.getElementById('responseText').value = example;
                    }
                }
            } else {
                alert('No example available for this event type.');
            }
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('exportDropdown');
            const exportBtn = event.target.closest('.btn-export');
            if (dropdown && !dropdown.contains(event.target) && !exportBtn) {
                dropdown.classList.remove('show');
            }
        });

        // Auto-save on input
        document.addEventListener('DOMContentLoaded', function() {
            loadCategoryData(); // Load custom events first
            initCategories();
            loadSavedData();
            
            const responseText = document.getElementById('responseText');
            if (responseText) {
                responseText.addEventListener('input', function() {
                    if (currentEventId) {
                        saveData();
                    }
                });
            }
        });
    </script>

    <input id="importWordExportInput" type="file" accept=".doc,.docx,.html,.htm,text/html,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" style="display:none" />

</body>
</html>
